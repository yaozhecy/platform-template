# 预约挂号

![预约挂号流程图](场景流程图/预约挂号.png)

## 场景流程描述

> 该场景实现接口调用方(系统类型不限)向接口提供方(一般为HIS系统)预约挂号功能。
>
> 1.接口调用方通过集成平台提供的查询注册机构列表接口获取某个区域内指定层级的机构列表信息。
>
> 2.接口调用方通过机构编码查询接口提供方注册在集成平台的查询机构下科室列表接口获取所有科室信息。
>
> 3.接口调用方通过科室编码查询接口提供方注册在集成平台的查询科室下医生列表接口获取近将要出诊的医生列表。
>
> 4.接口调用方通过医生身份证号和日期查询接口提供方注册在集成平台的查询医生号源接口获取某医生某天的号源信息。
>
> 5.接口调用方在确定机构、科室、医生、号源信息的情况下，通过接口提供方注册在集成平台的挂号申请接口发起挂号申请并返回挂号申请响应（包括支付链接）。
>
> 6.接口调用方需要根据支付链接引导用户完成支付，支付系统状态变更通知到接口提供方。
>
> 7.接口调用方可通过接口提供方注册在集成平台的查询挂号列表接口查询挂号列表。
>
> 8.接口调用方可通过接口提供方注册在集成平台的查询挂号详情接口查询挂号详情。
>
> 9.接口调用方可根据需要，通过接口提供方注册在集成平台的取消挂号申请接口，发起取消挂号申请。

## 查询注册机构列表接口

### 接口功能

> 查询区域中的注册医疗机构列表

### 参考地址(URL)

> http://ip:port/api/appointment/query-organizations

### HTTP请求方式(Method)

> GET

### 数据格式

> JSON（必须支持）
>
> XML（可选支持）

### 请求数据

#### 请求头(Request Header)

> 无

#### 查询参数(Query)

|      名称      | 是否必填 |                             说明                             |
| :------------: | :------: | :----------------------------------------------------------: |
| area-id |    否    | 区域ID，根据此ID查询指定区域中的机构 |
| hierarchy-kind |    否    | 组织机构层级种类，指定查询某层级机构，若查询多个层级则以“,”分隔；默认查询所有层级机构 |

#### 参考结构

> 无

#### 示例代码

> 无

### 响应数据

#### 响应头(Response Header)

> 无

#### 参考结构

```xml
<?xml version="1.0" encoding="utf-8" ?>
<Bundle xmlns="http://hl7.org/fhir">
    <id value="唯一标识，如uuid"/>
    <type value="searchset"/>
    <!-- 0..* ******************************医院****************************** -->
    <entry>
        <resource>
            <Organization xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid，组织机构统一社会信用代码"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Hospital"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 医院编号 NamingSystem uri -->
                    <system value="https://www.cods.org.cn"/>
                    <!-- 0..1 医院编号 -->
                    <value value="12510125450833106C"/>
                </identifier>
                <!-- 0..1 是否可用 -->
                <active value="true"/>
                <!-- 0..1 组织机构层级种类（固定为医院） -->
                <type>
                    <coding>
                        <!-- 组织机构层级种类 CodeSystem地址 -->
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind"/>
                        <!-- 0..1 组织机构层级种类代码 -->
                        <code value="2"/>
                        <!-- 0..1 组织机构层级种类 -->
                        <display value="医院"/>
                    </coding>
                </type>
                <!-- 0..1 卫生机构(组织)类别 WS 218-2002 -->
                <type>
                    <coding>
                        <!-- 组织机构层级种类 CodeSystem地址 -->
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/health-institution-or-organization-category"/>
                        <!-- 0..1 组织机构层级种类代码 -->
                        <code value="A100"/>
                        <!-- 0..1 组织机构层级种类 -->
                        <display value="综合医院"/>
                    </coding>
                </type>
                <!-- 0..1 地址 -->
                <address>
                    <!-- 0..1 地址的完整描述 -->
                    <text value="四川省成都市高新区XXXXXX路18号"/>
                </address>
                <!-- 0..1 医院名称 -->
                <name value="成都市XXXXX人民医院"/>
                <!-- 0..* 医院别名 -->
                <alias value="成都XX医院"/>
                <!-- 0..* 联系方式 -->
                <telecom>
                    <!-- 0..1 类型 phone | fax | email | pager | url | sms | other -->
                    <system value="phone"/>
                    <!-- 0..1 电话号码 -->
                    <value value="13309876352"/>
                </telecom>
                <!-- 0..1 电子邮箱 -->
                <telecom>
                    <!-- 0..1 类型 phone | fax | email | pager | url | sms | other -->
                    <system value="email"/>
                    <!-- 0..1 电子邮箱 -->
                    <value value=""/>
                </telecom>
                <!-- 0..1 官方网页 -->
                <telecom>
                    <!-- 0..1 类型 phone | fax | email | pager | url | sms | other -->
                    <system value="url"/>
                    <!-- 0..1 官方网页 -->
                    <value value="http://www.cdzxy.com/"/>
                </telecom>
                <!-- 医院简介 -->
                <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction">
                    <!-- 医院简介 -->
                    <valueString value="XXXXXXXX医院血液科针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。"/>
                </extension>
            </Organization>
        </resource>
    </entry>
</Bundle>
```

#### 示例代码

**JAVA**

```java
package fhir.预约挂号;

import org.hl7.fhir.r4.model.Address;
import org.hl7.fhir.r4.model.Bundle;
import org.hl7.fhir.r4.model.Bundle.BundleEntryComponent;
import org.hl7.fhir.r4.model.Bundle.BundleType;
import org.hl7.fhir.r4.model.CanonicalType;
import org.hl7.fhir.r4.model.CodeableConcept;
import org.hl7.fhir.r4.model.Coding;
import org.hl7.fhir.r4.model.ContactPoint;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointSystem;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointUse;
import org.hl7.fhir.r4.model.DomainResource;
import org.hl7.fhir.r4.model.Extension;
import org.hl7.fhir.r4.model.Identifier;
import org.hl7.fhir.r4.model.Meta;
import org.hl7.fhir.r4.model.Organization;
import org.hl7.fhir.r4.model.Resource;
import org.hl7.fhir.r4.model.StringType;

import ca.uhn.fhir.context.FhirContext;

public class 查询注册机构列表接口 {
    public void serialize() {
        Bundle bundle = new Bundle();
        bundle.setId("唯一标识，如uuid");
        bundle.setType(BundleType.SEARCHSET);
        bundle.addEntry(new BundleEntryComponent().setResource(assembleHospital()));
        System.out.println(FhirContext.forR4().newJsonParser().encodeResourceToString(bundle));
    }

    public void deserialize() {
        String fhirJson = "序列化生成的json格式字符串";

        Bundle bundle = FhirContext.forR4().newJsonParser().parseResource(Bundle.class, fhirJson);
        System.out.println(bundle.getId());
        System.out.println(bundle.getType());

        for (BundleEntryComponent bundleEntryComponent : bundle.getEntry()) {
            Resource domainResource = bundleEntryComponent.getResource();
            if (domainResource instanceof Organization) {
                Organization hospital = (Organization) domainResource;
                disassembleHospital(hospital);
            }
        }
    }

    private DomainResource assembleHospital() {
        Organization hospital = new Organization();
        hospital.setId("唯一标识，如uuid，组织机构统一社会信用代码");
        hospital.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Hospital"));
        hospital.addIdentifier(new Identifier().setSystem("https://www.cods.org.cn").setValue("12510125450833106C"));
        hospital.setActive(true);
        hospital.addType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind", "2", "医院")));
        hospital.addType(
            new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/health-institution-or-organization-category", "A100", "综合医院")));
        hospital.setName("xx医院");
        hospital.addAlias("xxxx医院");
        hospital.addTelecom(new ContactPoint().setSystem(ContactPointSystem.PHONE).setUse(ContactPointUse.MOBILE).setValue("13309876352"));
        hospital.addTelecom(new ContactPoint().setSystem(ContactPointSystem.EMAIL).setUse(ContactPointUse.WORK).setValue("xx@xx.com"));
        hospital.addTelecom(new ContactPoint().setSystem(ContactPointSystem.URL).setUse(ContactPointUse.WORK).setValue("http://www.cdzxy.com/"));
        hospital.addAddress(new Address().setText("xxxx地址"));
        hospital.addExtension(new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction")
            .setValue(new StringType("XXXXXXXX医院血液科针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。")));
        return hospital;
    }

    private void disassembleHospital(Organization hospital) {
        System.out.println(hospital.getId());
        for (CanonicalType profile : hospital.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : hospital.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        System.out.println(hospital.getActive());
        for (CodeableConcept type : hospital.getType()) {
            for (Coding coding : type.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        System.out.println(hospital.getName());
        for (StringType alias : hospital.getAlias()) {
            System.out.println(alias);
        }
        for (ContactPoint telecom : hospital.getTelecom()) {
            System.out.println(telecom.getSystem());
            System.out.println(telecom.getUse());
            System.out.println(telecom.getValue());
        }
        for (Address address : hospital.getAddress()) {
            System.out.println(address.getText());
        }
        for (Extension extension : hospital.getExtension()) {
            System.out.println(extension.getUrl());
            System.out.println(extension.getValue());
        }
    }
}
```

**C#**

```c#
using System;
using System.Collections.Generic;
using Hl7.Fhir.Model;
using Hl7.Fhir.Serialization;

namespace fhir.预约挂号
{
    public class 查询注册机构列表接口
    {
        public void Serialize()
        {
            Bundle bundle = new Bundle();
            bundle.Id = "唯一标识，如uuid";
            bundle.Type = Bundle.BundleType.Searchset;
            bundle.Entry = new List<Bundle.EntryComponent>
            {
                new Bundle.EntryComponent { Resource = AssembleHospital() }
            };
            Console.WriteLine(new FhirJsonSerializer().SerializeToString(bundle));
        }

        public void Deserialize()
        {
            string fhirJson = "序列化生成的json格式字符串";

            Bundle bundle = new FhirJsonParser().Parse<Bundle>(fhirJson);
            Console.WriteLine(bundle.Id);
            Console.WriteLine(bundle.Type);

            foreach (var entryComponent in bundle.Entry)
            {
                Resource domainResource = entryComponent.Resource;
                if (domainResource is Organization)
                {
                    Organization hospital = (Organization)domainResource;
                    DisassembleHospital(hospital);
                }
            }
        }

        private DomainResource AssembleHospital()
        {
            Organization hospital = new Organization();
            hospital.Id = "唯一标识，如uuid，组织机构统一社会信用代码";
            hospital.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Hospital"
                }
            };
            hospital.Identifier = new List<Identifier>
            {
                new Identifier("https://www.cods.org.cn", "12510125450833106C")
            };
            hospital.Active = true;
            hospital.Type = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind", "2", "医院", "医院"),
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/health-institution-or-organization-category", "A100", "综合医院", "综合医院")
            };
            hospital.Name = "xx医院";
            hospital.Alias = new List<string>
            {
                "xxxx医院"
            };
            hospital.Telecom = new List<ContactPoint>
            {
                 new ContactPoint(ContactPoint.ContactPointSystem.Phone, ContactPoint.ContactPointUse.Mobile, "13309876352"),
                 new ContactPoint(ContactPoint.ContactPointSystem.Email, ContactPoint.ContactPointUse.Work, "xx@xx.com"),
                 new ContactPoint(ContactPoint.ContactPointSystem.Url, ContactPoint.ContactPointUse.Work, "http://www.cdzxy.com/")
            };
            hospital.Address = new List<Address>
            {
                new Address()
                {
                    Text = "xxxx地址"
                }
            };
            hospital.Extension = new List<Extension>
            {
                new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction", new FhirString("XXXXXXXX医院血液科针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。"))
            };

            return hospital;
        }

        private void DisassembleHospital(Organization hospital)
        {
            Console.WriteLine(hospital.Id);
            foreach (var profile in hospital.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in hospital.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            Console.WriteLine(hospital.Active);
            foreach (var type in hospital.Type)
            {
                foreach (var coding in type.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            Console.WriteLine(hospital.Name);
            foreach (var alias in hospital.Alias)
            {
                Console.WriteLine(alias);
            }
            foreach (var telecom in hospital.Telecom)
            {
                Console.WriteLine(telecom.System);
                Console.WriteLine(telecom.Use);
                Console.WriteLine(telecom.Value);
            }
            foreach (var address in hospital.Address)
            {
                Console.WriteLine(address.Text);
            }
            foreach (var extension in hospital.Extension)
            {
                Console.WriteLine(extension.Url);
                Console.WriteLine(extension.Value);
            }
        }
    }
}
```

## 查询机构下科室列表接口

### 接口功能

> 根据机构编码查询机构下所有科室列表

### 参考地址(URL)

> http://ip:port/api/appointment/query-departments

### HTTP请求方式(Method)

> GET

### 数据格式

> JSON（必须支持）
>
> XML（可选支持）

### 请求数据

#### 请求头(Request Header)

> 无

#### 查询参数(Query)

|      名称       | 是否必填 |   说明   |
| :-------------: | :------: | :------: |
| organization-id |    是    | 机构编码 |

#### 参考结构

> 无

#### 示例代码

> 无

### 响应数据

#### 响应头(Response Header)

> 无

#### 参考结构

```xml
<?xml version="1.0" encoding="utf-8" ?>
<Bundle xmlns="http://hl7.org/fhir">
    <id value="唯一标识，如uuid"/>
    <type value="searchset"/>
    <!-- 0..* ******************************科室****************************** -->
    <entry>
        <resource>
            <Organization xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Department"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 科室编号 NamingSystem uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-department-identifier"/>
                    <!-- 0..1 科室编号 -->
                    <value value="A001"/>
                </identifier>
                <!-- 0..1 是否可用 -->
                <active value="true"/>
                <!-- 0..1 组织机构层级种类（固定为科室） -->
                <type>
                    <coding>
                        <!-- 组织机构层级种类 CodeSystem地址 -->
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind"/>
                        <!-- 0..1 组织机构层级种类代码 -->
                        <code value="4"/>
                        <!-- 0..1 组织机构层级种类 -->
                        <display value="科室"/>
                    </coding>
                </type>
                <!-- 0..1 科室名称 -->
                <name value="普通外科"/>
                <!-- 0..* 别名 -->
                <alias value="外1科"/>
                <!-- 0..* 联系方式 -->
                <telecom>
                    <!-- 0..1 类型 phone | fax | email | pager | url | sms | other -->
                    <system value="phone"/>
                    <!-- 0..1 电话号码 -->
                    <value value="13309876352"/>
                </telecom>
                <!-- 0..1 电子邮箱 -->
                <telecom>
                    <!-- 0..1 类型 phone | fax | email | pager | url | sms | other -->
                    <system value="email"/>
                    <!-- 0..1 电子邮箱 -->
                    <value value=""/>
                </telecom>
                <!-- 0..* 地址 -->
                <address>
                    <!-- 0..1 地址的完整描述 -->
                    <text value=""/>
                </address>
                <!-- 0..1 科室所属医院 Reference(Organization) -->
                <partOf>
                    <reference value="Organization/OrganizationID"/>
                    <display value="医院描述"/>
                </partOf>
                <!-- 科室简介 -->
                <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction">
                    <!-- 科室简介 -->
                    <valueString value="XXXXXXXX科室针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。"/>
                </extension>
            </Organization>
        </resource>
    </entry>
</Bundle>
```

#### 示例代码

**JAVA**

```java
package fhir.预约挂号;

import org.hl7.fhir.r4.model.Address;
import org.hl7.fhir.r4.model.Bundle;
import org.hl7.fhir.r4.model.Bundle.BundleEntryComponent;
import org.hl7.fhir.r4.model.Bundle.BundleType;
import org.hl7.fhir.r4.model.CanonicalType;
import org.hl7.fhir.r4.model.CodeableConcept;
import org.hl7.fhir.r4.model.Coding;
import org.hl7.fhir.r4.model.ContactPoint;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointSystem;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointUse;
import org.hl7.fhir.r4.model.DomainResource;
import org.hl7.fhir.r4.model.Extension;
import org.hl7.fhir.r4.model.Identifier;
import org.hl7.fhir.r4.model.Meta;
import org.hl7.fhir.r4.model.Organization;
import org.hl7.fhir.r4.model.Reference;
import org.hl7.fhir.r4.model.Resource;
import org.hl7.fhir.r4.model.StringType;

import ca.uhn.fhir.context.FhirContext;

public class 查询机构下科室列表接口 {
    public void serialize() {
        Bundle bundle = new Bundle();
        bundle.setId("唯一标识，如uuid");
        bundle.setType(BundleType.SEARCHSET);
        bundle.addEntry(new BundleEntryComponent().setResource(assembleDepartment()));
        System.out.println(FhirContext.forR4().newJsonParser().encodeResourceToString(bundle));
    }

    public void deserialize() {
        String fhirJson = "序列化生成的json格式字符串";

        Bundle bundle = FhirContext.forR4().newJsonParser().parseResource(Bundle.class, fhirJson);
        System.out.println(bundle.getId());
        System.out.println(bundle.getType());

        for (BundleEntryComponent bundleEntryComponent : bundle.getEntry()) {
            Resource domainResource = bundleEntryComponent.getResource();
            if (domainResource instanceof Organization) {
                Organization department = (Organization) domainResource;
                disassembleDepartment(department);
            }
        }
    }

    public DomainResource assembleDepartment() {
        Organization department = new Organization();
        department.setId("唯一标识，如uuid");
        department.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Department"));
        department.addIdentifier(
            new Identifier().setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-department-identifier").setValue("A001"));
        department.setActive(true);
        department.addType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind", "4", "科室")));
        department.setName("普通外科");
        department.addAlias("外1科");
        department.addTelecom(new ContactPoint().setSystem(ContactPointSystem.PHONE).setUse(ContactPointUse.MOBILE).setValue("13309876352"));
        department.addTelecom(new ContactPoint().setSystem(ContactPointSystem.EMAIL).setUse(ContactPointUse.WORK).setValue("xx@xx.com"));
        department.addAddress(new Address().setText("xxxx地址"));
        department.setPartOf(new Reference("Organization/OrganizationID").setDisplay("科室所属医院描述"));
        department.addExtension(new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction")
            .setValue(new StringType("XXXXXXXX科室针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。")));
        return department;
    }

    private void disassembleDepartment(Organization department) {
        System.out.println(department.getId());
        for (CanonicalType profile : department.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : department.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        System.out.println(department.getActive());
        for (CodeableConcept type : department.getType()) {
            for (Coding coding : type.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        System.out.println(department.getName());
        for (StringType alias : department.getAlias()) {
            System.out.println(alias);
        }
        for (ContactPoint telecom : department.getTelecom()) {
            System.out.println(telecom.getSystem());
            System.out.println(telecom.getUse());
            System.out.println(telecom.getValue());
        }
        for (Address address : department.getAddress()) {
            System.out.println(address.getText());
        }
        System.out.println(department.getPartOf().getReference());
        System.out.println(department.getPartOf().getDisplay());
        for (Extension extension : department.getExtension()) {
            System.out.println(extension.getUrl());
            System.out.println(extension.getValue());
        }
    }
}
```

**C#**

```c#
using System;
using System.Collections.Generic;
using Hl7.Fhir.Model;
using Hl7.Fhir.Serialization;

namespace fhir.预约挂号
{
    public class 查询机构下科室列表接口
    {
        public void Serialize()
        {
            Bundle bundle = new Bundle();
            bundle.Id = "唯一标识，如uuid";
            bundle.Type = Bundle.BundleType.Searchset;
            bundle.Entry = new List<Bundle.EntryComponent>
            {
                new Bundle.EntryComponent { Resource = AssembleDepartment() }
            };
            Console.WriteLine(new FhirJsonSerializer().SerializeToString(bundle));
        }

        public void Deserialize()
        {
            string fhirJson = "序列化生成的json格式字符串";

            Bundle bundle = new FhirJsonParser().Parse<Bundle>(fhirJson);
            Console.WriteLine(bundle.Id);
            Console.WriteLine(bundle.Type);

            foreach (var entryComponent in bundle.Entry)
            {
                Resource domainResource = entryComponent.Resource;
                if (domainResource is Organization)
                {
                    Organization department = (Organization)domainResource;
                    DisassembleDepartment(department);
                }
            }
        }

        private DomainResource AssembleDepartment()
        {
            Organization department = new Organization();
            department.Id = "唯一标识，如uuid";
            department.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Department"
                }
            };
            department.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-department-identifier", "A001")
            };
            department.Active = true;
            department.Type = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind", "4", "科室", "科室")
            };
            department.Name = "普通外科";
            department.Alias = new List<string>
            {
                "外1科"
            };
            department.Telecom = new List<ContactPoint>
            {
                 new ContactPoint(ContactPoint.ContactPointSystem.Phone, ContactPoint.ContactPointUse.Mobile, "13309876352"),
                 new ContactPoint(ContactPoint.ContactPointSystem.Email, ContactPoint.ContactPointUse.Work, "xx@xx.com")
            };
            department.Address = new List<Address>
            {
                new Address()
                {
                    Text = "xxxx地址"
                }
            };
            department.PartOf = new ResourceReference("Organization/OrganizationID", "科室所属医院描述");
            department.Extension = new List<Extension>
            {
                new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction", new FhirString("XXXXXXXX科室针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。"))
            };
            return department;
        }

        private void DisassembleDepartment(Organization department)
        {
            Console.WriteLine(department.Id);
            foreach (var profile in department.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in department.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            Console.WriteLine(department.Active);
            foreach (var type in department.Type)
            {
                foreach (var coding in type.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            Console.WriteLine(department.Name);
            foreach (var alias in department.Alias)
            {
                Console.WriteLine(alias);
            }
            foreach (var telecom in department.Telecom)
            {
                Console.WriteLine(telecom.System);
                Console.WriteLine(telecom.Use);
                Console.WriteLine(telecom.Value);
            }
            foreach (var address in department.Address)
            {
                Console.WriteLine(address.Text);
            }
            Console.WriteLine(department.PartOf.Reference);
            Console.WriteLine(department.PartOf.Display);
            foreach (var extension in department.Extension)
            {
                Console.WriteLine(extension.Url);
                Console.WriteLine(extension.Value);
            }
        }
    }
}
```

## 查询科室下医生列表接口

### 接口功能

> 根据科室编码查询科室下某天排班的医生列表

### 参考地址(URL)

> http://ip:port/api/appointment/query-doctors

### HTTP请求方式(Method)

> GET

### 数据格式

> JSON（必须支持）
>
> XML（可选支持）

### 请求数据

#### 请求头(Request Header)

> 无

#### 查询参数(Query)

|      名称       | 是否必填 |   说明   |
| :-------------: | :------: | :------: |
| organization-id |    是    | 机构编码 |
|  department-id  |    是    | 科室编码 |
|  schedule-date  |    是    | 排班日期 |

#### 参考结构

> 无

#### 示例代码

> 无

### 响应数据

#### 响应头(Response Header)

> 无

#### 参考结构

```xml
<?xml version="1.0" encoding="utf-8" ?>
<Bundle xmlns="http://hl7.org/fhir">
    <id value="唯一标识，如uuid"/>
    <type value="searchset"/>
    <!-- 0..* ******************************医生****************************** -->
    <entry>
        <resource>
            <Practitioner xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid，身份证号"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Practitioner"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 适用范围 usual | official | temp | secondary | old -->
                    <use value="usual"/>
                    <!-- 0..1 类型 -->
                    <type>
                        <coding>
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type"/>
                            <code value="01"/>
                            <display value="身份证"/>
                        </coding>
                    </type>
                    <!-- 0..1 证件号码管理系统uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/practitioner-identifier"/>
                    <!-- 0..1 身份证件号码 -->
                    <value value="000000000000000000"/>
                </identifier>
                <!-- 0..1 是否在用 -->
                <active value="true"/>
                <!-- 0..* 姓名 -->
                <name>
                    <text value="王医生"/>
                </name>
                <!-- 0..* 联系方式 -->
                <telecom>
                    <system value="phone"/>
                    <value value="13387362766"/>
                </telecom>
                <!-- 0..1 性别 -->
                <gender>
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human">
                        <valueCoding>
                            <!-- 0..1 生理性别 CodeSystem url 地址-->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender"/>
                            <!-- 0..1 生理性别代码 -->
                            <code value="1"/>
                            <!-- 0..1 生理性别说明 -->
                            <display value="男性"/>
                        </valueCoding>
                    </extension>
                </gender>
                <!-- 0..1 出生日期 -->
                <birthDate value="1980-02-01"/>
                <!--0..* 地址-->
                <address>
                    <!-- 0..1 类型 home | work | temp | old | billing -->
                    <use value="home"/>
                    <!-- 0..1 地址的完整描述 -->
                    <text value="[string]"/>
                </address>
                <!-- 0..* 照片 -->
                <photo>
                    <contentType value="[MimeType]"/>
                    <url value="[url]"/>
                </photo>
            </Practitioner>
        </resource>
    </entry>
</Bundle>
```

#### 示例代码

**JAVA**

```java
package fhir.预约挂号;

import java.util.Date;

import org.hl7.fhir.r4.model.Address;
import org.hl7.fhir.r4.model.Address.AddressUse;
import org.hl7.fhir.r4.model.Attachment;
import org.hl7.fhir.r4.model.Bundle;
import org.hl7.fhir.r4.model.Bundle.BundleEntryComponent;
import org.hl7.fhir.r4.model.Bundle.BundleType;
import org.hl7.fhir.r4.model.CanonicalType;
import org.hl7.fhir.r4.model.CodeableConcept;
import org.hl7.fhir.r4.model.Coding;
import org.hl7.fhir.r4.model.ContactPoint;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointSystem;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointUse;
import org.hl7.fhir.r4.model.DomainResource;
import org.hl7.fhir.r4.model.Enumeration;
import org.hl7.fhir.r4.model.Enumerations;
import org.hl7.fhir.r4.model.Enumerations.AdministrativeGender;
import org.hl7.fhir.r4.model.Extension;
import org.hl7.fhir.r4.model.HumanName;
import org.hl7.fhir.r4.model.Identifier;
import org.hl7.fhir.r4.model.Identifier.IdentifierUse;
import org.hl7.fhir.r4.model.Meta;
import org.hl7.fhir.r4.model.Practitioner;
import org.hl7.fhir.r4.model.Resource;

import ca.uhn.fhir.context.FhirContext;

public class 查询科室下医生列表接口 {
    public void serialize() {
        Bundle bundle = new Bundle();
        bundle.setId("唯一标识，如uuid");
        bundle.setType(BundleType.SEARCHSET);
        bundle.addEntry(new BundleEntryComponent().setResource(assemblePractitioner()));
        System.out.println(FhirContext.forR4().newJsonParser().encodeResourceToString(bundle));
    }

    public void deserialize() {
        String fhirJson = "序列化生成的json格式字符串";

        Bundle bundle = FhirContext.forR4().newJsonParser().parseResource(Bundle.class, fhirJson);
        System.out.println(bundle.getId());
        System.out.println(bundle.getType());

        for (BundleEntryComponent bundleEntryComponent : bundle.getEntry()) {
            Resource domainResource = bundleEntryComponent.getResource();
            if (domainResource instanceof Practitioner) {
                Practitioner practitioner = (Practitioner) domainResource;
                disassemblePractitioner(practitioner);
            }
        }
    }

    private DomainResource assemblePractitioner() {
        Practitioner practitioner = new Practitioner();
        practitioner.setId("唯一标识，如uuid，身份证号");
        practitioner.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Practitioner"));
        practitioner.addIdentifier(new Identifier().setUse(IdentifierUse.USUAL)
            .setType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type", "01", "身份证")))
            .setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/practitioner-identifier").setValue("510102198804091172"));
        practitioner.setActive(true);
        practitioner.addName(new HumanName().setText("王医生"));
        practitioner.addTelecom(new ContactPoint().setSystem(ContactPointSystem.PHONE).setUse(ContactPointUse.MOBILE).setValue("13387362766"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender", "1", "男性"));
        Enumeration<AdministrativeGender> enumeration = new Enumeration<AdministrativeGender>(new Enumerations.AdministrativeGenderEnumFactory());
        enumeration.addExtension(extension);
        practitioner.setGenderElement(enumeration);
        practitioner.setBirthDate(new Date());
        practitioner.addAddress(new Address().setText("成都市XXX区XXX小区XXXX号").setUse(AddressUse.HOME));
        practitioner.addPhoto(new Attachment().setContentType("image/jpeg").setUrl("photo url"));
        return practitioner;
    }

    private void disassemblePractitioner(Practitioner practitioner) {
        System.out.println(practitioner.getId());
        for (CanonicalType profile : practitioner.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : practitioner.getIdentifier()) {
            for (Coding coding : identifier.getType().getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
            System.out.println(identifier.getUse());
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        System.out.println(practitioner.getActive());
        for (HumanName humanName : practitioner.getName()) {
            System.out.println(humanName.getText());
        }
        for (ContactPoint telecom : practitioner.getTelecom()) {
            System.out.println(telecom.getSystem());
            System.out.println(telecom.getUse());
            System.out.println(telecom.getValue());
        }
        for (Extension extension : practitioner.getGenderElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(practitioner.getBirthDate());
        for (Address address : practitioner.getAddress()) {
            System.out.println(address.getText());
        }
        for (Attachment attachment : practitioner.getPhoto()) {
            System.out.println(attachment.getContentType());
            System.out.println(attachment.getUrl());
        }
    }
}
```

**C#**

```c#
using System;
using System.Collections.Generic;
using Hl7.Fhir.Model;
using Hl7.Fhir.Serialization;

namespace fhir.预约挂号
{
    public class 查询科室下医生列表接口
    {
        public void Serialize()
        {
            Bundle bundle = new Bundle();
            bundle.Id = "唯一标识，如uuid";
            bundle.Type = Bundle.BundleType.Searchset;
            bundle.Entry = new List<Bundle.EntryComponent>
            {
                new Bundle.EntryComponent { Resource = AssemblePractitioner() }
            };
            Console.WriteLine(new FhirJsonSerializer().SerializeToString(bundle));
        }

        public void Deserialize()
        {
            string fhirJson = "序列化生成的json格式字符串";

            Bundle bundle = new FhirJsonParser().Parse<Bundle>(fhirJson);
            Console.WriteLine(bundle.Id);
            Console.WriteLine(bundle.Type);

            foreach (var entryComponent in bundle.Entry)
            {
                Resource domainResource = entryComponent.Resource;
                if (domainResource is Practitioner)
                {
                    Practitioner practitioner = (Practitioner)domainResource;
                    DisassemblePractitioner(practitioner);
                }
            }
        }

        private DomainResource AssemblePractitioner()
        {
            Practitioner practitioner = new Practitioner();
            practitioner.Id = "唯一标识，如uuid，身份证号";
            practitioner.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Practitioner"
                }
            };
            practitioner.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/practitioner-identifier", "510102198804091172")
                {
                    Use = Identifier.IdentifierUse.Usual,
                    Type = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type", "01", "身份证", "身份证")
                }
            };
            practitioner.Active = true;
            practitioner.Name = new List<HumanName>
            {
                new HumanName()
                {
                    Text = "王医生"
                }
            };
            practitioner.Telecom = new List<ContactPoint>
            {
                 new ContactPoint(ContactPoint.ContactPointSystem.Phone, ContactPoint.ContactPointUse.Mobile, "13387362766")
            };
            practitioner.GenderElement = new Code<AdministrativeGender>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender", "1", "男性"))
                }
            };
            practitioner.BirthDate = "1988-04-09";
            practitioner.Address = new List<Address>
            {
                new Address()
                {
                    Use = Address.AddressUse.Home,
                    Text = "成都市XXX区XXX小区XXXX号"
                }
            };
            practitioner.Photo = new List<Attachment>
            {
                new Attachment()
                {
                    ContentType = "image/jpeg",
                    Url = "photo url"
                }
            };

            return practitioner;
        }

        private void DisassemblePractitioner(Practitioner practitioner)
        {
            Console.WriteLine(practitioner.Id);
            foreach (var profile in practitioner.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in practitioner.Identifier)
            {
                foreach (var coding in identifier.Type.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
                Console.WriteLine(identifier.Use);
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            Console.WriteLine(practitioner.Active);
            foreach (var name in practitioner.Name)
            {
                Console.WriteLine(name.Text);
            }
            foreach (var telecom in practitioner.Telecom)
            {
                Console.WriteLine(telecom.System);
                Console.WriteLine(telecom.Use);
                Console.WriteLine(telecom.Value);
            }
            foreach (var extension in practitioner.GenderElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(practitioner.BirthDate);
            foreach (var address in practitioner.Address)
            {
                Console.WriteLine(address.Use);
                Console.WriteLine(address.Text);
            }
            foreach (var photo in practitioner.Photo)
            {
                Console.WriteLine(photo.ContentType);
                Console.WriteLine(photo.Url);
            }
        }
    }
}
```

## 查询医生号源接口

### 接口功能

> 根据日期查询指定科室下面某医生的号源

### 参考地址(URL)

> http://ip:port/api/appointment/query-source-number

### HTTP请求方式(Method)

> GET

### 数据格式

> JSON（必须支持）
>
> XML（可选支持）

### 请求数据

#### 请求头(Request Header)

> 无

#### 查询参数(Query)

|      名称       | 是否必填 |     说明     |
| :-------------: | :------: | :----------: |
| organization-id |    是    |   机构编码   |
|  department-id  |    是    |   科室编码   |
|  doctor-idcard  |    是    | 医生身份证号 |
|  schedule-date  |    是    |   排班日期   |

#### 参考结构

> 无

#### 示例代码

> 无

### 响应数据

#### 响应头(Response Header)

> 无

#### 参考结构

```xml
<?xml version="1.0" encoding="utf-8" ?>
<Bundle xmlns="http://hl7.org/fhir">
    <id value="唯一标识，如uuid"/>
    <type value="searchset"/>
    <!-- 0..* ******************************号源****************************** -->
    <entry>
        <resource>
            <Appointment xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"/>
                </meta>
                <!-- 0..* 预约挂号号源编号 -->
                <identifier>
                    <!-- 0..1 预约挂号号源编号NamingSystem uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier"/>
                    <!-- 0..1 预约挂号号源编号 -->
                    <value value="A0000001"/>
                </identifier>
                <!-- 1..1 预约状态 -->
                <status >
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status">
                        <valueCoding>
                            <!-- 0..1 预约状态 CodeSystem url -->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status"/>
                            <!-- 0..1 预约状态代码 -->
                            <code value="07"/>
                            <!-- 0..1 预约状态说明 -->
                            <display value="可用"/>
                        </valueCoding>
                    </extension>
                </status>
                <!-- 0..1 服务类型 -->
                <serviceType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc"/>
                        <code value="102"/>
                        <display value="专家门诊"/>
                    </coding>
                </serviceType>
                <!-- 0..1 预约类型 -->
                <appointmentType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code"/>
                        <code value="4"/>
                        <display value="网上预约"/>
                    </coding>
                    <text value="网上预约"/>
                </appointmentType>
                <!-- 0..1 开始时间 -->
                <start value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 结束时间 -->
                <end value="2020-11-10T14:00:00Z"/>
                <!-- 0..* 预约时段 Reference(Slot) -->
                <slot>
                    <reference value="Slot/SlotID"/>
                    <display value="时段描述"/>
                </slot>
                <!-- 0..1 创建挂号单时间 -->
                <created value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 注意事项 -->
                <patientInstruction value="[string]"/>
                <!-- 1..* 参与者 -->
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Practitioner/PractitionerID"/>
                        <display value="医生描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="needs-action"/>
                </participant>
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Location/LocationID"/>
                        <display value="诊室描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <!-- 0..* 费用信息 Reference(Any) -->
                <supportingInformation>
                    <reference value="ChargeItem/ChargeItemID"/>
                    <display value="缴费项描述"/>
                </supportingInformation>
            </Appointment>
        </resource>
    </entry>
    <!-- 0..* ******************************号源对应时段****************************** -->
    <entry>
        <resource>
            <Slot xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-slot"/>
                </meta>
                <!-- 0..1 服务类型 -->
                <serviceType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc"/>
                        <code value="102"/>
                        <display value="专家门诊"/>
                    </coding>
                </serviceType>
                <!-- 0..1 预约类型 -->
                <appointmentType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code"/>
                        <code value="4"/>
                        <display value="网上预约"/>
                    </coding>
                </appointmentType>
                <!-- 0..1 FHIR扩展，号源数 -->
                <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/source-number">
                    <valueRatio>
                        <!-- 0..1 已经挂号数字 -->
                        <numerator>
                            <value value="9"/>
                            <unit value="个"/>
                        </numerator>
                        <!-- 0..1 总号源数字 -->
                        <denominator>
                            <value value="10"/>
                            <unit value="个"/>
                        </denominator>
                    </valueRatio>
                </extension>
                <!-- 1..1 排班信息 Reference(Schedule) -->
                <schedule>
                    <reference value="Schedule/ScheduleID"/>
                    <display vlaue="排班描述"/>
                </schedule>
                <!-- 1..1 状态 busy | free | busy-unavailable | busy-tentative | entered-in-error  -->
                <status value="busy"/>
                <!-- 1..1 开始时段 -->
                <start value="2020-11-10T13:00:00Z"/>
                <!-- 1..1 结束时段 -->
                <end value="2020-11-10T14:00:00Z"/>
            </Slot>
        </resource>
    </entry>
    <!-- 0..* ******************************号源对应排班****************************** -->
    <entry>
        <resource>
            <Schedule xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-schedule"/>
                </meta>
                <!-- 0..1 服务类型 -->
                <serviceType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc"/>
                        <code value="102"/>
                        <display value="专家门诊"/>
                    </coding>
                </serviceType>
                <!-- 0..1 班次时段 -->
                <planningHorizon>
                    <start value="2020-11-10T13:00:00Z"/>
                    <end value="2020-11-10T14:00:00Z"/>
                </planningHorizon>
                <!-- 1..* 参与者 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                <actor>
                    <reference value="Practitioner/PractitionerID"/>
                    <display value="医生描述"/>
                </actor>
                <actor>
                    <reference value="Location/LocationID"/>
                    <display value="诊室描述"/>
                </actor>
                <!-- 0..1 排班备注 -->
                <comment value=""/>
            </Schedule>
        </resource>
    </entry>
    <!-- 0..* ******************************号源对应诊室****************************** -->
    <entry>
        <resource>
            <Location xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-consultation-room"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 诊室号NamingSystem uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-A001-consulting-room-identifier" />
                    <!-- 0..1 诊室号 -->
                    <value value="X00001" />
                </identifier>
                <!-- 0..1 状态 active | suspended | inactive -->
                <status value="active"/>
                <!-- 0..1 诊室名称 -->
                <name value="第一诊室" />
                <!-- 0..* 别名 -->
                <alias value="全科诊室" />
                <!-- 0..1 关于诊室的其他详细信息，可以作为进一步的信息显示 -->
                <description value="" />
                <!-- 0..1 对应科室 Reference(Organization) -->
                <managingOrganization>
                    <reference value="Organization/OrganizationID" />
                    <display value="科室描述"/>
                </managingOrganization>
            </Location>
        </resource>
    </entry>
    <!-- 0..1 ******************************号源对应医生****************************** -->
    <entry>
        <resource>
            <Practitioner xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid，身份证号"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Practitioner"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 适用范围 usual | official | temp | secondary | old -->
                    <use value="usual"/>
                    <!-- 0..1 类型 -->
                    <type>
                        <coding>
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type"/>
                            <code value="01"/>
                            <display value="身份证"/>
                        </coding>
                    </type>
                    <!--0..1 证件号码管理系统uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/practitioner-identifier"/>
                    <!-- 0..1 身份证件号码 -->
                    <value value="000000000000000000"/>
                </identifier>
                <!-- 0..1 是否在用 -->
                <active value="true"/>
                <!-- 0..* 姓名 -->
                <name>
                    <text value="王医生"/>
                </name>
                <!-- 0..* 联系方式 -->
                <telecom>
                    <system value="phone"/>
                    <value value="13387362766"/>
                </telecom>
                <!-- 0..1 性别 -->
                <gender>
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human">
                        <valueCoding>
                            <!-- 0..1 生理性别 CodeSystem url 地址 -->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender"/>
                            <!-- 0..1 生理性别代码 -->
                            <code value="1"/>
                            <!-- 0..1 生理性别说明 -->
                            <display value="男性"/>
                        </valueCoding>
                    </extension>
                </gender>
                <!-- 0..1 出生日期 -->
                <birthDate value="1980-02-01"/>
                <!-- 0..* 地址 -->
                <address>
                    <!-- 0..1 类型 home | work | temp | old | billing -->
                    <use value="home"/>
                    <!-- 0..1 地址的完整描述 -->
                    <text value="[string]"/>
                </address>
                <!-- 0..* 照片 -->
                <photo>
                    <contentType value="[MimeType]"/>
                    <url value="[url]"/>
                </photo>
            </Practitioner>
        </resource>
    </entry>
    <!-- 0..* ******************************号源对应费用****************************** -->
    <entry>
        <resource>
            <ChargeItem xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/ChargeItem"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 订单项编号 NamingSystem uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/91510107MA64H4GC5D-charge-item-identifier"/>
                    <!-- 0..1 订单项编号 -->
                    <value value="A00101"/>
                </identifier>
                <!-- 1..1 状态 -->
                <status >
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status">
                        <valueCoding>
                            <!-- 0..1 费用状态 CodeSystem url 地址(planned | billable | not-billable | aborted | billed | entered-in-error | unknown) -->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/chargeitem-status"/>
                            <!-- 0..1 费用状态代码 -->
                            <code value="02"/>
                            <!-- 0..1 费用状态说明 -->
                            <display value="未支付"/>
                        </valueCoding>
                    </extension>
                </status>
                <!-- 1..1 标识费用的代码 -->
                <code>
                    <coding>
                        <!-- 0..1 收费代码 -->
                        <code value=""/>
                        <!-- 0..1 收费代码说明 -->
                        <display value=""/>
                    </coding>
                </code>
                <!-- 0..1 价格 -->
                <priceOverride>
                    <value value="50"/>
                    <currency value="CNY"/>
                </priceOverride>
                <!-- 0..1 个数 -->
                <quantity>
                    <value value="1"/>
                </quantity>
                <!-- 0..1 备注 -->
                <note>
                    <text value="[备注]"/>
                </note>
            </ChargeItem>
        </resource>
    </entry>
</Bundle>
```

#### 示例代码

**JAVA**

```java
package fhir.预约挂号;

import java.util.Date;

import org.hl7.fhir.r4.model.Address;
import org.hl7.fhir.r4.model.Address.AddressUse;
import org.hl7.fhir.r4.model.Annotation;
import org.hl7.fhir.r4.model.Appointment;
import org.hl7.fhir.r4.model.Appointment.AppointmentParticipantComponent;
import org.hl7.fhir.r4.model.Appointment.AppointmentStatus;
import org.hl7.fhir.r4.model.Appointment.AppointmentStatusEnumFactory;
import org.hl7.fhir.r4.model.Appointment.ParticipationStatus;
import org.hl7.fhir.r4.model.Attachment;
import org.hl7.fhir.r4.model.Bundle;
import org.hl7.fhir.r4.model.Bundle.BundleEntryComponent;
import org.hl7.fhir.r4.model.Bundle.BundleType;
import org.hl7.fhir.r4.model.CanonicalType;
import org.hl7.fhir.r4.model.ChargeItem;
import org.hl7.fhir.r4.model.ChargeItem.ChargeItemStatus;
import org.hl7.fhir.r4.model.ChargeItem.ChargeItemStatusEnumFactory;
import org.hl7.fhir.r4.model.CodeableConcept;
import org.hl7.fhir.r4.model.Coding;
import org.hl7.fhir.r4.model.ContactPoint;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointSystem;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointUse;
import org.hl7.fhir.r4.model.DomainResource;
import org.hl7.fhir.r4.model.Enumeration;
import org.hl7.fhir.r4.model.Enumerations;
import org.hl7.fhir.r4.model.Enumerations.AdministrativeGender;
import org.hl7.fhir.r4.model.Extension;
import org.hl7.fhir.r4.model.HumanName;
import org.hl7.fhir.r4.model.Identifier;
import org.hl7.fhir.r4.model.Identifier.IdentifierUse;
import org.hl7.fhir.r4.model.Location;
import org.hl7.fhir.r4.model.Location.LocationStatus;
import org.hl7.fhir.r4.model.Meta;
import org.hl7.fhir.r4.model.Money;
import org.hl7.fhir.r4.model.Period;
import org.hl7.fhir.r4.model.Practitioner;
import org.hl7.fhir.r4.model.Quantity;
import org.hl7.fhir.r4.model.Ratio;
import org.hl7.fhir.r4.model.Reference;
import org.hl7.fhir.r4.model.Resource;
import org.hl7.fhir.r4.model.Schedule;
import org.hl7.fhir.r4.model.Slot;
import org.hl7.fhir.r4.model.StringType;

import ca.uhn.fhir.context.FhirContext;

public class 查询医生号源接口 {
    public void serialize() {
        Bundle bundle = new Bundle();
        bundle.setId("唯一标识，如uuid");
        bundle.setType(BundleType.SEARCHSET);
        bundle.addEntry(new BundleEntryComponent().setResource(assembleAppointment()));
        bundle.addEntry(new BundleEntryComponent().setResource(assembleSlot()));
        bundle.addEntry(new BundleEntryComponent().setResource(assembleSchedule()));
        bundle.addEntry(new BundleEntryComponent().setResource(assembleLocation()));
        bundle.addEntry(new BundleEntryComponent().setResource(assemblePractitioner()));
        bundle.addEntry(new BundleEntryComponent().setResource(assembleChargeItem()));
        System.out.println(FhirContext.forR4().newJsonParser().encodeResourceToString(bundle));
    }

    public void deserialize() {
        String fhirJson = "序列化生成的json格式字符串";

        Bundle bundle = FhirContext.forR4().newJsonParser().parseResource(Bundle.class, fhirJson);
        System.out.println(bundle.getId());
        System.out.println(bundle.getType());

        for (BundleEntryComponent bundleEntryComponent : bundle.getEntry()) {
            Resource domainResource = bundleEntryComponent.getResource();
            if (domainResource instanceof Appointment) {
                Appointment appointment = (Appointment) domainResource;
                disassembleAppointment(appointment);
            } else if (domainResource instanceof Slot) {
                Slot slot = (Slot) domainResource;
                disassembleSlot(slot);
            } else if (domainResource instanceof Schedule) {
                Schedule schedule = (Schedule) domainResource;
                disassembleSchedule(schedule);
            } else if (domainResource instanceof Location) {
                Location location = (Location) domainResource;
                disassembleLocation(location);
            } else if (domainResource instanceof Practitioner) {
                Practitioner practitioner = (Practitioner) domainResource;
                disassemblePractitioner(practitioner);
            } else if (domainResource instanceof ChargeItem) {
                ChargeItem chargeItem = (ChargeItem) domainResource;
                disassembleChargeItem(chargeItem);
            }
        }
    }

    private DomainResource assembleSlot() {
        Slot slot = new Slot();
        slot.setId("唯一标识，如uuid");
        slot.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-slot"));
        slot.addServiceType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊")));
        slot.setAppointmentType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code", "4", "网上预约")));
        Ratio ratio = new Ratio();
        ratio.setNumerator(new Quantity().setValue(10).setUnit("个"));
        ratio.setDenominator(new Quantity().setValue(50).setUnit("个"));
        slot.addExtension(new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/source-number").setValue(ratio));
        slot.setSchedule(new Reference("Schedule/ScheduleID").setDisplay("排班描述"));
        slot.setStatus(Slot.SlotStatus.BUSY);
        slot.setStart(new Date());
        slot.setEnd(new Date());
        return slot;
    }

    private DomainResource assembleAppointment() {
        Appointment appointment = new Appointment();
        appointment.setId("唯一标识，如uuid");
        appointment.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"));
        appointment.addIdentifier(new Identifier()
            .setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier").setValue("A0000001"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status", "01", "已申请"));
        Enumeration<AppointmentStatus> enumeration = new Enumeration<AppointmentStatus>(new AppointmentStatusEnumFactory());
        enumeration.addExtension(extension);
        appointment.setStatusElement(enumeration);
        appointment.addServiceType(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊")));
        appointment.setAppointmentType(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code", "4", "网上预约")).setText("网上预约"));
        appointment.setStart(new Date());
        appointment.setEnd(new Date());
        appointment.addSlot(new Reference("Slot/SlotID").setDisplay("时段描述"));
        appointment.setCreated(new Date());
        appointment.setPatientInstruction("注意事项");
        AppointmentParticipantComponent patientComponent = new AppointmentParticipantComponent();
        patientComponent.setActor(new Reference("Patient/PatientID").setDisplay("患者描述"));
        patientComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(patientComponent);
        AppointmentParticipantComponent practitionerComponent = new AppointmentParticipantComponent();
        practitionerComponent.setActor(new Reference("Practitioner/PractitionerID").setDisplay("医生描述"));
        practitionerComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(practitionerComponent);
        AppointmentParticipantComponent locationComponent = new AppointmentParticipantComponent();
        locationComponent.setActor(new Reference("Location/LocationID").setDisplay("诊室描述"));
        locationComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(locationComponent);
        appointment.addSupportingInformation(new Reference("ChargeItem/ChargeItemID").setDisplay("缴费项描述"));
        return appointment;
    }

    private DomainResource assembleSchedule() {
        Schedule schedule = new Schedule();
        schedule.setId("唯一标识，如uuid");
        schedule.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-schedule"));
        schedule.addServiceType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊")));
        schedule.setPlanningHorizon(new Period().setStart(new Date()).setEnd(new Date()));
        schedule.addActor(new Reference("Practitioner/PractitionerID").setDisplay("医生描述"));
        schedule.addActor(new Reference("Location/LocationID").setDisplay("诊室描述"));
        schedule.setComment("排班备注");
        return schedule;
    }

    private DomainResource assembleLocation() {
        Location location = new Location();
        location.setId("唯一标识，如uuid");
        location.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-consultation-room"));
        location.addIdentifier(new Identifier().setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-A001-consulting-room-identifier")
            .setValue("X00001"));
        location.setStatus(LocationStatus.ACTIVE);
        location.setName("第一诊室");
        location.addAlias("全科诊室");
        location.setDescription("诊室详情");
        location.setManagingOrganization(new Reference("Department/DepartmentID").setDisplay("科室描述"));
        return location;
    }

    private DomainResource assemblePractitioner() {
        Practitioner practitioner = new Practitioner();
        practitioner.setId("唯一标识，如uuid，身份证号");
        practitioner.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Practitioner"));
        practitioner.addIdentifier(new Identifier().setUse(IdentifierUse.USUAL)
            .setType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type", "01", "身份证")))
            .setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/practitioner-identifier").setValue("510102198804091172"));
        practitioner.setActive(true);
        practitioner.addName(new HumanName().setText("王医生"));
        practitioner.addTelecom(new ContactPoint().setSystem(ContactPointSystem.PHONE).setUse(ContactPointUse.MOBILE).setValue("13387362766"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender", "1", "男性"));
        Enumeration<AdministrativeGender> enumeration = new Enumeration<AdministrativeGender>(new Enumerations.AdministrativeGenderEnumFactory());
        enumeration.addExtension(extension);
        practitioner.setGenderElement(enumeration);
        practitioner.setBirthDate(new Date());
        practitioner.addAddress(new Address().setText("成都市XXX区XXX小区XXXX号").setUse(AddressUse.HOME));
        practitioner.addPhoto(new Attachment().setContentType("image/jpeg").setUrl("photo url"));
        return practitioner;
    }

    private DomainResource assembleChargeItem() {
        ChargeItem chargeItem = new ChargeItem();
        chargeItem.setId("唯一标识，如uuid");
        chargeItem.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/ChargeItem"));
        chargeItem.addIdentifier(
            new Identifier().setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/91510107MA64H4GC5D-charge-item-identifier").setValue("A00101"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/chargeitem-status", "01", "支付成功"));
        Enumeration<ChargeItemStatus> enumeration = new Enumeration<ChargeItemStatus>(new ChargeItemStatusEnumFactory());
        enumeration.addExtension(extension);
        chargeItem.setStatusElement(enumeration);
        chargeItem.setCode(new CodeableConcept()
            .addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Medical-Insurance-Payment-Dictionary", "收费代码", "收费代码说明")));
        chargeItem.setPriceOverride(new Money().setValue(50).setCurrency("CNY"));
        chargeItem.setQuantity(new Quantity(1));
        chargeItem.addNote(new Annotation().setText("备注"));
        return chargeItem;
    }

    private void disassembleAppointment(Appointment appointment) {
        System.out.println(appointment.getId());
        for (CanonicalType profile : appointment.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : appointment.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        for (Extension extension : appointment.getStatusElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        for (CodeableConcept serviceType : appointment.getServiceType()) {
            for (Coding coding : serviceType.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        for (Coding coding : appointment.getAppointmentType().getCoding()) {
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(appointment.getStart());
        System.out.println(appointment.getEnd());
        for (Reference slot : appointment.getSlot()) {
            System.out.println(slot.getReference());
            System.out.println(slot.getDisplay());
        }
        System.out.println(appointment.getCreated());
        System.out.println(appointment.getPatientInstruction());
        for (AppointmentParticipantComponent appointmentParticipantComponent : appointment.getParticipant()) {
            System.out.println(appointmentParticipantComponent.getActor().getReference());
            System.out.println(appointmentParticipantComponent.getActor().getDisplay());
            System.out.println(appointmentParticipantComponent.getStatus());
        }
        for (Reference supportingInformation : appointment.getSupportingInformation()) {
            System.out.println(supportingInformation.getReference());
            System.out.println(supportingInformation.getDisplay());
        }
    }

    private void disassembleSlot(Slot slot) {
        System.out.println(slot.getId());
        for (CanonicalType profile : slot.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (CodeableConcept serviceType : slot.getServiceType()) {
            for (Coding coding : serviceType.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        for (Coding coding : slot.getAppointmentType().getCoding()) {
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        for (Extension extension : slot.getExtension()) {
            System.out.println(extension.getUrl());
            Ratio ratio = (Ratio) extension.getValue();
            System.out.println(ratio.getNumerator().getValue());
            System.out.println(ratio.getNumerator().getUnit());
            System.out.println(ratio.getDenominator().getValue());
            System.out.println(ratio.getDenominator().getUnit());
        }
        System.out.println(slot.getSchedule().getReference());
        System.out.println(slot.getSchedule().getDisplay());
        System.out.println(slot.getStatus());
        System.out.println(slot.getStart());
        System.out.println(slot.getEnd());
    }

    private void disassembleSchedule(Schedule schedule) {
        System.out.println(schedule.getId());
        for (CanonicalType profile : schedule.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (CodeableConcept serviceType : schedule.getServiceType()) {
            for (Coding coding : serviceType.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        System.out.println(schedule.getPlanningHorizon().getStart());
        System.out.println(schedule.getPlanningHorizon().getEnd());
        for (Reference actor : schedule.getActor()) {
            System.out.println(actor.getReference());
            System.out.println(actor.getDisplay());
        }
        System.out.println(schedule.getComment());
    }

    private void disassembleLocation(Location location) {
        System.out.println(location.getId());
        for (CanonicalType profile : location.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : location.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        System.out.println(location.getStatus());
        System.out.println(location.getName());
        for (StringType alias : location.getAlias()) {
            System.out.println(alias);
        }
        System.out.println(location.getDescription());
        System.out.println(location.getManagingOrganization().getReference());
        System.out.println(location.getManagingOrganization().getDisplay());
    }

    private void disassemblePractitioner(Practitioner practitioner) {
        System.out.println(practitioner.getId());
        for (CanonicalType profile : practitioner.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : practitioner.getIdentifier()) {
            for (Coding coding : identifier.getType().getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
            System.out.println(identifier.getUse());
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        System.out.println(practitioner.getActive());
        for (HumanName humanName : practitioner.getName()) {
            System.out.println(humanName.getText());
        }
        for (ContactPoint telecom : practitioner.getTelecom()) {
            System.out.println(telecom.getSystem());
            System.out.println(telecom.getUse());
            System.out.println(telecom.getValue());
        }
        for (Extension extension : practitioner.getGenderElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(practitioner.getBirthDate());
        for (Address address : practitioner.getAddress()) {
            System.out.println(address.getText());
        }
        for (Attachment attachment : practitioner.getPhoto()) {
            System.out.println(attachment.getContentType());
            System.out.println(attachment.getUrl());
        }
    }

    private void disassembleChargeItem(ChargeItem chargeItem) {
        System.out.println(chargeItem.getId());
        for (CanonicalType profile : chargeItem.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : chargeItem.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        for (Extension extension : chargeItem.getStatusElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        for (Coding coding : chargeItem.getCode().getCoding()) {
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(chargeItem.getPriceOverride().getValue());
        System.out.println(chargeItem.getPriceOverride().getCurrency());
        System.out.println(chargeItem.getQuantity().getValue());
        for (Annotation note : chargeItem.getNote()) {
            System.out.println(note.getText());
        }
    }
}
```

**C#**

```c#
using System;
using System.Collections.Generic;
using Hl7.Fhir.Model;
using Hl7.Fhir.Serialization;

namespace fhir.预约挂号
{
    public class 查询医生号源接口
    {
        public void Serialize()
        {
            Bundle bundle = new Bundle();
            bundle.Id = "唯一标识，如uuid";
            bundle.Type = Bundle.BundleType.Searchset;
            bundle.Entry = new List<Bundle.EntryComponent>
            {
                new Bundle.EntryComponent { Resource = AssembleAppointment() },
                new Bundle.EntryComponent { Resource = AssembleSlot() },
                new Bundle.EntryComponent { Resource = AssembleSchedule() },
                new Bundle.EntryComponent { Resource = AssembleLocation() },
                new Bundle.EntryComponent { Resource = AssemblePractitioner() },
                new Bundle.EntryComponent { Resource = AssembleChargeItem() }
            };
            Console.WriteLine(new FhirJsonSerializer().SerializeToString(bundle));
        }

        public void Deserialize()
        {
            string fhirJson = "序列化生成的json格式字符串";

            Bundle bundle = new FhirJsonParser().Parse<Bundle>(fhirJson);
            Console.WriteLine(bundle.Id);
            Console.WriteLine(bundle.Type);

            foreach (var entryComponent in bundle.Entry)
            {
                Resource domainResource = entryComponent.Resource;
                if (domainResource is Appointment)
                {
                    Appointment appointment = (Appointment)domainResource;
                    DisassembleAppointment(appointment);
                }
                else if (domainResource is Slot)
                {
                    Slot slot = (Slot)domainResource;
                    DisassembleSlot(slot);
                }
                else if (domainResource is Schedule)
                {
                    Schedule schedule = (Schedule)domainResource;
                    DisassembleSchedule(schedule);
                }
                else if (domainResource is Location)
                {
                    Location location = (Location)domainResource;
                    DisassembleLocation(location);
                }
                else if (domainResource is Practitioner)
                {
                    Practitioner practitioner = (Practitioner)domainResource;
                    DisassemblePractitioner(practitioner);
                }
                else if (domainResource is ChargeItem)
                {
                    ChargeItem chargeItem = (ChargeItem)domainResource;
                    DisassembleChargeItem(chargeItem);
                }
            }
        }

        private DomainResource AssembleAppointment()
        {
            Appointment appointment = new Appointment();
            appointment.Id = "唯一标识，如uuid";
            appointment.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"
                }
            };
            appointment.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier", "A0000001")
            };
            appointment.StatusElement = new Code<Appointment.AppointmentStatus>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status", "07", "可用"))
                }
            };
            appointment.ServiceType = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊", "专家门诊")
            };
            appointment.AppointmentType = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-type", "4", "网上预约", "网上预约");
            appointment.Start = DateTime.Now;
            appointment.End = DateTime.Now;
            appointment.Slot = new List<ResourceReference>
            {
                new ResourceReference("Slot/SlotID", "时段描述")
            };
            appointment.Created = "2021-01-20T09:27:30";
            appointment.PatientInstruction = "注意事项";
            appointment.Participant = new List<Appointment.ParticipantComponent>
            {
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Practitioner/PractitionerID", "医生描述"),
                    Status = ParticipationStatus.Accepted
                },
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Location/LocationID", "诊室描述"),
                    Status = ParticipationStatus.Accepted
                }
            };
            appointment.SupportingInformation = new List<ResourceReference>
            {
                new ResourceReference("ChargeItem/ChargeItemID", "缴费项描述")
            };

            return appointment;
        }

        private DomainResource AssembleSlot()
        {
            Slot slot = new Slot();
            slot.Id = "唯一标识，如uuid";
            slot.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-slot"
                }
            };
            slot.ServiceType = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊", "专家门诊")
            };
            slot.AppointmentType = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-type", "4", "网上预约", "网上预约");
            slot.Extension = new List<Extension>
            {
                new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/source-number", new Ratio()
                {
                    Numerator = new Quantity(9, "个"),
                    Denominator = new Quantity(10, "个")
                })
            };
            slot.Schedule = new ResourceReference("Schedule/ScheduleID", "排班描述");
            slot.Status = Slot.SlotStatus.Busy;
            slot.Start = DateTime.Now;
            slot.End = DateTime.Now;

            return slot;
        }

        private DomainResource AssembleSchedule()
        {
            Schedule schedule = new Schedule();
            schedule.Id = "唯一标识，如uuid";
            schedule.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-schedule"
                }
            };
            schedule.ServiceType = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊", "专家门诊")
            };
            schedule.PlanningHorizon = new Period(new FhirDateTime(DateTimeOffset.Now), new FhirDateTime(DateTimeOffset.Now));
            schedule.Actor = new List<ResourceReference>
            {
                new ResourceReference("Practitioner/PractitionerID", "医生描述"),
                new ResourceReference("Location/LocationID", "诊室描述")
            };
            schedule.Comment = "排班备注";

            return schedule;
        }

        private DomainResource AssembleLocation()
        {
            Location location = new Location();
            location.Id = "唯一标识，如uuid";
            location.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-consultation-room"
                }
            };
            location.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-A001-consulting-room-identifier", "X00001")
            };
            location.Status = Location.LocationStatus.Active;
            location.Name = "第一诊室";
            location.Alias = new List<string>
            {
                "全科诊室"
            };
            location.Description = "诊室详情";
            location.ManagingOrganization = new ResourceReference("Department/DepartmentID", "科室描述");

            return location;
        }

        private DomainResource AssemblePractitioner()
        {
            Practitioner practitioner = new Practitioner();
            practitioner.Id = "唯一标识，如uuid，身份证号";
            practitioner.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Practitioner"
                }
            };
            practitioner.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/practitioner-identifier", "510102198804091172")
                {
                    Use = Identifier.IdentifierUse.Usual,
                    Type = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type", "01", "身份证", "身份证")
                }
            };
            practitioner.Active = true;
            practitioner.Name = new List<HumanName>
            {
                new HumanName()
                {
                    Text = "王医生"
                }
            };
            practitioner.Telecom = new List<ContactPoint>
            {
                 new ContactPoint(ContactPoint.ContactPointSystem.Phone, ContactPoint.ContactPointUse.Mobile, "13387362766")
            };
            practitioner.GenderElement = new Code<AdministrativeGender>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender", "1", "男性"))
                }
            };
            practitioner.BirthDate = "1988-04-09";
            practitioner.Address = new List<Address>
            {
                new Address()
                {
                    Use = Address.AddressUse.Home,
                    Text = "成都市XXX区XXX小区XXXX号"
                }
            };
            practitioner.Photo = new List<Attachment>
            {
                new Attachment()
                {
                    ContentType = "image/jpeg",
                    Url = "photo url"
                }
            };

            return practitioner;
        }

        private DomainResource AssembleChargeItem()
        {
            ChargeItem chargeItem = new ChargeItem();
            chargeItem.Id = "唯一标识，如uuid";
            chargeItem.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/ChargeItem"
                }
            };
            chargeItem.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/91510107MA64H4GC5D-charge-item-identifier", "A00101")
            };
            chargeItem.StatusElement = new Code<ChargeItem.ChargeItemStatus>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/chargeitem-status", "02", "未支付"))
                }
            };
            chargeItem.Code = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Medical-Insurance-Payment-Dictionary", "收费代码", "收费代码说明", "收费代码说明");
            chargeItem.PriceOverride = new Money
            {
                Value = 50,
                Currency = Money.Currencies.CNY
            };
            chargeItem.Quantity = new Quantity
            {
                Value = 1
            };
            chargeItem.Note = new List<Annotation>
            {
                new Annotation()
                {
                    Text= new Markdown("备注")
                }
            };

            return chargeItem;
        }

        private void DisassembleAppointment(Appointment appointment)
        {
            Console.WriteLine(appointment.Id);
            foreach (var profile in appointment.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in appointment.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            foreach (var extension in appointment.StatusElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            foreach (var serviceType in appointment.ServiceType)
            {
                foreach (var coding in serviceType.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            foreach (var coding in appointment.AppointmentType.Coding)
            {
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(appointment.Start);
            Console.WriteLine(appointment.End);
            foreach (var slot in appointment.Slot)
            {
                Console.WriteLine(slot.Reference);
                Console.WriteLine(slot.Display);
            }
            Console.WriteLine(appointment.Created);
            Console.WriteLine(appointment.PatientInstruction);
            foreach (var participant in appointment.Participant)
            {
                Console.WriteLine(participant.Actor.Reference);
                Console.WriteLine(participant.Actor.Display);
                Console.WriteLine(participant.Status);
            }
            foreach (var supportingInformation in appointment.SupportingInformation)
            {
                Console.WriteLine(supportingInformation.Reference);
                Console.WriteLine(supportingInformation.Display);
            }
        }

        private void DisassembleSlot(Slot slot)
        {
            Console.WriteLine(slot.Id);
            foreach (var profile in slot.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var serviceType in slot.ServiceType)
            {
                foreach (var coding in serviceType.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            foreach (var coding in slot.AppointmentType.Coding)
            {
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            foreach (var extension in slot.Extension)
            {
                Console.WriteLine(extension.Url);
                Ratio ratio = (Ratio)extension.Value;
                Console.WriteLine(ratio.Numerator.Value);
                Console.WriteLine(ratio.Numerator.Unit);
                Console.WriteLine(ratio.Denominator.Value);
                Console.WriteLine(ratio.Denominator.Unit);
            }
            Console.WriteLine(slot.Schedule.Reference);
            Console.WriteLine(slot.Schedule.Display);
            Console.WriteLine(slot.Status);
            Console.WriteLine(slot.Start);
            Console.WriteLine(slot.End);
        }

        private void DisassembleSchedule(Schedule schedule)
        {
            Console.WriteLine(schedule.Id);
            foreach (var profile in schedule.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var serviceType in schedule.ServiceType)
            {
                foreach (var coding in serviceType.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            Console.WriteLine(schedule.PlanningHorizon.Start);
            Console.WriteLine(schedule.PlanningHorizon.End);
            foreach (var actor in schedule.Actor)
            {
                Console.WriteLine(actor.Reference);
                Console.WriteLine(actor.Display);
            }
            Console.WriteLine(schedule.Comment);
        }

        private void DisassembleLocation(Location location)
        {
            Console.WriteLine(location.Id);
            foreach (var profile in location.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in location.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            Console.WriteLine(location.Status);
            Console.WriteLine(location.Name);
            foreach (var alias in location.Alias)
            {
                Console.WriteLine(alias);
            }
            Console.WriteLine(location.Description);
            Console.WriteLine(location.ManagingOrganization.Reference);
            Console.WriteLine(location.ManagingOrganization.Display);
        }

        private void DisassemblePractitioner(Practitioner practitioner)
        {
            Console.WriteLine(practitioner.Id);
            foreach (var profile in practitioner.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in practitioner.Identifier)
            {
                foreach (var coding in identifier.Type.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
                Console.WriteLine(identifier.Use);
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            Console.WriteLine(practitioner.Active);
            foreach (var name in practitioner.Name)
            {
                Console.WriteLine(name.Text);
            }
            foreach (var telecom in practitioner.Telecom)
            {
                Console.WriteLine(telecom.System);
                Console.WriteLine(telecom.Use);
                Console.WriteLine(telecom.Value);
            }
            foreach (var extension in practitioner.GenderElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(practitioner.BirthDate);
            foreach (var address in practitioner.Address)
            {
                Console.WriteLine(address.Use);
                Console.WriteLine(address.Text);
            }
            foreach (var photo in practitioner.Photo)
            {
                Console.WriteLine(photo.ContentType);
                Console.WriteLine(photo.Url);
            }
        }

        private void DisassembleChargeItem(ChargeItem chargeItem)
        {
            Console.WriteLine(chargeItem.Id);
            foreach (var profile in chargeItem.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in chargeItem.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            foreach (var extension in chargeItem.StatusElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            foreach (var coding in chargeItem.Code.Coding)
            {
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(chargeItem.PriceOverride.Value);
            Console.WriteLine(chargeItem.PriceOverride.Currency);
            Console.WriteLine(chargeItem.Quantity.Value);
            foreach (var note in chargeItem.Note)
            {
                Console.WriteLine(note.Text);
            }
        }
    }
}
```

## 挂号申请接口

### 接口功能

> 用户操作完预约挂号相关的前置流程后将调用该接口，根据用户选填的信息生成挂号申请单；接口提供方自行完成号源锁定等中间操作并返回挂号申请响应，响应中应携带一个支付链接用于调用方引导用户实现支付功能。

### 参考地址(URL)

> http://ip:port/api/appointment/create-appointment

### HTTP请求方式(Method)

> POST

### 数据格式

> JSON（必须支持）
>
> XML（可选支持）

### 请求数据

#### 请求头(Request Header)

> 无

#### 查询参数(Query)

|      名称       | 是否必填 |   说明   |
| :-------------: | :------: | :------: |
| organization-id |    是    | 机构编码 |

#### 参考结构

```xml
<?xml version="1.0" encoding="utf-8" ?>
<Bundle xmlns="http://hl7.org/fhir">
    <id value="唯一标识，如uuid"/>
    <type value="transaction"/>
    <!-- 0..1 ******************************挂号单****************************** -->
    <entry>
        <resource>
            <Appointment xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"/>
                </meta>
                <!-- 0..* 预约挂号号源编号 -->
                <identifier>
                    <!-- 0..1 预约挂号号源编号NamingSystem uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier"/>
                    <!-- 0..1 预约挂号号源编号 -->
                    <value value="A0000001"/>
                </identifier>
                <!-- 1..1 预约状态 -->
                <status >
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status">
                        <valueCoding>
                            <!-- 0..1 预约状态 CodeSystem url -->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status"/>
                            <!-- 0..1 预约状态代码 -->
                            <code value="01"/>
                            <!-- 0..1 预约状态说明 -->
                            <display value="已申请"/>
                        </valueCoding>
                    </extension>
                </status>
                <!-- 0..1 服务类型 -->
                <serviceType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc"/>
                        <code value="102"/>
                        <display value="专家门诊"/>
                    </coding>
                </serviceType>
                <!-- 0..1 预约类型 -->
                <appointmentType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code"/>
                        <code value="4"/>
                        <display value="网上预约"/>
                    </coding>
                    <text value="网上预约"/>
                </appointmentType>
                <!-- 0..1 开始时间 -->
                <start value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 结束时间 -->
                <end value="2020-11-10T14:00:00Z"/>
                <!-- 0..* 预约时段 Reference(Slot) -->
                <slot>
                    <reference value="Slot/SlotID"/>
                    <display value="时段描述"/>
                </slot>
                <!-- 0..1 创建挂号单时间 -->
                <created value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 注意事项 -->
                <patientInstruction value="[string]"/>
                <!-- 1..* 参与者 -->
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Patient/PatientID"/>
                        <display value="患者描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Practitioner/PractitionerID"/>
                        <display value="医生描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="needs-action"/>
                </participant>
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Location/LocationID"/>
                        <display value="诊室描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <!-- 0..* 费用信息 Reference(Any) -->
                <supportingInformation>
                    <reference value="ChargeItem/ChargeItemID"/>
                    <display value="缴费项描述"/>
                </supportingInformation>
            </Appointment>
        </resource>
    </entry>
    <!-- 0..1 ******************************患者信息****************************** -->
    <entry>
        <resource>
            <Patient xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid，身份证号"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Patient"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 适用范围 usual | official | temp | secondary | old -->
                    <use value="usual"/>
                    <!-- 0..1 类型 -->
                    <type>
                        <coding>
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type"/>
                            <code value="01"/>
                            <display value="身份证"/>
                        </coding>
                        <text value="身份证"/>
                    </type>
                    <!-- 0..1 证件号码管理系统uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/patient-identifier"/>
                    <!-- 0..1 身份证件号码 -->
                    <value value="511002938706190932"/>
                </identifier>
                <!-- 0..1 该患者记录是否在使用 -->
                <active value="true"/>
                <!-- 0..* 患者姓名 -->
                <name>
                    <text value="张三"/>
                </name>
                <!-- 0..* 联系方式 -->
                <telecom>
                    <system value="phone"/>
                    <value value="13387362763"/>
                </telecom>
                <!-- 0..1 性别 -->
                <gender>
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human">
                        <valueCoding>
                            <!-- 0..1 生理性别 CodeSystem url 地址 -->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender"/>
                            <!-- 0..1 生理性别代码 -->
                            <code value="1"/>
                            <!-- 0..1 生理性别说明 -->
                            <display value="男性"/>
                        </valueCoding>
                    </extension>
                </gender>
                <!-- 0..1 出生日期 -->
                <birthDate value="1980-02-01"/>
                <!-- 0..1 是否死亡 -->
                <deceasedBoolean value="false"/>
                <!-- 0..* 地址 -->
                <address>
                    <!-- 0..1 类型 home | work | temp | old | billing -->
                    <use value="home"/>
                    <!-- 0..1 地址的完整描述 -->
                    <text value="XX街xx路"/>
                </address>
                <!-- 0..* 照片 -->
                <photo>
                    <contentType value="[MimeType]"/>
                    <url value="[url]"/>
                </photo>
                <!-- 0..* 联系人 -->
                <contact>
                    <!-- 0..* 关系 -->
                    <relationship>
                        <coding>
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/family-relationship" />
                            <code value="5" />
                            <display value="父母"/>
                        </coding>
                        <text value="父母"/>
                    </relationship>
                    <!-- 0..1 联系人姓名 -->
                    <name>
                        <text value="李四" />
                    </name>
                    <!-- 0..* 联系方式 -->
                    <telecom>
                        <system value="phone"/>
                        <value value="13312345678"/>
                    </telecom>
                </contact>
            </Patient>
        </resource>
    </entry>
</Bundle>
```

#### 示例代码

**JAVA**

```java
package fhir.预约挂号;

import java.util.Date;

import org.hl7.fhir.r4.model.Address;
import org.hl7.fhir.r4.model.Address.AddressUse;
import org.hl7.fhir.r4.model.Appointment;
import org.hl7.fhir.r4.model.Appointment.AppointmentParticipantComponent;
import org.hl7.fhir.r4.model.Appointment.AppointmentStatus;
import org.hl7.fhir.r4.model.Appointment.AppointmentStatusEnumFactory;
import org.hl7.fhir.r4.model.Appointment.ParticipationStatus;
import org.hl7.fhir.r4.model.Attachment;
import org.hl7.fhir.r4.model.BooleanType;
import org.hl7.fhir.r4.model.Bundle;
import org.hl7.fhir.r4.model.Bundle.BundleEntryComponent;
import org.hl7.fhir.r4.model.Bundle.BundleType;
import org.hl7.fhir.r4.model.CanonicalType;
import org.hl7.fhir.r4.model.CodeableConcept;
import org.hl7.fhir.r4.model.Coding;
import org.hl7.fhir.r4.model.ContactPoint;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointSystem;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointUse;
import org.hl7.fhir.r4.model.DomainResource;
import org.hl7.fhir.r4.model.Enumeration;
import org.hl7.fhir.r4.model.Enumerations.AdministrativeGender;
import org.hl7.fhir.r4.model.Enumerations.AdministrativeGenderEnumFactory;
import org.hl7.fhir.r4.model.Extension;
import org.hl7.fhir.r4.model.HumanName;
import org.hl7.fhir.r4.model.Identifier;
import org.hl7.fhir.r4.model.Identifier.IdentifierUse;
import org.hl7.fhir.r4.model.Meta;
import org.hl7.fhir.r4.model.Patient;
import org.hl7.fhir.r4.model.Patient.ContactComponent;
import org.hl7.fhir.r4.model.Reference;
import org.hl7.fhir.r4.model.Resource;

import ca.uhn.fhir.context.FhirContext;

public class 挂号申请接口请求 {
    public void serialize() {
        Bundle bundle = new Bundle();
        bundle.setId("唯一标识，如uuid");
        bundle.setType(BundleType.TRANSACTION);
        bundle.addEntry(new BundleEntryComponent().setResource(assembleAppointment()));
        bundle.addEntry(new BundleEntryComponent().setResource(assemblePatient()));
        System.out.println(FhirContext.forR4().newJsonParser().encodeResourceToString(bundle));
    }

    public void deserialize() {
        String fhirJson = "序列化生成的json格式字符串";

        Bundle bundle = FhirContext.forR4().newJsonParser().parseResource(Bundle.class, fhirJson);
        System.out.println(bundle.getId());
        System.out.println(bundle.getType());

        for (BundleEntryComponent bundleEntryComponent : bundle.getEntry()) {
            Resource domainResource = bundleEntryComponent.getResource();
            if (domainResource instanceof Appointment) {
                Appointment appointment = (Appointment) domainResource;
                disassembleAppointment(appointment);
            } else if (domainResource instanceof Patient) {
                Patient patient = (Patient) domainResource;
                disassemblePatient(patient);
            }
        }
    }

    private DomainResource assembleAppointment() {
        Appointment appointment = new Appointment();
        appointment.setId("唯一标识，如uuid");
        appointment.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"));
        appointment.addIdentifier(new Identifier()
            .setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier").setValue("A0000001"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status", "01", "已申请"));
        Enumeration<AppointmentStatus> enumeration = new Enumeration<AppointmentStatus>(new AppointmentStatusEnumFactory());
        enumeration.addExtension(extension);
        appointment.setStatusElement(enumeration);
        appointment.addServiceType(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊")));
        appointment.setAppointmentType(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code", "4", "网上预约")).setText("网上预约"));
        appointment.setStart(new Date());
        appointment.setEnd(new Date());
        appointment.addSlot(new Reference("Slot/SlotID").setDisplay("时段描述"));
        appointment.setCreated(new Date());
        appointment.setPatientInstruction("注意事项");
        AppointmentParticipantComponent patientComponent = new AppointmentParticipantComponent();
        patientComponent.setActor(new Reference("Patient/PatientID").setDisplay("患者描述"));
        patientComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(patientComponent);
        AppointmentParticipantComponent practitionerComponent = new AppointmentParticipantComponent();
        practitionerComponent.setActor(new Reference("Practitioner/PractitionerID").setDisplay("医生描述"));
        practitionerComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(practitionerComponent);
        AppointmentParticipantComponent locationComponent = new AppointmentParticipantComponent();
        locationComponent.setActor(new Reference("Location/LocationID").setDisplay("诊室描述"));
        locationComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(locationComponent);
        appointment.addSupportingInformation(new Reference("ChargeItem/ChargeItemID").setDisplay("缴费项描述"));
        return appointment;
    }

    private DomainResource assemblePatient() {
        Patient patient = new Patient();
        patient.setId("唯一标识，如uuid，身份证号");
        patient.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Patient"));
        patient.addIdentifier(new Identifier().setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/patient-identifier").setValue("511002938706190932")
            .setUse(IdentifierUse.USUAL)
            .setType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type", "01", "身份证")).setText("居民身份证")));
        patient.setActive(true);
        patient.addName(new HumanName().setText("张三"));
        patient.addTelecom(new ContactPoint().setSystem(ContactPointSystem.PHONE).setUse(ContactPointUse.MOBILE).setValue("13387362763"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender", "1", "男性"));
        Enumeration<AdministrativeGender> enumeration = new Enumeration<AdministrativeGender>(new AdministrativeGenderEnumFactory());
        enumeration.addExtension(extension);
        patient.setGenderElement(enumeration);
        patient.setBirthDate(new Date());
        patient.setDeceased(new BooleanType(false));
        patient.addAddress(new Address().setUse(AddressUse.HOME).setText("XX街xx路"));
        patient.addPhoto().setContentType("image/jpeg").setUrl("photo url");
        ContactComponent contact = new ContactComponent();
        contact.addRelationship(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/family-relationship", "1", "配偶")).setText("配偶"));
        contact.setName(new HumanName().setText("李四"));
        contact.addTelecom().setSystem(ContactPointSystem.PHONE).setUse(ContactPointUse.MOBILE).setValue("13312345678");
        patient.addContact(contact);
        return patient;
    }

    private void disassembleAppointment(Appointment appointment) {
        System.out.println(appointment.getId());
        for (CanonicalType profile : appointment.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : appointment.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        for (Extension extension : appointment.getStatusElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        for (CodeableConcept serviceType : appointment.getServiceType()) {
            for (Coding coding : serviceType.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        for (Coding coding : appointment.getAppointmentType().getCoding()) {
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(appointment.getStart());
        System.out.println(appointment.getEnd());
        for (Reference slot : appointment.getSlot()) {
            System.out.println(slot.getReference());
            System.out.println(slot.getDisplay());
        }
        System.out.println(appointment.getCreated());
        System.out.println(appointment.getPatientInstruction());
        for (AppointmentParticipantComponent appointmentParticipantComponent : appointment.getParticipant()) {
            System.out.println(appointmentParticipantComponent.getActor().getReference());
            System.out.println(appointmentParticipantComponent.getActor().getDisplay());
            System.out.println(appointmentParticipantComponent.getStatus());
        }
        for (Reference supportingInformation : appointment.getSupportingInformation()) {
            System.out.println(supportingInformation.getReference());
            System.out.println(supportingInformation.getDisplay());
        }
    }

    private void disassemblePatient(Patient patient) {
        System.out.println(patient.getId());
        for (CanonicalType profile : patient.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : patient.getIdentifier()) {
            for (Coding coding : identifier.getType().getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
            System.out.println(identifier.getUse());
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        System.out.println(patient.getActive());
        for (HumanName humanName : patient.getName()) {
            System.out.println(humanName.getText());
        }
        for (ContactPoint telecom : patient.getTelecom()) {
            System.out.println(telecom.getSystem());
            System.out.println(telecom.getUse());
            System.out.println(telecom.getValue());
        }
        for (Extension extension : patient.getGenderElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(patient.getBirthDate());
        System.out.println(patient.getDeceasedBooleanType().booleanValue());
        for (Address address : patient.getAddress()) {
            System.out.println(address.getText());
        }
        for (Attachment attachment : patient.getPhoto()) {
            System.out.println(attachment.getContentType());
            System.out.println(attachment.getUrl());
        }
        for (ContactComponent contact : patient.getContact()) {
            for (CodeableConcept relationship : contact.getRelationship()) {
                for (Coding coding : relationship.getCoding()) {
                    System.out.println(coding.getSystem());
                    System.out.println(coding.getCode());
                    System.out.println(coding.getDisplay());
                }
            }
            System.out.println(contact.getName().getText());
            for (ContactPoint telecom : contact.getTelecom()) {
                System.out.println(telecom.getSystem());
                System.out.println(telecom.getUse());
                System.out.println(telecom.getValue());
            }
        }
    }
}
```

**C#**

```c#
using System;
using System.Collections.Generic;
using Hl7.Fhir.Model;
using Hl7.Fhir.Serialization;

namespace fhir.预约挂号
{
    public class 挂号申请接口请求
    {
        public void Serialize()
        {
            Bundle bundle = new Bundle();
            bundle.Id = "唯一标识，如uuid";
            bundle.Type = Bundle.BundleType.Transaction;
            bundle.Entry = new List<Bundle.EntryComponent>
            {
                new Bundle.EntryComponent { Resource = AssembleAppointment() },
                new Bundle.EntryComponent { Resource = AssemblePatient() }
            };
            Console.WriteLine(new FhirJsonSerializer().SerializeToString(bundle));
        }

        public void Deserialize()
        {
            string fhirJson = "序列化生成的json格式字符串";

            Bundle bundle = new FhirJsonParser().Parse<Bundle>(fhirJson);
            Console.WriteLine(bundle.Id);
            Console.WriteLine(bundle.Type);

            foreach (var entryComponent in bundle.Entry)
            {
                Resource domainResource = entryComponent.Resource;
                if (domainResource is Appointment)
                {
                    Appointment appointment = (Appointment)domainResource;
                    DisassembleAppointment(appointment);
                }
                else if (domainResource is Patient)
                {
                    Patient patient = (Patient)domainResource;
                    DisassemblePatient(patient);
                }
            }
        }

        private DomainResource AssembleAppointment()
        {
            Appointment appointment = new Appointment();
            appointment.Id = "唯一标识，如uuid";
            appointment.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"
                }
            };
            appointment.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier", "A0000001")
            };
            appointment.StatusElement = new Code<Appointment.AppointmentStatus>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status", "01", "已申请"))
                }
            };
            appointment.ServiceType = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊", "专家门诊")
            };
            appointment.AppointmentType = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-type", "4", "网上预约", "网上预约");
            appointment.Start = DateTime.Now;
            appointment.End = DateTime.Now;
            appointment.Slot = new List<ResourceReference>
            {
                new ResourceReference("Slot/SlotID", "时段描述")
            };
            appointment.Created = "2021-01-20T09:27:30";
            appointment.PatientInstruction = "注意事项";
            appointment.Participant = new List<Appointment.ParticipantComponent>
            {
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Patient/PatientID", "患者描述"),
                    Status = ParticipationStatus.Accepted
                },
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Practitioner/PractitionerID", "医生描述"),
                    Status = ParticipationStatus.Accepted
                },
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Location/LocationID", "诊室描述"),
                    Status = ParticipationStatus.Accepted
                }
            };
            appointment.SupportingInformation = new List<ResourceReference>
            {
                new ResourceReference("ChargeItem/ChargeItemID", "缴费项描述")
            };

            return appointment;
        }

        private DomainResource AssemblePatient()
        {
            Patient patient = new Patient();
            patient.Id = "唯一标识，如uuid，身份证号";
            patient.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Patient"
                }
            };
            patient.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/patient-identifier", "511002938706190932")
                {
                    Use = Identifier.IdentifierUse.Usual,
                    Type = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type", "01", "身份证", "身份证")
                }
            };
            patient.Active = true;
            patient.Name = new List<HumanName>
            {
                new HumanName()
                {
                    Text = "张三"
                }
            };
            patient.Telecom = new List<ContactPoint>
            {
                 new ContactPoint(ContactPoint.ContactPointSystem.Phone, ContactPoint.ContactPointUse.Mobile, "13387362763")
            };
            patient.GenderElement = new Code<AdministrativeGender>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender", "1", "男性"))
                }
            };
            patient.BirthDate = "1980-02-01";
            patient.Deceased = new FhirBoolean(false);
            patient.Address = new List<Address>
            {
                new Address()
                {
                    Use = Address.AddressUse.Home,
                    Text = "XX街xx路"
                }
            };
            patient.Photo = new List<Attachment>
            {
                new Attachment()
                {
                    ContentType = "image/jpeg",
                    Url = "photo url"
                }
            };
            patient.Contact = new List<Patient.ContactComponent>
            {
                new Patient.ContactComponent
                {
                    Relationship = new List<CodeableConcept>
                    {
                        new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/family-relationship", "1" ,"配偶" ,"配偶")
                    },
                    Name = new HumanName()
                    {
                        Text = "李四"
                    },
                    Telecom = new List<ContactPoint>
                    {
                        new ContactPoint(ContactPoint.ContactPointSystem.Phone, ContactPoint.ContactPointUse.Mobile, "13312345678")
                    }
                }
            };

            return patient;
        }

        private void DisassembleAppointment(Appointment appointment)
        {
            Console.WriteLine(appointment.Id);
            foreach (var profile in appointment.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in appointment.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            foreach (var extension in appointment.StatusElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            foreach (var serviceType in appointment.ServiceType)
            {
                foreach (var coding in serviceType.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            foreach (var coding in appointment.AppointmentType.Coding)
            {
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(appointment.Start);
            Console.WriteLine(appointment.End);
            foreach (var slot in appointment.Slot)
            {
                Console.WriteLine(slot.Reference);
                Console.WriteLine(slot.Display);
            }
            Console.WriteLine(appointment.Created);
            Console.WriteLine(appointment.PatientInstruction);
            foreach (var participant in appointment.Participant)
            {
                Console.WriteLine(participant.Actor.Reference);
                Console.WriteLine(participant.Actor.Display);
                Console.WriteLine(participant.Status);
            }
            foreach (var supportingInformation in appointment.SupportingInformation)
            {
                Console.WriteLine(supportingInformation.Reference);
                Console.WriteLine(supportingInformation.Display);
            }
        }

        private void DisassemblePatient(Patient patient)
        {
            Console.WriteLine(patient.Id);
            foreach (var profile in patient.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in patient.Identifier)
            {
                foreach (var coding in identifier.Type.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
                Console.WriteLine(identifier.Use);
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            Console.WriteLine(patient.Active);
            foreach (var name in patient.Name)
            {
                Console.WriteLine(name.Text);
            }
            foreach (var telecom in patient.Telecom)
            {
                Console.WriteLine(telecom.System);
                Console.WriteLine(telecom.Use);
                Console.WriteLine(telecom.Value);
            }
            foreach (var extension in patient.GenderElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(patient.BirthDate);
            Console.WriteLine(patient.Deceased);
            foreach (var address in patient.Address)
            {
                Console.WriteLine(address.Use);
                Console.WriteLine(address.Text);
            }
            foreach (var photo in patient.Photo)
            {
                Console.WriteLine(photo.ContentType);
                Console.WriteLine(photo.Url);
            }
            foreach (var contact in patient.Contact)
            {
                foreach (var relationship in contact.Relationship)
                {
                    foreach (var coding in relationship.Coding)
                    {
                        Console.WriteLine(coding.System);
                        Console.WriteLine(coding.Code);
                        Console.WriteLine(coding.Display);
                    }
                    Console.WriteLine(relationship.Text);
                }
                Console.WriteLine(contact.Name.Text);
                foreach (var telecom in contact.Telecom)
                {
                    Console.WriteLine(telecom.System);
                    Console.WriteLine(telecom.Use);
                    Console.WriteLine(telecom.Value);
                }
            }
        }
    }
}
```

### 响应数据

#### 响应头(Response Header)

> 无

#### 参考结构

```xml
<?xml version="1.0" encoding="utf-8" ?>
<Bundle xmlns="http://hl7.org/fhir">
    <id value="唯一标识，如uuid"/>
    <meta>
		<tag>
			<extension url="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-url">
				<valueString value="支付页面url"></valueString>
			</extension>
            <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-timeout">
                <valueDateTime value="2021-03-08T11:30:57+08:00"></valueDateTime>
            </extension>
			<system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/invoke-type"></system>
			<code value="APP"></code>
			<display value="应用程序"></display>
		</tag>
	</meta>
    <type value="transaction-response"/>
    <!-- 0..1 ******************************挂号应答****************************** -->
    <entry>
        <resource>
            <AppointmentResponse xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/registrated-response"/>
                </meta>
                <!-- 1..1 Reference(Appointment) 号源编号 -->
                <appointment>
                    <reference value="Appointment/AppointmentID"/>
                    <display value="号源描述"/>
                </appointment>
                <!-- 0..1 开始时间 -->
                <start value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 结束时间 -->
                <end value="2020-11-10T14:00:00Z"/>
                <!-- 0..1 响应医生 -->
                <actor>
                    <reference value="Practitioner/PractitionerID"/>
                    <display value="医生描述"/>
                </actor>
                <!-- 1..1 响应状态 accepted   accepted | declined | tentative | needs-action -->
                <participantStatus value="accepted"/>
                <!-- 0..1 备注 -->
                <comment value="同意挂号预约"/>
            </AppointmentResponse>
        </resource>
    </entry>
</Bundle>
```

#### 示例代码

**JAVA**

```java
package fhir.预约挂号;

import java.util.Date;

import org.apache.commons.lang3.StringUtils;
import org.hl7.fhir.r4.model.AppointmentResponse;
import org.hl7.fhir.r4.model.AppointmentResponse.ParticipantStatus;
import org.hl7.fhir.r4.model.Bundle;
import org.hl7.fhir.r4.model.Bundle.BundleEntryComponent;
import org.hl7.fhir.r4.model.Bundle.BundleType;
import org.hl7.fhir.r4.model.CanonicalType;
import org.hl7.fhir.r4.model.Coding;
import org.hl7.fhir.r4.model.DateTimeType;
import org.hl7.fhir.r4.model.DomainResource;
import org.hl7.fhir.r4.model.Extension;
import org.hl7.fhir.r4.model.Meta;
import org.hl7.fhir.r4.model.Reference;
import org.hl7.fhir.r4.model.Resource;
import org.hl7.fhir.r4.model.StringType;

import ca.uhn.fhir.context.FhirContext;

public class 挂号申请接口响应 {
    public void serialize() {
        Bundle bundle = new Bundle();
        bundle.setId("唯一标识，如uuid");
        Coding coding = new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/invoke-type", "APP", "应用程序");
        coding.addExtension(new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-url", new StringType("支付页面url")));
        coding.addExtension(new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-timeout", new DateTimeType(new Date())));
        bundle.setMeta(new Meta().addTag(coding));
        bundle.setType(BundleType.TRANSACTIONRESPONSE);
        bundle.addEntry(new BundleEntryComponent().setResource(assembleAppointmentResponse()));
        System.out.println(FhirContext.forR4().newJsonParser().encodeResourceToString(bundle));
    }

    public void deserialize() {
        String fhirJson = "序列化生成的json格式字符串";

        Bundle bundle = FhirContext.forR4().newJsonParser().parseResource(Bundle.class, fhirJson);
        System.out.println(bundle.getId());
        for (Coding coding : bundle.getMeta().getTag()) {
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
            for (Extension extension : coding.getExtension()) {
                System.out.println(extension.getUrl());
                if (StringUtils.equals(extension.getUrl(), "https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-url")) {
                    StringType stringType = (StringType) extension.getValue();
                    System.out.println(stringType.getValue());
                } else if (StringUtils.equals(extension.getUrl(), "https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-timeout")) {
                    DateTimeType dateTimeType = (DateTimeType) extension.getValue();
                    System.out.println(dateTimeType.getValue());
                }
            }
        }
        System.out.println(bundle.getType());

        for (BundleEntryComponent bundleEntryComponent : bundle.getEntry()) {
            Resource domainResource = bundleEntryComponent.getResource();
            if (domainResource instanceof AppointmentResponse) {
                AppointmentResponse appointmentResponse = (AppointmentResponse) domainResource;
                disassembleAppointmentResponse(appointmentResponse);
            }
        }
    }

    private DomainResource assembleAppointmentResponse() {
        AppointmentResponse appointmentResponse = new AppointmentResponse();
        appointmentResponse.setId("唯一标识，如uuid");
        appointmentResponse.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/registrated-response"));
        appointmentResponse.setAppointment(new Reference("Appointment/AppointmentID").setDisplay("号源描述"));
        appointmentResponse.setStart(new Date());
        appointmentResponse.setEnd(new Date());
        appointmentResponse.setActor(new Reference("Practitioner/PractitionerID").setDisplay("医生描述"));
        appointmentResponse.setParticipantStatus(ParticipantStatus.ACCEPTED);
        appointmentResponse.setComment("同意挂号预约");
        return appointmentResponse;
    }

    private void disassembleAppointmentResponse(AppointmentResponse appointmentResponse) {
        System.out.println(appointmentResponse.getId());
        for (CanonicalType profile : appointmentResponse.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        System.out.println(appointmentResponse.getAppointment().getReference());
        System.out.println(appointmentResponse.getAppointment().getDisplay());
        System.out.println(appointmentResponse.getStart());
        System.out.println(appointmentResponse.getEnd());
        System.out.println(appointmentResponse.getActor().getReference());
        System.out.println(appointmentResponse.getActor().getDisplay());
        System.out.println(appointmentResponse.getParticipantStatus());
        System.out.println(appointmentResponse.getComment());
    }
}
```

**C#**

```c#
using System;
using System.Collections.Generic;
using Hl7.Fhir.Model;
using Hl7.Fhir.Serialization;

namespace fhir.预约挂号
{
    public class 挂号申请接口响应
    {
        public void Serialize()
        {
            Bundle bundle = new Bundle();
            bundle.Id = "唯一标识，如uuid";
            bundle.Meta = new Meta
            {
                Tag = new List<Coding>
                {
                    new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/invoke-type", "APP", "应用程序")
                    {
                        Extension = new List<Extension>
                        {
                            new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-url", new FhirString("支付页面url"))
                        }
                    }
                }
            };
            bundle.Type = Bundle.BundleType.TransactionResponse;
            bundle.Entry = new List<Bundle.EntryComponent>
            {
                new Bundle.EntryComponent { Resource = AssembleAppointmentResponse() }
            };
            Console.WriteLine(new FhirJsonSerializer().SerializeToString(bundle));
        }

        public void Deserialize()
        {
            string fhirJson = "序列化生成的json格式字符串";

            Bundle bundle = new FhirJsonParser().Parse<Bundle>(fhirJson);
            Console.WriteLine(bundle.Id);
            foreach (var coding in bundle.Meta.Tag)
            {
                foreach (var extension in coding.Extension)
                {
                    Console.WriteLine(extension.Url);
                    if (extension.Url.Equals("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-url"))
                    {
                        FhirString fhirString = (FhirString)extension.Value;
                        Console.WriteLine(fhirString.Value);
                    }
                    else if (extension.Url.Equals("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-timeout"))
                    {
                        FhirDateTime fhirDateTime = (FhirDateTime)extension.Value;
                        Console.WriteLine(fhirDateTime.Value);
                    }
                }
            }
            Console.WriteLine(bundle.Type);

            foreach (var entryComponent in bundle.Entry)
            {
                Resource domainResource = entryComponent.Resource;
                if (domainResource is AppointmentResponse)
                {
                    AppointmentResponse appointmentResponse = (AppointmentResponse)domainResource;
                    DisassembleAppointmentResponse(appointmentResponse);
                }
            }
        }

        private DomainResource AssembleAppointmentResponse()
        {
            AppointmentResponse appointmentResponse = new AppointmentResponse();
            appointmentResponse.Id = "唯一标识，如uuid";
            appointmentResponse.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/registrated-response"
                }
            };
            appointmentResponse.Appointment = new ResourceReference("Appointment/AppointmentID", "号源描述");
            appointmentResponse.Start = DateTime.Now;
            appointmentResponse.End = DateTime.Now;
            appointmentResponse.Actor = new ResourceReference("Practitioner/PractitionerID", "医生描述");
            appointmentResponse.ParticipantStatus = ParticipationStatus.Accepted;
            appointmentResponse.Comment = "同意挂号预约";

            return appointmentResponse;
        }

        private void DisassembleAppointmentResponse(AppointmentResponse appointmentResponse)
        {
            Console.WriteLine(appointmentResponse.Id);
            foreach (var profile in appointmentResponse.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            Console.WriteLine(appointmentResponse.Appointment.Reference);
            Console.WriteLine(appointmentResponse.Appointment.Display);
            Console.WriteLine(appointmentResponse.Start);
            Console.WriteLine(appointmentResponse.End);
            Console.WriteLine(appointmentResponse.Actor.Reference);
            Console.WriteLine(appointmentResponse.Actor.Display);
            Console.WriteLine(appointmentResponse.ParticipantStatus);
            Console.WriteLine(appointmentResponse.Comment);
        }
    }
}
```

## 查询挂号列表接口

### 接口功能

> 根据患者身份证号查询挂号列表

### 参考地址(URL)

> http://ip:port/api/appointment/query-appointments

### HTTP请求方式(Method)

> GET

### 数据格式

> JSON（必须支持）
>
> XML（可选支持）

### 请求数据

#### 请求头(Request Header)

> 无

#### 查询参数(Query)

|      名称       | 是否必填 |     说明     |
| :-------------: | :------: | :----------: |
| organization-id |    是    |   机构编码   |
| patient-idcard  |    是    | 患者身份证号 |

#### 参考结构

> 无

#### 示例代码

> 无

### 响应数据

#### 响应头(Response Header)

> 无

#### 参考结构

```xml
<?xml version="1.0" encoding="utf-8" ?>
<Bundle xmlns="http://hl7.org/fhir">
    <id value="唯一标识，如uuid"/>
    <type value="searchset"/>
    <!-- 0..* ******************************挂号单****************************** -->
    <entry>
        <resource>
            <Appointment xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"/>
                </meta>
                <!-- 0..* 预约挂号号源编号 -->
                <identifier>
                    <!-- 0..1 预约挂号号源编号NamingSystem uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier"/>
                    <!-- 0..1 预约挂号号源编号 -->
                    <value value="A0000001"/>
                </identifier>
                <!-- 1..1 预约状态 -->
                <status >
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status">
                        <valueCoding>
                            <!-- 0..1 预约状态 CodeSystem url -->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status"/>
                            <!-- 0..1 预约状态代码 -->
                            <code value="02"/>
                            <!-- 0..1 预约状态说明 -->
                            <display value="已预约"/>
                        </valueCoding>
                    </extension>
                </status>
                <!-- 0..1 服务类型 -->
                <serviceType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc"/>
                        <code value="102"/>
                        <display value="专家门诊"/>
                    </coding>
                </serviceType>
                <!-- 0..1 预约类型 -->
                <appointmentType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code"/>
                        <code value="4"/>
                        <display value="网上预约"/>
                    </coding>
                    <text value="网上预约"/>
                </appointmentType>
                <!-- 0..1 开始时间 -->
                <start value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 结束时间 -->
                <end value="2020-11-10T14:00:00Z"/>
                <!-- 0..* 预约时段 Reference(Slot) -->
                <slot>
                    <reference value="Slot/SlotID"/>
                    <display value="时段描述"/>
                </slot>
                <!-- 0..1 创建挂号单时间 -->
                <created value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 注意事项 -->
                <patientInstruction value="[string]"/>
                <!-- 1..* 参与者 -->
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Patient/PatientID"/>
                        <display value="患者描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Practitioner/PractitionerID"/>
                        <display value="医生描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Location/LocationID"/>
                        <display value="诊室描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <!-- 0..* 费用信息 Reference(Any) -->
                <supportingInformation>
                    <reference value="ChargeItem/ChargeItemID"/>
                    <display value="缴费项描述"/>
                </supportingInformation>
            </Appointment>
        </resource>
    </entry>
</Bundle>
```

#### 示例代码

**JAVA**

```java
package fhir.预约挂号;

import java.util.Date;

import org.hl7.fhir.r4.model.Appointment;
import org.hl7.fhir.r4.model.Appointment.AppointmentParticipantComponent;
import org.hl7.fhir.r4.model.Appointment.AppointmentStatus;
import org.hl7.fhir.r4.model.Appointment.AppointmentStatusEnumFactory;
import org.hl7.fhir.r4.model.Appointment.ParticipationStatus;
import org.hl7.fhir.r4.model.Bundle;
import org.hl7.fhir.r4.model.Bundle.BundleEntryComponent;
import org.hl7.fhir.r4.model.Bundle.BundleType;
import org.hl7.fhir.r4.model.CanonicalType;
import org.hl7.fhir.r4.model.CodeableConcept;
import org.hl7.fhir.r4.model.Coding;
import org.hl7.fhir.r4.model.DomainResource;
import org.hl7.fhir.r4.model.Enumeration;
import org.hl7.fhir.r4.model.Extension;
import org.hl7.fhir.r4.model.Identifier;
import org.hl7.fhir.r4.model.Meta;
import org.hl7.fhir.r4.model.Reference;
import org.hl7.fhir.r4.model.Resource;

import ca.uhn.fhir.context.FhirContext;

public class 查询挂号列表接口 {
    public void serialize() {
        Bundle bundle = new Bundle();
        bundle.setId("唯一标识，如uuid");
        bundle.setType(BundleType.SEARCHSET);
        bundle.addEntry(new BundleEntryComponent().setResource(assembleAppointment()));
        System.out.println(FhirContext.forR4().newJsonParser().encodeResourceToString(bundle));
    }

    public void deserialize() {
        String fhirJson = "序列化生成的json格式字符串";

        Bundle bundle = FhirContext.forR4().newJsonParser().parseResource(Bundle.class, fhirJson);
        System.out.println(bundle.getId());
        System.out.println(bundle.getType());

        for (BundleEntryComponent bundleEntryComponent : bundle.getEntry()) {
            Resource domainResource = bundleEntryComponent.getResource();
            if (domainResource instanceof Appointment) {
                Appointment appointment = (Appointment) domainResource;
                disassembleAppointment(appointment);
            }
        }
    }

    private DomainResource assembleAppointment() {
        Appointment appointment = new Appointment();
        appointment.setId("唯一标识，如uuid");
        appointment.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"));
        appointment.addIdentifier(new Identifier()
            .setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier").setValue("A0000001"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status", "01", "已申请"));
        Enumeration<AppointmentStatus> enumeration = new Enumeration<AppointmentStatus>(new AppointmentStatusEnumFactory());
        enumeration.addExtension(extension);
        appointment.setStatusElement(enumeration);
        appointment.addServiceType(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊")));
        appointment.setAppointmentType(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code", "4", "网上预约")).setText("网上预约"));
        appointment.setStart(new Date());
        appointment.setEnd(new Date());
        appointment.addSlot(new Reference("Slot/SlotID").setDisplay("时段描述"));
        appointment.setCreated(new Date());
        appointment.setPatientInstruction("注意事项");
        AppointmentParticipantComponent patientComponent = new AppointmentParticipantComponent();
        patientComponent.setActor(new Reference("Patient/PatientID").setDisplay("患者描述"));
        patientComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(patientComponent);
        AppointmentParticipantComponent practitionerComponent = new AppointmentParticipantComponent();
        practitionerComponent.setActor(new Reference("Practitioner/PractitionerID").setDisplay("医生描述"));
        practitionerComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(practitionerComponent);
        AppointmentParticipantComponent locationComponent = new AppointmentParticipantComponent();
        locationComponent.setActor(new Reference("Location/LocationID").setDisplay("诊室描述"));
        locationComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(locationComponent);
        appointment.addSupportingInformation(new Reference("ChargeItem/ChargeItemID").setDisplay("缴费项描述"));
        return appointment;
    }

    private void disassembleAppointment(Appointment appointment) {
        System.out.println(appointment.getId());
        for (CanonicalType profile : appointment.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : appointment.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        for (Extension extension : appointment.getStatusElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        for (CodeableConcept serviceType : appointment.getServiceType()) {
            for (Coding coding : serviceType.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        for (Coding coding : appointment.getAppointmentType().getCoding()) {
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(appointment.getStart());
        System.out.println(appointment.getEnd());
        for (Reference slot : appointment.getSlot()) {
            System.out.println(slot.getReference());
            System.out.println(slot.getDisplay());
        }
        System.out.println(appointment.getCreated());
        System.out.println(appointment.getPatientInstruction());
        for (AppointmentParticipantComponent appointmentParticipantComponent : appointment.getParticipant()) {
            System.out.println(appointmentParticipantComponent.getActor().getReference());
            System.out.println(appointmentParticipantComponent.getActor().getDisplay());
            System.out.println(appointmentParticipantComponent.getStatus());
        }
        for (Reference supportingInformation : appointment.getSupportingInformation()) {
            System.out.println(supportingInformation.getReference());
            System.out.println(supportingInformation.getDisplay());
        }
    }
}
```

**C#**

```c#
using System;
using System.Collections.Generic;
using Hl7.Fhir.Model;
using Hl7.Fhir.Serialization;

namespace fhir.预约挂号
{
    public class 查询挂号列表接口
    {
        public void Serialize()
        {
            Bundle bundle = new Bundle();
            bundle.Id = "唯一标识，如uuid";
            bundle.Type = Bundle.BundleType.Searchset;
            bundle.Entry = new List<Bundle.EntryComponent>
            {
                new Bundle.EntryComponent { Resource = AssembleAppointment() }
            };
            Console.WriteLine(new FhirJsonSerializer().SerializeToString(bundle));
        }

        public void Deserialize()
        {
            string fhirJson = "序列化生成的json格式字符串";

            Bundle bundle = new FhirJsonParser().Parse<Bundle>(fhirJson);
            Console.WriteLine(bundle.Id);
            Console.WriteLine(bundle.Type);

            foreach (var entryComponent in bundle.Entry)
            {
                Resource domainResource = entryComponent.Resource;
                if (domainResource is Appointment)
                {
                    Appointment appointment = (Appointment)domainResource;
                    DisassembleAppointment(appointment);
                }
            }
        }

        private DomainResource AssembleAppointment()
        {
            Appointment appointment = new Appointment();
            appointment.Id = "唯一标识，如uuid";
            appointment.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"
                }
            };
            appointment.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier", "A0000001")
            };
            appointment.StatusElement = new Code<Appointment.AppointmentStatus>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status", "02", "已预约"))
                }
            };
            appointment.ServiceType = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊", "专家门诊")
            };
            appointment.AppointmentType = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-type", "4", "网上预约", "网上预约");
            appointment.Start = DateTime.Now;
            appointment.End = DateTime.Now;
            appointment.Slot = new List<ResourceReference>
            {
                new ResourceReference("Slot/SlotID", "时段描述")
            };
            appointment.Created = "2021-01-20T09:27:30";
            appointment.PatientInstruction = "注意事项";
            appointment.Participant = new List<Appointment.ParticipantComponent>
            {
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Patient/PatientID", "患者描述"),
                    Status = ParticipationStatus.Accepted
                },
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Practitioner/PractitionerID", "医生描述"),
                    Status = ParticipationStatus.Accepted
                },
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Location/LocationID", "诊室描述"),
                    Status = ParticipationStatus.Accepted
                }
            };
            appointment.SupportingInformation = new List<ResourceReference>
            {
                new ResourceReference("ChargeItem/ChargeItemID", "缴费项描述")
            };

            return appointment;
        }

        private void DisassembleAppointment(Appointment appointment)
        {
            Console.WriteLine(appointment.Id);
            foreach (var profile in appointment.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in appointment.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            foreach (var extension in appointment.StatusElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            foreach (var serviceType in appointment.ServiceType)
            {
                foreach (var coding in serviceType.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            foreach (var coding in appointment.AppointmentType.Coding)
            {
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(appointment.Start);
            Console.WriteLine(appointment.End);
            foreach (var slot in appointment.Slot)
            {
                Console.WriteLine(slot.Reference);
                Console.WriteLine(slot.Display);
            }
            Console.WriteLine(appointment.Created);
            Console.WriteLine(appointment.PatientInstruction);
            foreach (var participant in appointment.Participant)
            {
                Console.WriteLine(participant.Actor.Reference);
                Console.WriteLine(participant.Actor.Display);
                Console.WriteLine(participant.Status);
            }
            foreach (var supportingInformation in appointment.SupportingInformation)
            {
                Console.WriteLine(supportingInformation.Reference);
                Console.WriteLine(supportingInformation.Display);
            }
        }
    }
}
```

## 查询挂号详情接口

### 接口功能

> 根据挂号单号查询挂号详情

### 参考地址(URL)

> http://ip:port/api/appointment/query-appointment

### HTTP请求方式(Method)

> GET

### 数据格式

> JSON（必须支持）
>
> XML（可选支持）

### 请求数据

#### 请求头(Request Header)

> 无

#### 查询参数(Query)

|      名称       | 是否必填 |     说明     |
| :-------------: | :------: | :----------: |
| organization-id |    是    |   机构编码   |
| patient-idcard  |    是    | 患者身份证号 |
| appointment-id  |    是    |   挂号单号   |

#### 参考结构

> 无

#### 示例代码

> 无

### 响应数据

#### 响应头(Response Header)

> 无

#### 参考结构

```xml
<?xml version="1.0" encoding="utf-8" ?>
<Bundle xmlns="http://hl7.org/fhir">
    <id value="唯一标识，如uuid"/>
    <meta>
		<tag>
			<extension url="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-url">
				<valueString value="支付页面url"></valueString>
			</extension>
            <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-timeout">
                <valueDateTime value="2021-03-08T11:30:57+08:00"></valueDateTime>
            </extension>
			<system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/invoke-type"></system>
			<code value="APP"></code>
			<display value="应用程序"></display>
		</tag>
	</meta>
    <type value="searchset"/>
    <!-- 0..* ******************************挂号单****************************** -->
    <entry>
        <resource>
            <Appointment xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"/>
                </meta>
                <!-- 0..* 预约挂号号源编号 -->
                <identifier>
                    <!-- 0..1 预约挂号号源编号NamingSystem uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier"/>
                    <!-- 0..1 预约挂号号源编号 -->
                    <value value="A0000001"/>
                </identifier>
                <!-- 1..1 预约状态 -->
                <status >
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status">
                        <valueCoding>
                            <!-- 0..1 预约状态 CodeSystem url -->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status"/>
                            <!-- 0..1 预约状态代码 -->
                            <code value="02"/>
                            <!-- 0..1 预约状态说明 -->
                            <display value="已预约"/>
                        </valueCoding>
                    </extension>
                </status>
                <!-- 0..1 服务类型 -->
                <serviceType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc"/>
                        <code value="102"/>
                        <display value="专家门诊"/>
                    </coding>
                </serviceType>
                <!-- 0..1 预约类型 -->
                <appointmentType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code"/>
                        <code value="4"/>
                        <display value="网上预约"/>
                    </coding>
                    <text value="网上预约"/>
                </appointmentType>
                <!-- 0..1 开始时间 -->
                <start value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 结束时间 -->
                <end value="2020-11-10T14:00:00Z"/>
                <!-- 0..* 预约时段 Reference(Slot) -->
                <slot>
                    <reference value="Slot/SlotID"/>
                    <display value="时段描述"/>
                </slot>
                <!-- 0..1 创建挂号单时间 -->
                <created value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 注意事项 -->
                <patientInstruction value="[string]"/>
                <!-- 1..* 参与者 -->
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Patient/PatientID"/>
                        <display value="患者描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Practitioner/PractitionerID"/>
                        <display value="医生描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Location/LocationID"/>
                        <display value="诊室描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <!-- 0..* 费用信息 Reference(Any) -->
                <supportingInformation>
                    <reference value="ChargeItem/ChargeItemID"/>
                    <display value="缴费项描述"/>
                </supportingInformation>
            </Appointment>
        </resource>
    </entry>
    <!-- 0..* ******************************缴费账目****************************** -->
    <entry>
        <resource>
            <ChargeItem xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/ChargeItem"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 订单项编号 NamingSystem uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/91510107MA64H4GC5D-charge-item-identifier"/>
                    <!-- 0..1 订单项编号 -->
                    <value value="A00101"/>
                </identifier>
                <!-- 1..1 状态 -->
                <status >
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status">
                        <valueCoding>
                            <!-- 0..1 费用状态 CodeSystem url  地址(planned | billable | not-billable | aborted | billed | entered-in-error | unknown)-->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/chargeitem-status"/>
                            <!-- 0..1 费用状态代码 -->
                            <code value="01"/>
                            <!-- 0..1 费用状态说明 -->
                            <display value="支付成功"/>
                        </valueCoding>
                    </extension>
                </status>
                <!-- 1..1 标识费用的代码 -->
                <code>
                    <coding>
                        <!-- 0..1 收费代码 -->
                        <code value=""/>
                        <!-- 0..1 收费代码说明 -->
                        <display value=""/>
                    </coding>
                </code>
                <!-- 0..1 价格 -->
                <priceOverride>
                    <value value="50"/>
                    <currency value="CNY"/>
                </priceOverride>
                <!-- 0..1 个数 -->
                <quantity>
                    <value value="1"/>
                </quantity>
                <!-- 0..1 备注 -->
                <note>
                    <text value="备注"/>
                </note>
            </ChargeItem>
        </resource>
    </entry>
    <!-- 0..* ******************************时段****************************** -->
    <entry>
        <resource>
            <Slot xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-slot"/>
                </meta>
                <!-- 0..1 服务类型 -->
                <serviceType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc"/>
                        <code value="102"/>
                        <display value="专家门诊"/>
                    </coding>
                </serviceType>
                <!-- 0..1 预约类型 -->
                <appointmentType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code"/>
                        <code value="4"/>
                        <display value="网上预约"/>
                    </coding>
                </appointmentType>
                <!-- 0..1 FHIR扩展，号源数 -->
                <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/source-number">
                    <valueRatio>
                        <!-- 0..1 已经挂号数字 -->
                        <numerator>
                            <value value="9"/>
                            <unit value="个"/>
                        </numerator>
                        <!-- 0..1 总号源数字 -->
                        <denominator>
                            <value value="10"/>
                            <unit value="个"/>
                        </denominator>
                    </valueRatio>
                </extension>
                <!-- 1..1 排班信息 Reference(Schedule) -->
                <schedule>
                    <reference value="Schedule/ScheduleID"/>
                    <display vlaue="排班描述"/>
                </schedule>
                <!-- 1..1 状态 busy | free | busy-unavailable | busy-tentative | entered-in-error  -->
                <status value="busy"/>
                <!-- 1..1 开始时段 -->
                <start value="2020-11-10T13:00:00Z"/>
                <!-- 1..1 结束时段 -->
                <end value="2020-11-10T14:00:00Z"/>
            </Slot>
        </resource>
    </entry>
    <!-- 0..* ******************************排班****************************** -->
    <entry>
        <resource>
            <Schedule xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-schedule"/>
                </meta>
                <!-- 0..1 服务类型 -->
                <serviceType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc"/>
                        <code value="102"/>
                        <display value="专家门诊"/>
                    </coding>
                </serviceType>
                <!-- 0..1 班次时段 -->
                <planningHorizon>
                    <start value="2020-11-10T13:00:00Z"/>
                    <end value="2020-11-10T14:00:00Z"/>
                </planningHorizon>
                <!-- 1..* 参与者 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                <actor>
                    <reference value="Practitioner/PractitionerID"/>
                    <display value="医生描述"/>
                </actor>
                <actor>
                    <reference value="Location/LocationID"/>
                    <display value="诊室描述"/>
                </actor>
                <!-- 0..1 排班备注 -->
                <comment value=""/>
            </Schedule>
        </resource>
    </entry>
    <!-- 0..* ******************************医生****************************** -->
    <entry>
        <resource>
            <Practitioner xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid，身份证号"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Practitioner"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 适用范围 usual | official | temp | secondary | old -->
                    <use value="usual"/>
                    <!-- 0..1 类型 -->
                    <type>
                        <coding>
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type"/>
                            <code value="01"/>
                            <display value="身份证"/>
                        </coding>
                        <text value="身份证"/>
                    </type>
                    <!-- 0..1 证件号码管理系统uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/practitioner-identifier"/>
                    <!-- 0..1 身份证件号码 -->
                    <value value="000000000000000000"/>
                </identifier>
                <!-- 0..1 是否在用 -->
                <active value="true"/>
                <!-- 0..* 姓名 -->
                <name>
                    <text value="王医生"/>
                </name>
                <!-- 0..* 联系方式 -->
                <telecom>
                    <system value="phone"/>
                    <value value="13387362766"/>
                </telecom>
                <!-- 0..1 性别 -->
                <gender>
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human">
                        <valueCoding>
                            <!-- 0..1 生理性别 CodeSystem url 地址 -->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender"/>
                            <!-- 0..1 生理性别代码 -->
                            <code value="1"/>
                            <!-- 0..1 生理性别说明 -->
                            <display value="男性"/>
                        </valueCoding>
                    </extension>
                </gender>
                <!-- 0..1 出生日期 -->
                <birthDate value="1980-02-01"/>
                <!-- 0..* 地址 -->
                <address>
                    <!-- 0..1 类型 home | work | temp | old | billing -->
                    <use value="home"/>
                    <!-- 0..1 地址的完整描述 -->
                    <text value="[string]"/>
                </address>
                <!-- 0..* 照片 -->
                <photo>
                    <contentType value="[MimeType]"/>
                    <url value="[url]"/>
                </photo>
            </Practitioner>
        </resource>
    </entry>
    <!-- 0..1 ******************************患者信息****************************** -->
    <entry>
        <resource>
            <Patient xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid，身份证号"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Patient"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 适用范围 usual | official | temp | secondary | old -->
                    <use value="usual"/>
                    <!-- 0..1 类型 -->
                    <type>
                        <coding>
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type"/>
                            <code value="01"/>
                            <display value="身份证"/>
                        </coding>
                        <text value="身份证"/>
                    </type>
                    <!-- 0..1 证件号码管理系统uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/patient-identifier"/>
                    <!-- 0..1 身份证件号码 -->
                    <value value="511002938706190932"/>
                </identifier>
                <!-- 0..1 该患者记录是否在使用 -->
                <active value="true"/>
                <!-- 0..* 患者姓名 -->
                <name>
                    <text value="张三"/>
                </name>
                <!-- 0..* 联系方式 -->
                <telecom>
                    <system value="phone"/>
                    <value value="13387362763"/>
                </telecom>
                <!-- 0..1 性别 -->
                <gender>
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human">
                        <valueCoding>
                            <!-- 0..1 生理性别 CodeSystem url 地址 -->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender"/>
                            <!-- 0..1 生理性别代码 -->
                            <code value="1"/>
                            <!-- 0..1 生理性别说明 -->
                            <display value="男性"/>
                        </valueCoding>
                    </extension>
                </gender>
                <!-- 0..1 出生日期 -->
                <birthDate value="1980-02-01"/>
                <!-- 0..1 是否死亡 -->
                <deceasedBoolean value="false"/>
                <!-- 0..* 地址 -->
                <address>
                    <!-- 0..1 类型 home | work | temp | old | billing -->
                    <use value="home"/>
                    <!-- 0..1 地址的完整描述 -->
                    <text value="XX街xx路"/>
                </address>
                <!-- 0..* 照片 -->
                <photo>
                    <contentType value="[MimeType]"/>
                    <url value="[url]"/>
                </photo>
                <!-- 0..* 联系人 -->
                <contact>
                    <!-- 0..* 关系 -->
                    <relationship>
                        <coding>
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/family-relationship" />
                            <code value="5" />
                            <display value="父母"/>
                        </coding>
                        <text value="父母"/>
                    </relationship>
                    <!-- 0..1 联系人姓名 -->
                    <name>
                        <text value="李四" />
                    </name>
                    <!-- 0..* 联系方式 -->
                    <telecom>
                        <system value="phone"/>
                        <value value="13312345678"/>
                    </telecom>
                </contact>
            </Patient>
        </resource>
    </entry>
    <!-- 0..* ******************************预约诊室信息****************************** -->
    <entry>
        <resource>
            <Location xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-consultation-room"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 诊室号NamingSystem uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-A001-consulting-room-identifier" />
                    <!-- 0..1 诊室号 -->
                    <value value="X00001" />
                </identifier>
                <!-- 0..1 状态 active | suspended | inactive -->
                <status value="active"/>
                <!-- 0..1 诊室名称 -->
                <name value="第一诊室" />
                <!-- 0..* 别名 -->
                <alias value="全科诊室" />
                <!-- 0..1 关于诊室的其他详细信息，可以作为进一步的信息显示 -->
                <description value="" />
                <!-- 0..1 对应科室 Reference(Organization) -->
                <managingOrganization>
                    <reference value="Organization/OrganizationID" />
                    <display value="科室描述"/>
                </managingOrganization>
            </Location>
        </resource>
    </entry>
    <!-- 0..* ******************************预约科室信息****************************** -->
    <entry>
        <resource>
            <Organization xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Department"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 科室编号 NamingSystem uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-department-identifier"/>
                    <!-- 0..1 科室编号 -->
                    <value value="A001"/>
                </identifier>
                <!-- 0..1 是否可用 -->
                <active value="true"/>
                <!-- 0..1 组织机构层级种类（固定为科室） -->
                <type>
                    <coding>
                        <!-- 组织机构层级种类 CodeSystem地址 -->
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind"/>
                        <!-- 0..1 组织机构层级种类代码 -->
                        <code value="4"/>
                        <!-- 0..1 组织机构层级种类 -->
                        <display value="科室"/>
                    </coding>
                </type>
                <!-- 0..1 科室名称 -->
                <name value="普通外科"/>
                <!-- 0..* 病区别名 -->
                <alias value="外1科"/>
                <!-- 0..* 联系方式 -->
                <telecom>
                    <!-- 0..1 类型 phone | fax | email | pager | url | sms | other -->
                    <system value="phone"/>
                    <!-- 0..1 电话号码 -->
                    <value value="13309876352"/>
                </telecom>
                <!-- 0..1 电子邮箱 -->
                <telecom>
                    <!-- 0..1 类型 phone | fax | email | pager | url | sms | other -->
                    <system value="email"/>
                    <!-- 0..1 电子邮箱 -->
                    <value value=""/>
                </telecom>
                <!-- 0..* 地址 -->
                <address>
                    <!-- 0..1 地址的完整描述 -->
                    <text value=""/>
                </address>
                <!-- 0..1 科室所属医院 Reference(Organization) -->
                <partOf>
                    <reference value="Organization/OrganizationID"/>
                    <display value="医院描述"/>
                </partOf>
                <!-- 科室简介 -->
                <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction">
                    <!-- 科室简介 -->
                    <valueString value="XXXXXXXX科室针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。"/>
                </extension>
            </Organization>
        </resource>
    </entry>
    <!-- 0..* ******************************预约医院信息****************************** -->
    <entry>
        <resource>
            <Organization xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid，组织机构统一社会信用代码"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Hospital"/>
                </meta>
                <!-- 0..* 标识符 -->
                <identifier>
                    <!-- 0..1 医院编号 NamingSystem uri -->
                    <system value="https://www.cods.org.cn"/>
                    <!-- 0..1 医院编号 -->
                    <value value="12510125450833106C"/>
                </identifier>
                <!-- 0..1 是否可用 -->
                <active value="true"/>
                <!-- 0..1 组织机构层级种类（固定为医院） -->
                <type>
                    <coding>
                        <!-- 组织机构层级种类 CodeSystem地址 -->
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind"/>
                        <!-- 0..1 组织机构层级种类代码 -->
                        <code value="2"/>
                        <!-- 0..1 组织机构层级种类 -->
                        <display value="医院"/>
                    </coding>
                </type>
                <!-- 0..1 卫生机构(组织)类别 WS 218-2002 -->
                <type>
                    <coding>
                        <!-- 组织机构层级种类 CodeSystem地址 -->
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/health-institution-or-organization-category"/>
                        <!-- 0..1 组织机构层级种类代码 -->
                        <code value="A100"/>
                        <!-- 0..1 组织机构层级种类 -->
                        <display value="综合医院"/>
                    </coding>
                </type>
                <!-- 0..1 地址 -->
                <address>
                    <!-- 0..1 地址的完整描述 -->
                    <text value="四川省成都市高新区XXXXXX路18号"/>
                </address>
                <!-- 0..1 医院名称 -->
                <name value="成都市XXXXX人民医院"/>
                <!-- 0..* 医院别名 -->
                <alias value="成都XX医院"/>
                <!-- 0..* 联系方式 -->
                <telecom>
                    <!-- 0..1 类型 phone | fax | email | pager | url | sms | other -->
                    <system value="phone"/>
                    <!-- 0..1 电话号码 -->
                    <value value="13309876352"/>
                </telecom>
                <!-- 0..1 电子邮箱 -->
                <telecom>
                    <!-- 0..1 类型 phone | fax | email | pager | url | sms | other -->
                    <system value="email"/>
                    <!-- 0..1 电子邮箱 -->
                    <value value=""/>
                </telecom>
                <!-- 0..1 官方网页 -->
                <telecom>
                    <!-- 0..1 类型 phone | fax | email | pager | url | sms | other -->
                    <system value="url"/>
                    <!-- 0..1 官方网页 -->
                    <value value="http://www.cdzxy.com/"/>
                </telecom>
                <!-- 医院简介 -->
                <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction">
                    <!-- 医院简介 -->
                    <valueString value="XXXXXXXX医院血液科针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。"/>
                </extension>
            </Organization>
        </resource>
    </entry>
</Bundle>
```

#### 示例代码

**JAVA**

```java
package fhir.预约挂号;

import java.util.Date;

import org.apache.commons.lang3.StringUtils;
import org.hl7.fhir.r4.model.Address;
import org.hl7.fhir.r4.model.Address.AddressUse;
import org.hl7.fhir.r4.model.Annotation;
import org.hl7.fhir.r4.model.Appointment;
import org.hl7.fhir.r4.model.Appointment.AppointmentParticipantComponent;
import org.hl7.fhir.r4.model.Appointment.AppointmentStatus;
import org.hl7.fhir.r4.model.Appointment.AppointmentStatusEnumFactory;
import org.hl7.fhir.r4.model.Appointment.ParticipationStatus;
import org.hl7.fhir.r4.model.Attachment;
import org.hl7.fhir.r4.model.BooleanType;
import org.hl7.fhir.r4.model.Bundle;
import org.hl7.fhir.r4.model.Bundle.BundleEntryComponent;
import org.hl7.fhir.r4.model.Bundle.BundleType;
import org.hl7.fhir.r4.model.CanonicalType;
import org.hl7.fhir.r4.model.ChargeItem;
import org.hl7.fhir.r4.model.ChargeItem.ChargeItemStatus;
import org.hl7.fhir.r4.model.ChargeItem.ChargeItemStatusEnumFactory;
import org.hl7.fhir.r4.model.CodeableConcept;
import org.hl7.fhir.r4.model.Coding;
import org.hl7.fhir.r4.model.ContactPoint;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointSystem;
import org.hl7.fhir.r4.model.ContactPoint.ContactPointUse;
import org.hl7.fhir.r4.model.DateTimeType;
import org.hl7.fhir.r4.model.DomainResource;
import org.hl7.fhir.r4.model.Enumeration;
import org.hl7.fhir.r4.model.Enumerations;
import org.hl7.fhir.r4.model.Enumerations.AdministrativeGender;
import org.hl7.fhir.r4.model.Enumerations.AdministrativeGenderEnumFactory;
import org.hl7.fhir.r4.model.Extension;
import org.hl7.fhir.r4.model.HumanName;
import org.hl7.fhir.r4.model.Identifier;
import org.hl7.fhir.r4.model.Identifier.IdentifierUse;
import org.hl7.fhir.r4.model.Location;
import org.hl7.fhir.r4.model.Location.LocationStatus;
import org.hl7.fhir.r4.model.Meta;
import org.hl7.fhir.r4.model.Money;
import org.hl7.fhir.r4.model.Organization;
import org.hl7.fhir.r4.model.Patient;
import org.hl7.fhir.r4.model.Patient.ContactComponent;
import org.hl7.fhir.r4.model.Period;
import org.hl7.fhir.r4.model.Practitioner;
import org.hl7.fhir.r4.model.Quantity;
import org.hl7.fhir.r4.model.Ratio;
import org.hl7.fhir.r4.model.Reference;
import org.hl7.fhir.r4.model.Resource;
import org.hl7.fhir.r4.model.Schedule;
import org.hl7.fhir.r4.model.Slot;
import org.hl7.fhir.r4.model.StringType;

import ca.uhn.fhir.context.FhirContext;

public class 查询挂号信息接口 {
    public void serialize() {
        Bundle bundle = new Bundle();
        bundle.setId("唯一标识，如uuid");
        Coding coding = new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/invoke-type", "APP", "应用程序");
        coding.addExtension(new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-url", new StringType("支付页面url")));
        coding.addExtension(new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-timeout", new DateTimeType(new Date())));
        bundle.setMeta(new Meta().addTag(coding));
        bundle.setType(BundleType.SEARCHSET);
        bundle.addEntry(new BundleEntryComponent().setResource(assembleAppointment()));
        bundle.addEntry(new BundleEntryComponent().setResource(assembleChargeItem()));
        bundle.addEntry(new BundleEntryComponent().setResource(assembleSlot()));
        bundle.addEntry(new BundleEntryComponent().setResource(assembleSchedule()));
        bundle.addEntry(new BundleEntryComponent().setResource(assemblePractitioner()));
        bundle.addEntry(new BundleEntryComponent().setResource(assemblePatient()));
        bundle.addEntry(new BundleEntryComponent().setResource(assembleLocation()));
        bundle.addEntry(new BundleEntryComponent().setResource(assembleDepartment()));
        bundle.addEntry(new BundleEntryComponent().setResource(assembleHospital()));
        System.out.println(FhirContext.forR4().newJsonParser().encodeResourceToString(bundle));
    }

    public void deserialize() {
        String fhirJson = "序列化生成的json格式字符串";

        Bundle bundle = FhirContext.forR4().newJsonParser().parseResource(Bundle.class, fhirJson);
        System.out.println(bundle.getId());
        for (Coding coding : bundle.getMeta().getTag()) {
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
            for (Extension extension : coding.getExtension()) {
                System.out.println(extension.getUrl());
                if (StringUtils.equals(extension.getUrl(), "https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-url")) {
                    StringType stringType = (StringType) extension.getValue();
                    System.out.println(stringType.getValue());
                } else if (StringUtils.equals(extension.getUrl(), "https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-timeout")) {
                    DateTimeType dateTimeType = (DateTimeType) extension.getValue();
                    System.out.println(dateTimeType.getValue());
                }
            }
        }
        System.out.println(bundle.getType());

        for (BundleEntryComponent bundleEntryComponent : bundle.getEntry()) {
            Resource domainResource = bundleEntryComponent.getResource();
            if (domainResource instanceof Appointment) {
                Appointment appointment = (Appointment) domainResource;
                disassembleAppointment(appointment);
            } else if (domainResource instanceof ChargeItem) {
                ChargeItem chargeItem = (ChargeItem) domainResource;
                disassembleChargeItem(chargeItem);
            } else if (domainResource instanceof Slot) {
                Slot slot = (Slot) domainResource;
                disassembleSlot(slot);
            } else if (domainResource instanceof Schedule) {
                Schedule schedule = (Schedule) domainResource;
                disassembleSchedule(schedule);
            } else if (domainResource instanceof Practitioner) {
                Practitioner practitioner = (Practitioner) domainResource;
                disassemblePractitioner(practitioner);
            } else if (domainResource instanceof Patient) {
                Patient patient = (Patient) domainResource;
                disassemblePatient(patient);
            } else if (domainResource instanceof Location) {
                Location location = (Location) domainResource;
                disassembleLocation(location);
            } else if (domainResource instanceof Organization) {
                String profile = domainResource.getMeta().getProfile().get(0).getValue();
                if (StringUtils.equals(profile, "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Department")) {
                    Organization department = (Organization) domainResource;
                    disassembleDepartment(department);
                } else if (StringUtils.equals(profile, "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Hospital")) {
                    Organization hospital = (Organization) domainResource;
                    disassembleHospital(hospital);
                }
            }
        }
    }

    private DomainResource assembleAppointment() {
        Appointment appointment = new Appointment();
        appointment.setId("唯一标识，如uuid");
        appointment.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"));
        appointment.addIdentifier(new Identifier()
            .setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier").setValue("A0000001"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status", "01", "已申请"));
        Enumeration<AppointmentStatus> enumeration = new Enumeration<AppointmentStatus>(new AppointmentStatusEnumFactory());
        enumeration.addExtension(extension);
        appointment.setStatusElement(enumeration);
        appointment.addServiceType(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊")));
        appointment.setAppointmentType(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code", "4", "网上预约")).setText("网上预约"));
        appointment.setStart(new Date());
        appointment.setEnd(new Date());
        appointment.addSlot(new Reference("Slot/SlotID").setDisplay("时段描述"));
        appointment.setCreated(new Date());
        appointment.setPatientInstruction("注意事项");
        AppointmentParticipantComponent patientComponent = new AppointmentParticipantComponent();
        patientComponent.setActor(new Reference("Patient/PatientID").setDisplay("患者描述"));
        patientComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(patientComponent);
        AppointmentParticipantComponent practitionerComponent = new AppointmentParticipantComponent();
        practitionerComponent.setActor(new Reference("Practitioner/PractitionerID").setDisplay("医生描述"));
        practitionerComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(practitionerComponent);
        AppointmentParticipantComponent locationComponent = new AppointmentParticipantComponent();
        locationComponent.setActor(new Reference("Location/LocationID").setDisplay("诊室描述"));
        locationComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(locationComponent);
        appointment.addSupportingInformation(new Reference("ChargeItem/ChargeItemID").setDisplay("缴费项描述"));
        return appointment;
    }

    private DomainResource assembleChargeItem() {
        ChargeItem chargeItem = new ChargeItem();
        chargeItem.setId("唯一标识，如uuid");
        chargeItem.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/ChargeItem"));
        chargeItem.addIdentifier(
            new Identifier().setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/91510107MA64H4GC5D-charge-item-identifier").setValue("A00101"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/chargeitem-status", "01", "支付成功"));
        Enumeration<ChargeItemStatus> enumeration = new Enumeration<ChargeItemStatus>(new ChargeItemStatusEnumFactory());
        enumeration.addExtension(extension);
        chargeItem.setStatusElement(enumeration);
        chargeItem.setCode(new CodeableConcept()
            .addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Medical-Insurance-Payment-Dictionary", "收费代码", "收费代码说明")));
        chargeItem.setPriceOverride(new Money().setValue(50).setCurrency("CNY"));
        chargeItem.setQuantity(new Quantity(1));
        chargeItem.addNote(new Annotation().setText("备注"));
        return chargeItem;
    }

    private DomainResource assembleSlot() {
        Slot slot = new Slot();
        slot.setId("唯一标识，如uuid");
        slot.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-slot"));
        slot.addServiceType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊")));
        slot.setAppointmentType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code", "4", "网上预约")));
        Ratio ratio = new Ratio();
        ratio.setNumerator(new Quantity().setValue(10).setUnit("个"));
        ratio.setDenominator(new Quantity().setValue(50).setUnit("个"));
        slot.addExtension(new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/source-number").setValue(ratio));
        slot.setSchedule(new Reference("Schedule/ScheduleID").setDisplay("排班描述"));
        slot.setStatus(Slot.SlotStatus.BUSY);
        slot.setStart(new Date());
        slot.setEnd(new Date());
        return slot;
    }

    private DomainResource assembleSchedule() {
        Schedule schedule = new Schedule();
        schedule.setId("唯一标识，如uuid");
        schedule.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-schedule"));
        schedule.addServiceType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊")));
        schedule.setPlanningHorizon(new Period().setStart(new Date()).setEnd(new Date()));
        schedule.addActor(new Reference("Practitioner/PractitionerID").setDisplay("医生描述"));
        schedule.addActor(new Reference("Location/LocationID").setDisplay("诊室描述"));
        schedule.setComment("排班备注");
        return schedule;
    }

    private DomainResource assemblePractitioner() {
        Practitioner practitioner = new Practitioner();
        practitioner.setId("唯一标识，如uuid，身份证号");
        practitioner.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Practitioner"));
        practitioner.addIdentifier(new Identifier().setUse(IdentifierUse.USUAL)
            .setType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type", "01", "身份证")))
            .setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/practitioner-identifier").setValue("510102198804091172"));
        practitioner.setActive(true);
        practitioner.addName(new HumanName().setText("王医生"));
        practitioner.addTelecom(new ContactPoint().setSystem(ContactPointSystem.PHONE).setUse(ContactPointUse.MOBILE).setValue("13387362766"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender", "1", "男性"));
        Enumeration<AdministrativeGender> enumeration = new Enumeration<AdministrativeGender>(new Enumerations.AdministrativeGenderEnumFactory());
        enumeration.addExtension(extension);
        practitioner.setGenderElement(enumeration);
        practitioner.setBirthDate(new Date());
        practitioner.addAddress(new Address().setText("成都市XXX区XXX小区XXXX号").setUse(AddressUse.HOME));
        practitioner.addPhoto(new Attachment().setContentType("image/jpeg").setUrl("photo url"));
        return practitioner;
    }

    private DomainResource assemblePatient() {
        Patient patient = new Patient();
        patient.setId("唯一标识，如uuid，身份证号");
        patient.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Patient"));
        patient.addIdentifier(new Identifier().setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/patient-identifier").setValue("511002938706190932")
            .setUse(IdentifierUse.USUAL)
            .setType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type", "01", "身份证")).setText("居民身份证")));
        patient.setActive(true);
        patient.addName(new HumanName().setText("张三"));
        patient.addTelecom(new ContactPoint().setSystem(ContactPointSystem.PHONE).setUse(ContactPointUse.MOBILE).setValue("13387362763"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender", "1", "男性"));
        Enumeration<AdministrativeGender> enumeration = new Enumeration<AdministrativeGender>(new AdministrativeGenderEnumFactory());
        enumeration.addExtension(extension);
        patient.setGenderElement(enumeration);
        patient.setBirthDate(new Date());
        patient.setDeceased(new BooleanType(false));
        patient.addAddress(new Address().setUse(AddressUse.HOME).setText("XX街xx路"));
        patient.addPhoto().setContentType("image/jpeg").setUrl("photo url");
        ContactComponent contact = new ContactComponent();
        contact.addRelationship(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/family-relationship", "1", "配偶")).setText("配偶"));
        contact.setName(new HumanName().setText("李四"));
        contact.addTelecom().setSystem(ContactPointSystem.PHONE).setUse(ContactPointUse.MOBILE).setValue("13312345678");
        patient.addContact(contact);
        return patient;
    }

    private DomainResource assembleLocation() {
        Location location = new Location();
        location.setId("唯一标识，如uuid");
        location.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-consultation-room"));
        location.addIdentifier(new Identifier().setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-A001-consulting-room-identifier")
            .setValue("X00001"));
        location.setStatus(LocationStatus.ACTIVE);
        location.setName("第一诊室");
        location.addAlias("全科诊室");
        location.setDescription("诊室详情");
        location.setManagingOrganization(new Reference("Department/DepartmentID").setDisplay("科室描述"));
        return location;
    }

    private DomainResource assembleDepartment() {
        Organization department = new Organization();
        department.setId("唯一标识，如uuid");
        department.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Department"));
        department.addIdentifier(
            new Identifier().setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-department-identifier").setValue("A001"));
        department.setActive(true);
        department.addType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind", "4", "科室")));
        department.setName("普通外科");
        department.addAlias("外1科");
        department.addTelecom(new ContactPoint().setSystem(ContactPointSystem.PHONE).setUse(ContactPointUse.MOBILE).setValue("13309876352"));
        department.addTelecom(new ContactPoint().setSystem(ContactPointSystem.EMAIL).setUse(ContactPointUse.WORK).setValue("xx@xx.com"));
        department.addAddress(new Address().setText("xxxx地址"));
        department.setPartOf(new Reference("Organization/OrganizationID").setDisplay("科室所属医院描述"));
        department.addExtension(new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction")
            .setValue(new StringType("XXXXXXXX科室针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。")));
        return department;
    }

    private DomainResource assembleHospital() {
        Organization hospital = new Organization();
        hospital.setId("唯一标识，如uuid，组织机构统一社会信用代码");
        hospital.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Hospital"));
        hospital.addIdentifier(new Identifier().setSystem("https://www.cods.org.cn").setValue("12510125450833106C"));
        hospital.setActive(true);
        hospital.addType(new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind", "2", "医院")));
        hospital.addType(
            new CodeableConcept(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/health-institution-or-organization-category", "A100", "综合医院")));
        hospital.setName("xx医院");
        hospital.addAlias("xxxx医院");
        hospital.addTelecom(new ContactPoint().setSystem(ContactPointSystem.PHONE).setUse(ContactPointUse.MOBILE).setValue("13309876352"));
        hospital.addTelecom(new ContactPoint().setSystem(ContactPointSystem.EMAIL).setUse(ContactPointUse.WORK).setValue("xx@xx.com"));
        hospital.addTelecom(new ContactPoint().setSystem(ContactPointSystem.URL).setUse(ContactPointUse.WORK).setValue("http://www.cdzxy.com/"));
        hospital.addAddress(new Address().setText("xxxx地址"));
        hospital.addExtension(new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction")
            .setValue(new StringType("XXXXXXXX医院血液科针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。")));
        return hospital;
    }

    private void disassembleAppointment(Appointment appointment) {
        System.out.println(appointment.getId());
        for (CanonicalType profile : appointment.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : appointment.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        for (Extension extension : appointment.getStatusElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        for (CodeableConcept serviceType : appointment.getServiceType()) {
            for (Coding coding : serviceType.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        for (Coding coding : appointment.getAppointmentType().getCoding()) {
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(appointment.getStart());
        System.out.println(appointment.getEnd());
        for (Reference slot : appointment.getSlot()) {
            System.out.println(slot.getReference());
            System.out.println(slot.getDisplay());
        }
        System.out.println(appointment.getCreated());
        System.out.println(appointment.getPatientInstruction());
        for (AppointmentParticipantComponent appointmentParticipantComponent : appointment.getParticipant()) {
            System.out.println(appointmentParticipantComponent.getActor().getReference());
            System.out.println(appointmentParticipantComponent.getActor().getDisplay());
            System.out.println(appointmentParticipantComponent.getStatus());
        }
        for (Reference supportingInformation : appointment.getSupportingInformation()) {
            System.out.println(supportingInformation.getReference());
            System.out.println(supportingInformation.getDisplay());
        }
    }

    private void disassembleChargeItem(ChargeItem chargeItem) {
        System.out.println(chargeItem.getId());
        for (CanonicalType profile : chargeItem.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : chargeItem.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        for (Extension extension : chargeItem.getStatusElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        for (Coding coding : chargeItem.getCode().getCoding()) {
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(chargeItem.getPriceOverride().getValue());
        System.out.println(chargeItem.getPriceOverride().getCurrency());
        System.out.println(chargeItem.getQuantity().getValue());
        for (Annotation note : chargeItem.getNote()) {
            System.out.println(note.getText());
        }
    }

    private void disassembleSlot(Slot slot) {
        System.out.println(slot.getId());
        for (CanonicalType profile : slot.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (CodeableConcept serviceType : slot.getServiceType()) {
            for (Coding coding : serviceType.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        for (Coding coding : slot.getAppointmentType().getCoding()) {
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        for (Extension extension : slot.getExtension()) {
            System.out.println(extension.getUrl());
            Ratio ratio = (Ratio) extension.getValue();
            System.out.println(ratio.getNumerator().getValue());
            System.out.println(ratio.getNumerator().getUnit());
            System.out.println(ratio.getDenominator().getValue());
            System.out.println(ratio.getDenominator().getUnit());
        }
        System.out.println(slot.getSchedule().getReference());
        System.out.println(slot.getSchedule().getDisplay());
        System.out.println(slot.getStatus());
        System.out.println(slot.getStart());
        System.out.println(slot.getEnd());
    }

    private void disassembleSchedule(Schedule schedule) {
        System.out.println(schedule.getId());
        for (CanonicalType profile : schedule.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (CodeableConcept serviceType : schedule.getServiceType()) {
            for (Coding coding : serviceType.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        System.out.println(schedule.getPlanningHorizon().getStart());
        System.out.println(schedule.getPlanningHorizon().getEnd());
        for (Reference actor : schedule.getActor()) {
            System.out.println(actor.getReference());
            System.out.println(actor.getDisplay());
        }
        System.out.println(schedule.getComment());
    }

    private void disassemblePractitioner(Practitioner practitioner) {
        System.out.println(practitioner.getId());
        for (CanonicalType profile : practitioner.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : practitioner.getIdentifier()) {
            for (Coding coding : identifier.getType().getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
            System.out.println(identifier.getUse());
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        System.out.println(practitioner.getActive());
        for (HumanName humanName : practitioner.getName()) {
            System.out.println(humanName.getText());
        }
        for (ContactPoint telecom : practitioner.getTelecom()) {
            System.out.println(telecom.getSystem());
            System.out.println(telecom.getUse());
            System.out.println(telecom.getValue());
        }
        for (Extension extension : practitioner.getGenderElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(practitioner.getBirthDate());
        for (Address address : practitioner.getAddress()) {
            System.out.println(address.getText());
        }
        for (Attachment attachment : practitioner.getPhoto()) {
            System.out.println(attachment.getContentType());
            System.out.println(attachment.getUrl());
        }
    }

    private void disassemblePatient(Patient patient) {
        System.out.println(patient.getId());
        for (CanonicalType profile : patient.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : patient.getIdentifier()) {
            for (Coding coding : identifier.getType().getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
            System.out.println(identifier.getUse());
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        System.out.println(patient.getActive());
        for (HumanName humanName : patient.getName()) {
            System.out.println(humanName.getText());
        }
        for (ContactPoint telecom : patient.getTelecom()) {
            System.out.println(telecom.getSystem());
            System.out.println(telecom.getUse());
            System.out.println(telecom.getValue());
        }
        for (Extension extension : patient.getGenderElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(patient.getBirthDate());
        System.out.println(patient.getDeceasedBooleanType().booleanValue());
        for (Address address : patient.getAddress()) {
            System.out.println(address.getText());
        }
        for (Attachment attachment : patient.getPhoto()) {
            System.out.println(attachment.getContentType());
            System.out.println(attachment.getUrl());
        }
        for (ContactComponent contact : patient.getContact()) {
            for (CodeableConcept relationship : contact.getRelationship()) {
                for (Coding coding : relationship.getCoding()) {
                    System.out.println(coding.getSystem());
                    System.out.println(coding.getCode());
                    System.out.println(coding.getDisplay());
                }
            }
            System.out.println(contact.getName().getText());
            for (ContactPoint telecom : contact.getTelecom()) {
                System.out.println(telecom.getSystem());
                System.out.println(telecom.getUse());
                System.out.println(telecom.getValue());
            }
        }
    }

    private void disassembleLocation(Location location) {
        System.out.println(location.getId());
        for (CanonicalType profile : location.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : location.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        System.out.println(location.getStatus());
        System.out.println(location.getName());
        for (StringType alias : location.getAlias()) {
            System.out.println(alias);
        }
        System.out.println(location.getDescription());
        System.out.println(location.getManagingOrganization().getReference());
        System.out.println(location.getManagingOrganization().getDisplay());
    }

    private void disassembleDepartment(Organization department) {
        System.out.println(department.getId());
        for (CanonicalType profile : department.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : department.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        System.out.println(department.getActive());
        for (CodeableConcept type : department.getType()) {
            for (Coding coding : type.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        System.out.println(department.getName());
        for (StringType alias : department.getAlias()) {
            System.out.println(alias);
        }
        for (ContactPoint telecom : department.getTelecom()) {
            System.out.println(telecom.getSystem());
            System.out.println(telecom.getUse());
            System.out.println(telecom.getValue());
        }
        for (Address address : department.getAddress()) {
            System.out.println(address.getText());
        }
        System.out.println(department.getPartOf().getReference());
        System.out.println(department.getPartOf().getDisplay());
        for (Extension extension : department.getExtension()) {
            System.out.println(extension.getUrl());
            System.out.println(extension.getValue());
        }
    }

    private void disassembleHospital(Organization hospital) {
        System.out.println(hospital.getId());
        for (CanonicalType profile : hospital.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : hospital.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        System.out.println(hospital.getActive());
        for (CodeableConcept type : hospital.getType()) {
            for (Coding coding : type.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        System.out.println(hospital.getName());
        for (StringType alias : hospital.getAlias()) {
            System.out.println(alias);
        }
        for (ContactPoint telecom : hospital.getTelecom()) {
            System.out.println(telecom.getSystem());
            System.out.println(telecom.getUse());
            System.out.println(telecom.getValue());
        }
        for (Address address : hospital.getAddress()) {
            System.out.println(address.getText());
        }
        for (Extension extension : hospital.getExtension()) {
            System.out.println(extension.getUrl());
            System.out.println(extension.getValue());
        }
    }
}
```

**C#**

```c#
using System;
using System.Collections.Generic;
using System.Linq;
using Hl7.Fhir.Model;
using Hl7.Fhir.Serialization;

namespace fhir.预约挂号
{
    public class 查询挂号信息接口
    {
        public void Serialize()
        {
            Bundle bundle = new Bundle();
            bundle.Id = "唯一标识，如uuid";
            bundle.Meta = new Meta
            {
                Tag = new List<Coding>
                {
                    new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/invoke-type", "APP", "应用程序")
                    {
                        Extension = new List<Extension>
                        {
                            new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-url", new FhirString("支付页面url"))
                        }
                    }
                }
            };
            bundle.Type = Bundle.BundleType.Searchset;
            bundle.Entry = new List<Bundle.EntryComponent>
            {
                new Bundle.EntryComponent { Resource = AssembleAppointment() },
                new Bundle.EntryComponent { Resource = AssembleChargeItem() },
                new Bundle.EntryComponent { Resource = AssembleSlot() },
                new Bundle.EntryComponent { Resource = AssembleSchedule() },
                new Bundle.EntryComponent { Resource = AssemblePractitioner() },
                new Bundle.EntryComponent { Resource = AssemblePatient() },
                new Bundle.EntryComponent { Resource = AssembleLocation() },
                new Bundle.EntryComponent { Resource = AssembleDepartment() },
                new Bundle.EntryComponent { Resource = AssembleHospital() }
            };
            Console.WriteLine(new FhirJsonSerializer().SerializeToString(bundle));
        }

        public void Deserialize()
        {
            string fhirJson = "序列化生成的json格式字符串";

            Bundle bundle = new FhirJsonParser().Parse<Bundle>(fhirJson);
            Console.WriteLine(bundle.Id);
            foreach (var coding in bundle.Meta.Tag)
            {
                foreach (var extension in coding.Extension)
                {
                    Console.WriteLine(extension.Url);
                    if (extension.Url.Equals("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-url"))
                    {
                        FhirString fhirString = (FhirString)extension.Value;
                        Console.WriteLine(fhirString.Value);
                    }
                    else if (extension.Url.Equals("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-payment-timeout"))
                    {
                        FhirDateTime fhirDateTime = (FhirDateTime)extension.Value;
                        Console.WriteLine(fhirDateTime.Value);
                    }
                }
            }
            Console.WriteLine(bundle.Type);

            foreach (var entryComponent in bundle.Entry)
            {
                Resource domainResource = entryComponent.Resource;
                if (domainResource is Appointment)
                {
                    Appointment appointment = (Appointment)domainResource;
                    DisassembleAppointment(appointment);
                }
                else if (domainResource is ChargeItem)
                {
                    ChargeItem chargeItem = (ChargeItem)domainResource;
                    DisassembleChargeItem(chargeItem);
                }
                else if (domainResource is Slot)
                {
                    Slot slot = (Slot)domainResource;
                    DisassembleSlot(slot);
                }
                else if (domainResource is Schedule)
                {
                    Schedule schedule = (Schedule)domainResource;
                    DisassembleSchedule(schedule);
                }
                else if (domainResource is Practitioner)
                {
                    Practitioner practitioner = (Practitioner)domainResource;
                    DisassemblePractitioner(practitioner);
                }
                else if (domainResource is Patient)
                {
                    Patient patient = (Patient)domainResource;
                    DisassemblePatient(patient);
                }
                else if (domainResource is Location)
                {
                    Location location = (Location)domainResource;
                    DisassembleLocation(location);
                }
                else if (domainResource is Organization)
                {
                    if (domainResource.Meta.Profile.ElementAt(0).Equals("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Department"))
                    {
                        Organization department = (Organization)domainResource;
                        DisassembleDepartment(department);
                    }
                    else if (domainResource.Meta.Profile.ElementAt(0).Equals("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Hospital"))
                    {
                        Organization hospital = (Organization)domainResource;
                        DisassembleHospital(hospital);
                    }
                }
            }
        }

        private DomainResource AssembleAppointment()
        {
            Appointment appointment = new Appointment();
            appointment.Id = "唯一标识，如uuid";
            appointment.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"
                }
            };
            appointment.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier", "A0000001")
            };
            appointment.StatusElement = new Code<Appointment.AppointmentStatus>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status", "02", "已预约"))
                }
            };
            appointment.ServiceType = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊", "专家门诊")
            };
            appointment.AppointmentType = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-type", "4", "网上预约", "网上预约");
            appointment.Start = DateTime.Now;
            appointment.End = DateTime.Now;
            appointment.Slot = new List<ResourceReference>
            {
                new ResourceReference("Slot/SlotID", "时段描述")
            };
            appointment.Created = "2021-01-20T09:27:30";
            appointment.PatientInstruction = "注意事项";
            appointment.Participant = new List<Appointment.ParticipantComponent>
            {
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Patient/PatientID", "患者描述"),
                    Status = ParticipationStatus.Accepted
                },
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Practitioner/PractitionerID", "医生描述"),
                    Status = ParticipationStatus.Accepted
                },
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Location/LocationID", "诊室描述"),
                    Status = ParticipationStatus.Accepted
                }
            };
            appointment.SupportingInformation = new List<ResourceReference>
            {
                new ResourceReference("ChargeItem/ChargeItemID", "缴费项描述")
            };

            return appointment;
        }

        private DomainResource AssembleChargeItem()
        {
            ChargeItem chargeItem = new ChargeItem();
            chargeItem.Id = "唯一标识，如uuid";
            chargeItem.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/ChargeItem"
                }
            };
            chargeItem.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/91510107MA64H4GC5D-charge-item-identifier", "A00101")
            };
            chargeItem.StatusElement = new Code<ChargeItem.ChargeItemStatus>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/chargeitem-status", "01", "支付成功"))
                }
            };
            chargeItem.Code = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Medical-Insurance-Payment-Dictionary", "收费代码", "收费代码说明", "收费代码说明");
            chargeItem.PriceOverride = new Money
            {
                Value = 50,
                Currency = Money.Currencies.CNY
            };
            chargeItem.Quantity = new Quantity
            {
                Value = 1
            };
            chargeItem.Note = new List<Annotation>
            {
                new Annotation()
                {
                    Text= new Markdown("备注")
                }
            };

            return chargeItem;
        }

        private DomainResource AssembleSlot()
        {
            Slot slot = new Slot();
            slot.Id = "唯一标识，如uuid";
            slot.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-slot"
                }
            };
            slot.ServiceType = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊", "专家门诊")
            };
            slot.AppointmentType = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-type", "4", "网上预约", "网上预约");
            slot.Extension = new List<Extension>
            {
                new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/source-number", new Ratio()
                {
                    Numerator = new Quantity(9, "个"),
                    Denominator = new Quantity(10, "个")
                })
            };
            slot.Schedule = new ResourceReference("Schedule/ScheduleID", "排班描述");
            slot.Status = Slot.SlotStatus.Busy;
            slot.Start = DateTime.Now;
            slot.End = DateTime.Now;

            return slot;
        }

        private DomainResource AssembleSchedule()
        {
            Schedule schedule = new Schedule();
            schedule.Id = "唯一标识，如uuid";
            schedule.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-schedule"
                }
            };
            schedule.ServiceType = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊", "专家门诊")
            };
            schedule.PlanningHorizon = new Period(new FhirDateTime(DateTimeOffset.Now), new FhirDateTime(DateTimeOffset.Now));
            schedule.Actor = new List<ResourceReference>
            {
                new ResourceReference("Practitioner/PractitionerID", "医生描述"),
                new ResourceReference("Location/LocationID", "诊室描述")
            };
            schedule.Comment = "排班备注";

            return schedule;
        }

        private DomainResource AssemblePractitioner()
        {
            Practitioner practitioner = new Practitioner();
            practitioner.Id = "唯一标识，如uuid，身份证号";
            practitioner.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Practitioner"
                }
            };
            practitioner.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/practitioner-identifier", "510102198804091172")
                {
                    Use = Identifier.IdentifierUse.Usual,
                    Type = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type", "01", "身份证", "身份证")
                }
            };
            practitioner.Active = true;
            practitioner.Name = new List<HumanName>
            {
                new HumanName()
                {
                    Text = "王医生"
                }
            };
            practitioner.Telecom = new List<ContactPoint>
            {
                 new ContactPoint(ContactPoint.ContactPointSystem.Phone, ContactPoint.ContactPointUse.Mobile, "13387362766")
            };
            practitioner.GenderElement = new Code<AdministrativeGender>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender", "1", "男性"))
                }
            };
            practitioner.BirthDate = "1988-04-09";
            practitioner.Address = new List<Address>
            {
                new Address()
                {
                    Use = Address.AddressUse.Home,
                    Text = "成都市XXX区XXX小区XXXX号"
                }
            };
            practitioner.Photo = new List<Attachment>
            {
                new Attachment()
                {
                    ContentType = "image/jpeg",
                    Url = "photo url"
                }
            };

            return practitioner;
        }

        private DomainResource AssemblePatient()
        {
            Patient patient = new Patient();
            patient.Id = "唯一标识，如uuid，身份证号";
            patient.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Patient"
                }
            };
            patient.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/patient-identifier", "511002938706190932")
                {
                    Use = Identifier.IdentifierUse.Usual,
                    Type = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/identity-document-type", "01", "身份证", "身份证")
                }
            };
            patient.Active = true;
            patient.Name = new List<HumanName>
            {
                new HumanName()
                {
                    Text = "张三"
                }
            };
            patient.Telecom = new List<ContactPoint>
            {
                 new ContactPoint(ContactPoint.ContactPointSystem.Phone, ContactPoint.ContactPointUse.Mobile, "13387362763")
            };
            patient.GenderElement = new Code<AdministrativeGender>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/sexual-distinction-of-human", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/physiological-gender", "1", "男性"))
                }
            };
            patient.BirthDate = "1980-02-01";
            patient.Deceased = new FhirBoolean(false);
            patient.Address = new List<Address>
            {
                new Address()
                {
                    Use = Address.AddressUse.Home,
                    Text = "XX街xx路"
                }
            };
            patient.Photo = new List<Attachment>
            {
                new Attachment()
                {
                    ContentType = "image/jpeg",
                    Url = "photo url"
                }
            };
            patient.Contact = new List<Patient.ContactComponent>
            {
                new Patient.ContactComponent
                {
                    Relationship = new List<CodeableConcept>
                    {
                        new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/family-relationship", "1" ,"配偶" ,"配偶")
                    },
                    Name = new HumanName()
                    {
                        Text = "李四"
                    },
                    Telecom = new List<ContactPoint>
                    {
                        new ContactPoint(ContactPoint.ContactPointSystem.Phone, ContactPoint.ContactPointUse.Mobile, "13312345678")
                    }
                }
            };

            return patient;
        }

        private DomainResource AssembleLocation()
        {
            Location location = new Location();
            location.Id = "唯一标识，如uuid";
            location.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-consultation-room"
                }
            };
            location.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-A001-consulting-room-identifier", "X00001")
            };
            location.Status = Location.LocationStatus.Active;
            location.Name = "第一诊室";
            location.Alias = new List<string>
            {
                "全科诊室"
            };
            location.Description = "诊室详情";
            location.ManagingOrganization = new ResourceReference("Department/DepartmentID", "科室描述");

            return location;
        }

        private DomainResource AssembleDepartment()
        {
            Organization department = new Organization();
            department.Id = "唯一标识，如uuid";
            department.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Department"
                }
            };
            department.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-department-identifier", "A001")
            };
            department.Active = true;
            department.Type = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind", "4", "科室", "科室")
            };
            department.Name = "普通外科";
            department.Alias = new List<string>
            {
                "外1科"
            };
            department.Telecom = new List<ContactPoint>
            {
                 new ContactPoint(ContactPoint.ContactPointSystem.Phone, ContactPoint.ContactPointUse.Mobile, "13309876352"),
                 new ContactPoint(ContactPoint.ContactPointSystem.Email, ContactPoint.ContactPointUse.Work, "xx@xx.com")
            };
            department.Address = new List<Address>
            {
                new Address()
                {
                    Text = "xxxx地址"
                }
            };
            department.PartOf = new ResourceReference("Organization/OrganizationID", "科室所属医院描述");
            department.Extension = new List<Extension>
            {
                new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction", new FhirString("XXXXXXXX科室针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。"))
            };
            return department;
        }

        private DomainResource AssembleHospital()
        {
            Organization hospital = new Organization();
            hospital.Id = "唯一标识，如uuid，组织机构统一社会信用代码";
            hospital.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/Hospital"
                }
            };
            hospital.Identifier = new List<Identifier>
            {
                new Identifier("https://www.cods.org.cn", "12510125450833106C")
            };
            hospital.Active = true;
            hospital.Type = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/hierarchy-kind", "2", "医院", "医院"),
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/health-institution-or-organization-category", "A100", "综合医院", "综合医院")
            };
            hospital.Name = "xx医院";
            hospital.Alias = new List<string>
            {
                "xxxx医院"
            };
            hospital.Telecom = new List<ContactPoint>
            {
                 new ContactPoint(ContactPoint.ContactPointSystem.Phone, ContactPoint.ContactPointUse.Mobile, "13309876352"),
                 new ContactPoint(ContactPoint.ContactPointSystem.Email, ContactPoint.ContactPointUse.Work, "xx@xx.com"),
                 new ContactPoint(ContactPoint.ContactPointSystem.Url, ContactPoint.ContactPointUse.Work, "http://www.cdzxy.com/")
            };
            hospital.Address = new List<Address>
            {
                new Address()
                {
                    Text = "xxxx地址"
                }
            };
            hospital.Extension = new List<Extension>
            {
                new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/BriefIntroduction", new FhirString("XXXXXXXX医院血液科针对【血小板减少】、【血小板增多】、【过敏性紫癜】、【贫血】等病提供专业治疗方案。"))
            };

            return hospital;
        }

        private void DisassembleAppointment(Appointment appointment)
        {
            Console.WriteLine(appointment.Id);
            foreach (var profile in appointment.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in appointment.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            foreach (var extension in appointment.StatusElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            foreach (var serviceType in appointment.ServiceType)
            {
                foreach (var coding in serviceType.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            foreach (var coding in appointment.AppointmentType.Coding)
            {
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(appointment.Start);
            Console.WriteLine(appointment.End);
            foreach (var slot in appointment.Slot)
            {
                Console.WriteLine(slot.Reference);
                Console.WriteLine(slot.Display);
            }
            Console.WriteLine(appointment.Created);
            Console.WriteLine(appointment.PatientInstruction);
            foreach (var participant in appointment.Participant)
            {
                Console.WriteLine(participant.Actor.Reference);
                Console.WriteLine(participant.Actor.Display);
                Console.WriteLine(participant.Status);
            }
            foreach (var supportingInformation in appointment.SupportingInformation)
            {
                Console.WriteLine(supportingInformation.Reference);
                Console.WriteLine(supportingInformation.Display);
            }
        }

        private void DisassembleChargeItem(ChargeItem chargeItem)
        {
            Console.WriteLine(chargeItem.Id);
            foreach (var profile in chargeItem.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in chargeItem.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            foreach (var extension in chargeItem.StatusElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            foreach (var coding in chargeItem.Code.Coding)
            {
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(chargeItem.PriceOverride.Value);
            Console.WriteLine(chargeItem.PriceOverride.Currency);
            Console.WriteLine(chargeItem.Quantity.Value);
            foreach (var note in chargeItem.Note)
            {
                Console.WriteLine(note.Text);
            }
        }

        private void DisassembleSlot(Slot slot)
        {
            Console.WriteLine(slot.Id);
            foreach (var profile in slot.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var serviceType in slot.ServiceType)
            {
                foreach (var coding in serviceType.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            foreach (var coding in slot.AppointmentType.Coding)
            {
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            foreach (var extension in slot.Extension)
            {
                Console.WriteLine(extension.Url);
                Ratio ratio = (Ratio)extension.Value;
                Console.WriteLine(ratio.Numerator.Value);
                Console.WriteLine(ratio.Numerator.Unit);
                Console.WriteLine(ratio.Denominator.Value);
                Console.WriteLine(ratio.Denominator.Unit);
            }
            Console.WriteLine(slot.Schedule.Reference);
            Console.WriteLine(slot.Schedule.Display);
            Console.WriteLine(slot.Status);
            Console.WriteLine(slot.Start);
            Console.WriteLine(slot.End);
        }

        private void DisassembleSchedule(Schedule schedule)
        {
            Console.WriteLine(schedule.Id);
            foreach (var profile in schedule.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var serviceType in schedule.ServiceType)
            {
                foreach (var coding in serviceType.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            Console.WriteLine(schedule.PlanningHorizon.Start);
            Console.WriteLine(schedule.PlanningHorizon.End);
            foreach (var actor in schedule.Actor)
            {
                Console.WriteLine(actor.Reference);
                Console.WriteLine(actor.Display);
            }
            Console.WriteLine(schedule.Comment);
        }

        private void DisassemblePractitioner(Practitioner practitioner)
        {
            Console.WriteLine(practitioner.Id);
            foreach (var profile in practitioner.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in practitioner.Identifier)
            {
                foreach (var coding in identifier.Type.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
                Console.WriteLine(identifier.Use);
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            Console.WriteLine(practitioner.Active);
            foreach (var name in practitioner.Name)
            {
                Console.WriteLine(name.Text);
            }
            foreach (var telecom in practitioner.Telecom)
            {
                Console.WriteLine(telecom.System);
                Console.WriteLine(telecom.Use);
                Console.WriteLine(telecom.Value);
            }
            foreach (var extension in practitioner.GenderElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(practitioner.BirthDate);
            foreach (var address in practitioner.Address)
            {
                Console.WriteLine(address.Use);
                Console.WriteLine(address.Text);
            }
            foreach (var photo in practitioner.Photo)
            {
                Console.WriteLine(photo.ContentType);
                Console.WriteLine(photo.Url);
            }
        }

        private void DisassemblePatient(Patient patient)
        {
            Console.WriteLine(patient.Id);
            foreach (var profile in patient.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in patient.Identifier)
            {
                foreach (var coding in identifier.Type.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
                Console.WriteLine(identifier.Use);
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            Console.WriteLine(patient.Active);
            foreach (var name in patient.Name)
            {
                Console.WriteLine(name.Text);
            }
            foreach (var telecom in patient.Telecom)
            {
                Console.WriteLine(telecom.System);
                Console.WriteLine(telecom.Use);
                Console.WriteLine(telecom.Value);
            }
            foreach (var extension in patient.GenderElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(patient.BirthDate);
            Console.WriteLine(patient.Deceased);
            foreach (var address in patient.Address)
            {
                Console.WriteLine(address.Use);
                Console.WriteLine(address.Text);
            }
            foreach (var photo in patient.Photo)
            {
                Console.WriteLine(photo.ContentType);
                Console.WriteLine(photo.Url);
            }
            foreach (var contact in patient.Contact)
            {
                foreach (var relationship in contact.Relationship)
                {
                    foreach (var coding in relationship.Coding)
                    {
                        Console.WriteLine(coding.System);
                        Console.WriteLine(coding.Code);
                        Console.WriteLine(coding.Display);
                    }
                    Console.WriteLine(relationship.Text);
                }
                Console.WriteLine(contact.Name.Text);
                foreach (var telecom in contact.Telecom)
                {
                    Console.WriteLine(telecom.System);
                    Console.WriteLine(telecom.Use);
                    Console.WriteLine(telecom.Value);
                }
            }
        }

        private void DisassembleLocation(Location location)
        {
            Console.WriteLine(location.Id);
            foreach (var profile in location.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in location.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            Console.WriteLine(location.Status);
            Console.WriteLine(location.Name);
            foreach (var alias in location.Alias)
            {
                Console.WriteLine(alias);
            }
            Console.WriteLine(location.Description);
            Console.WriteLine(location.ManagingOrganization.Reference);
            Console.WriteLine(location.ManagingOrganization.Display);
        }

        private void DisassembleDepartment(Organization department)
        {
            Console.WriteLine(department.Id);
            foreach (var profile in department.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in department.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            Console.WriteLine(department.Active);
            foreach (var type in department.Type)
            {
                foreach (var coding in type.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            Console.WriteLine(department.Name);
            foreach (var alias in department.Alias)
            {
                Console.WriteLine(alias);
            }
            foreach (var telecom in department.Telecom)
            {
                Console.WriteLine(telecom.System);
                Console.WriteLine(telecom.Use);
                Console.WriteLine(telecom.Value);
            }
            foreach (var address in department.Address)
            {
                Console.WriteLine(address.Text);
            }
            Console.WriteLine(department.PartOf.Reference);
            Console.WriteLine(department.PartOf.Display);
            foreach (var extension in department.Extension)
            {
                Console.WriteLine(extension.Url);
                Console.WriteLine(extension.Value);
            }
        }

        private void DisassembleHospital(Organization hospital)
        {
            Console.WriteLine(hospital.Id);
            foreach (var profile in hospital.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in hospital.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            Console.WriteLine(hospital.Active);
            foreach (var type in hospital.Type)
            {
                foreach (var coding in type.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            Console.WriteLine(hospital.Name);
            foreach (var alias in hospital.Alias)
            {
                Console.WriteLine(alias);
            }
            foreach (var telecom in hospital.Telecom)
            {
                Console.WriteLine(telecom.System);
                Console.WriteLine(telecom.Use);
                Console.WriteLine(telecom.Value);
            }
            foreach (var address in hospital.Address)
            {
                Console.WriteLine(address.Text);
            }
            foreach (var extension in hospital.Extension)
            {
                Console.WriteLine(extension.Url);
                Console.WriteLine(extension.Value);
            }
        }
    }
}
```

## 取消挂号接口

### 接口功能

> 用户在挂号成功后可主动取消挂号

### 参考地址(URL)

> http://ip:port/api/appointment/cancel-appointment

### HTTP请求方式(Method)

> POST

### 数据格式

> JSON（必须支持）
>
> XML（可选支持）

### 请求数据

#### 请求头(Request Header)

> 无

#### 查询参数(Query)

|      名称       | 是否必填 |   说明   |
| :-------------: | :------: | :------: |
| organization-id |    是    | 机构编码 |

#### 参考结构

```xml
<?xml version="1.0" encoding="utf-8" ?>
<Bundle xmlns="http://hl7.org/fhir">
    <id value="唯一标识，如uuid"/>
    <type value="transaction"/>
    <!-- 0..1 ******************************挂号单****************************** -->
    <entry>
        <resource>
            <Appointment xmlns="http://hl7.org/fhir">
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"/>
                </meta>
                <!-- 0..* 预约挂号号源编号 -->
                <identifier>
                    <!-- 0..1 预约挂号号源编号NamingSystem uri -->
                    <system value="https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier"/>
                    <!-- 0..1 预约挂号号源编号 -->
                    <value value="A0000001"/>
                </identifier>
                <!-- 1..1 预约状态 -->
                <status >
                    <extension url="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status">
                        <valueCoding>
                            <!-- 0..1 预约状态 CodeSystem url -->
                            <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status"/>
                            <!-- 0..1 预约状态代码 -->
                            <code value="05"/>
                            <!-- 0..1 预约状态说明 -->
                            <display value="已取消"/>
                        </valueCoding>
                    </extension>
                </status>
                <!-- 0..1 服务类型 -->
                <serviceType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc"/>
                        <code value="102"/>
                        <display value="专家门诊"/>
                    </coding>
                </serviceType>
                <!-- 0..1 预约类型 -->
                <appointmentType>
                    <coding>
                        <system value="https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code"/>
                        <code value="4"/>
                        <display value="网上预约"/>
                    </coding>
                    <text value="网上预约"/>
                </appointmentType>
                <!-- 0..1 开始时间 -->
                <start value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 结束时间 -->
                <end value="2020-11-10T14:00:00Z"/>
                <!-- 0..* 预约时段 Reference(Slot) -->
                <slot>
                    <reference value="Slot/SlotID"/>
                    <display value="时段描述"/>
                </slot>
                <!-- 0..1 创建挂号单时间 -->
                <created value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 注意事项 -->
                <patientInstruction value="[string]"/>
                <!-- 1..* 参与者 -->
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Practitioner/PractitionerID"/>
                        <display value="医生描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Patient/PatientID"/>
                        <display value="患者描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <participant>
                    <!-- 0..1 参与人 Reference(Patient | Practitioner | PractitionerRole | RelatedPerson | Device | HealthcareService | Location) -->
                    <actor>
                        <reference value="Location/LocationID"/>
                        <display value="诊室描述"/>
                    </actor>
                    <!-- 1..1 状态 accepted | declined | tentative | needs-action -->
                    <status value="accepted"/>
                </participant>
                <!-- 0..* 费用信息 Reference(Any) -->
                <supportingInformation>
                    <reference value="ChargeItem/ChargeItemID"/>
                    <display value="缴费项描述"/>
                </supportingInformation>
            </Appointment>
        </resource>
    </entry>
</Bundle>
```

#### 示例代码

**JAVA**

```java
package fhir.预约挂号;

import java.util.Date;

import org.hl7.fhir.r4.model.Appointment;
import org.hl7.fhir.r4.model.Appointment.AppointmentParticipantComponent;
import org.hl7.fhir.r4.model.Appointment.AppointmentStatus;
import org.hl7.fhir.r4.model.Appointment.AppointmentStatusEnumFactory;
import org.hl7.fhir.r4.model.Appointment.ParticipationStatus;
import org.hl7.fhir.r4.model.Bundle;
import org.hl7.fhir.r4.model.Bundle.BundleEntryComponent;
import org.hl7.fhir.r4.model.Bundle.BundleType;
import org.hl7.fhir.r4.model.CanonicalType;
import org.hl7.fhir.r4.model.CodeableConcept;
import org.hl7.fhir.r4.model.Coding;
import org.hl7.fhir.r4.model.DomainResource;
import org.hl7.fhir.r4.model.Enumeration;
import org.hl7.fhir.r4.model.Extension;
import org.hl7.fhir.r4.model.Identifier;
import org.hl7.fhir.r4.model.Meta;
import org.hl7.fhir.r4.model.Reference;
import org.hl7.fhir.r4.model.Resource;

import ca.uhn.fhir.context.FhirContext;

public class 取消挂号接口请求 {
    public void serialize() {
        Bundle bundle = new Bundle();
        bundle.setId("唯一标识，如uuid");
        bundle.setType(BundleType.TRANSACTION);
        bundle.addEntry(new BundleEntryComponent().setResource(assembleAppointment()));
        System.out.println(FhirContext.forR4().newJsonParser().encodeResourceToString(bundle));
    }

    public void deserialize() {
        String fhirJson = "序列化生成的json格式字符串";

        Bundle bundle = FhirContext.forR4().newJsonParser().parseResource(Bundle.class, fhirJson);
        System.out.println(bundle.getId());
        System.out.println(bundle.getType());

        for (BundleEntryComponent bundleEntryComponent : bundle.getEntry()) {
            Resource domainResource = bundleEntryComponent.getResource();
            if (domainResource instanceof Appointment) {
                Appointment appointment = (Appointment) domainResource;
                disassembleAppointment(appointment);
            }
        }
    }

    private DomainResource assembleAppointment() {
        Appointment appointment = new Appointment();
        appointment.setId("唯一标识，如uuid");
        appointment.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"));
        appointment.addIdentifier(new Identifier()
            .setSystem("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier").setValue("A0000001"));
        Extension extension = new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status",
            new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status", "01", "已申请"));
        Enumeration<AppointmentStatus> enumeration = new Enumeration<AppointmentStatus>(new AppointmentStatusEnumFactory());
        enumeration.addExtension(extension);
        appointment.setStatusElement(enumeration);
        appointment.addServiceType(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊")));
        appointment.setAppointmentType(
            new CodeableConcept().addCoding(new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Appointment-route-code", "4", "网上预约")).setText("网上预约"));
        appointment.setStart(new Date());
        appointment.setEnd(new Date());
        appointment.addSlot(new Reference("Slot/SlotID").setDisplay("时段描述"));
        appointment.setCreated(new Date());
        appointment.setPatientInstruction("注意事项");
        AppointmentParticipantComponent patientComponent = new AppointmentParticipantComponent();
        patientComponent.setActor(new Reference("Patient/PatientID").setDisplay("患者描述"));
        patientComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(patientComponent);
        AppointmentParticipantComponent practitionerComponent = new AppointmentParticipantComponent();
        practitionerComponent.setActor(new Reference("Practitioner/PractitionerID").setDisplay("医生描述"));
        practitionerComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(practitionerComponent);
        AppointmentParticipantComponent locationComponent = new AppointmentParticipantComponent();
        locationComponent.setActor(new Reference("Location/LocationID").setDisplay("诊室描述"));
        locationComponent.setStatus(ParticipationStatus.ACCEPTED);
        appointment.addParticipant(locationComponent);
        appointment.addSupportingInformation(new Reference("ChargeItem/ChargeItemID").setDisplay("缴费项描述"));
        return appointment;
    }

    private void disassembleAppointment(Appointment appointment) {
        System.out.println(appointment.getId());
        for (CanonicalType profile : appointment.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        for (Identifier identifier : appointment.getIdentifier()) {
            System.out.println(identifier.getSystem());
            System.out.println(identifier.getValue());
        }
        for (Extension extension : appointment.getStatusElement().getExtension()) {
            System.out.println(extension.getUrl());
            Coding coding = (Coding) extension.getValue();
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        for (CodeableConcept serviceType : appointment.getServiceType()) {
            for (Coding coding : serviceType.getCoding()) {
                System.out.println(coding.getSystem());
                System.out.println(coding.getCode());
                System.out.println(coding.getDisplay());
            }
        }
        for (Coding coding : appointment.getAppointmentType().getCoding()) {
            System.out.println(coding.getSystem());
            System.out.println(coding.getCode());
            System.out.println(coding.getDisplay());
        }
        System.out.println(appointment.getStart());
        System.out.println(appointment.getEnd());
        for (Reference slot : appointment.getSlot()) {
            System.out.println(slot.getReference());
            System.out.println(slot.getDisplay());
        }
        System.out.println(appointment.getCreated());
        System.out.println(appointment.getPatientInstruction());
        for (AppointmentParticipantComponent appointmentParticipantComponent : appointment.getParticipant()) {
            System.out.println(appointmentParticipantComponent.getActor().getReference());
            System.out.println(appointmentParticipantComponent.getActor().getDisplay());
            System.out.println(appointmentParticipantComponent.getStatus());
        }
        for (Reference supportingInformation : appointment.getSupportingInformation()) {
            System.out.println(supportingInformation.getReference());
            System.out.println(supportingInformation.getDisplay());
        }
    }
}
```

**C#**

```c#
using System;
using System.Collections.Generic;
using Hl7.Fhir.Model;
using Hl7.Fhir.Serialization;

namespace fhir.预约挂号
{
    public class 取消挂号接口请求
    {
        public void Serialize()
        {
            Bundle bundle = new Bundle();
            bundle.Id = "唯一标识，如uuid";
            bundle.Type = Bundle.BundleType.Transaction;
            bundle.Entry = new List<Bundle.EntryComponent>
            {
                new Bundle.EntryComponent { Resource = AssembleAppointment() }
            };
            Console.WriteLine(new FhirJsonSerializer().SerializeToString(bundle));
        }

        public void Deserialize()
        {
            string fhirJson = "序列化生成的json格式字符串";

            Bundle bundle = new FhirJsonParser().Parse<Bundle>(fhirJson);
            Console.WriteLine(bundle.Id);
            Console.WriteLine(bundle.Type);

            foreach (var entryComponent in bundle.Entry)
            {
                Resource domainResource = entryComponent.Resource;
                if (domainResource is Appointment)
                {
                    Appointment appointment = (Appointment)domainResource;
                    DisassembleAppointment(appointment);
                }
            }
        }

        private DomainResource AssembleAppointment()
        {
            Appointment appointment = new Appointment();
            appointment.Id = "唯一标识，如uuid";
            appointment.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/outpatient-registration-source"
                }
            };
            appointment.Identifier = new List<Identifier>
            {
                new Identifier("https://fhir.scwjxx.cn/Sichuan/fhir/NamingSystem/12510125450833106C-outpatient-registration-source-identifier", "A0000001")
            };
            appointment.StatusElement = new Code<Appointment.AppointmentStatus>
            {
                Extension = new List<Extension>
                {
                    new Extension("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/resource-status", new Coding("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-status", "05", "已取消"))
                }
            };
            appointment.ServiceType = new List<CodeableConcept>
            {
                new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/Outpatient-Department-type-sc", "102", "专家门诊", "专家门诊")
            };
            appointment.AppointmentType = new CodeableConcept("https://fhir.scwjxx.cn/Sichuan/fhir/CodeSystem/appointment-type", "4", "网上预约", "网上预约");
            appointment.Start = DateTime.Now;
            appointment.End = DateTime.Now;
            appointment.Slot = new List<ResourceReference>
            {
                new ResourceReference("Slot/SlotID", "时段描述")
            };
            appointment.Created = "2021-01-20T09:27:30";
            appointment.PatientInstruction = "注意事项";
            appointment.Participant = new List<Appointment.ParticipantComponent>
            {
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Patient/PatientID", "患者描述"),
                    Status = ParticipationStatus.Accepted
                },
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Practitioner/PractitionerID", "医生描述"),
                    Status = ParticipationStatus.Accepted
                },
                new Appointment.ParticipantComponent
                {
                    Actor = new ResourceReference("Location/LocationID", "诊室描述"),
                    Status = ParticipationStatus.Accepted
                }
            };
            appointment.SupportingInformation = new List<ResourceReference>
            {
                new ResourceReference("ChargeItem/ChargeItemID", "缴费项描述")
            };

            return appointment;
        }

        private void DisassembleAppointment(Appointment appointment)
        {
            Console.WriteLine(appointment.Id);
            foreach (var profile in appointment.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            foreach (var identifier in appointment.Identifier)
            {
                Console.WriteLine(identifier.System);
                Console.WriteLine(identifier.Value);
            }
            foreach (var extension in appointment.StatusElement.Extension)
            {
                Console.WriteLine(extension.Url);
                Coding coding = (Coding)extension.Value;
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            foreach (var serviceType in appointment.ServiceType)
            {
                foreach (var coding in serviceType.Coding)
                {
                    Console.WriteLine(coding.System);
                    Console.WriteLine(coding.Code);
                    Console.WriteLine(coding.Display);
                }
            }
            foreach (var coding in appointment.AppointmentType.Coding)
            {
                Console.WriteLine(coding.System);
                Console.WriteLine(coding.Code);
                Console.WriteLine(coding.Display);
            }
            Console.WriteLine(appointment.Start);
            Console.WriteLine(appointment.End);
            foreach (var slot in appointment.Slot)
            {
                Console.WriteLine(slot.Reference);
                Console.WriteLine(slot.Display);
            }
            Console.WriteLine(appointment.Created);
            Console.WriteLine(appointment.PatientInstruction);
            foreach (var participant in appointment.Participant)
            {
                Console.WriteLine(participant.Actor.Reference);
                Console.WriteLine(participant.Actor.Display);
                Console.WriteLine(participant.Status);
            }
            foreach (var supportingInformation in appointment.SupportingInformation)
            {
                Console.WriteLine(supportingInformation.Reference);
                Console.WriteLine(supportingInformation.Display);
            }
        }
    }
}
```

### 响应数据

#### 响应头(Response Header)

> 无

#### 参考结构

```xml
<?xml version="1.0" encoding="utf-8" ?>
<Bundle xmlns="http://hl7.org/fhir">
    <id value="唯一标识，如uuid"/>
    <type value="transaction-response"/>
    <!-- 0..1 ******************************取消挂号响应****************************** -->
    <entry>
        <resource>
            <AppointmentResponse xmlns="http://hl7.org/fhir">
                <!-- 0..1 患者到诊应答ID -->
                <id value="唯一标识，如uuid"/>
                <meta>
                    <profile value="https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/registrated-response"/>
                </meta>
                <!-- 1..1 Reference(Appointment) 号源编号 -->
                <appointment>
                    <reference value="Appointment/AppointmentID"/>
                    <display value="号源描述"/>
                </appointment>
                <!-- 0..1 开始时间 -->
                <start value="2020-11-10T13:00:00Z"/>
                <!-- 0..1 结束时间 -->
                <end value="2020-11-10T14:00:00Z"/>
                <!-- 0..1 响应医生 -->
                <actor>
                    <reference value="Practitioner/PractitionerID"/>
                    <display value="医生描述"/>
                </actor>
                <!-- 1..1 响应状态 accepted | declined | tentative | needs-action -->
                <participantStatus value="accepted"/>
                <!-- 0..1 备注 -->
                <comment value="同意取消挂号预约"/>
            </AppointmentResponse>
        </resource>
    </entry>
</Bundle>
```

#### 示例代码

**JAVA**

```java
package fhir.预约挂号;

import java.util.Date;

import org.hl7.fhir.r4.model.AppointmentResponse;
import org.hl7.fhir.r4.model.AppointmentResponse.ParticipantStatus;
import org.hl7.fhir.r4.model.Bundle;
import org.hl7.fhir.r4.model.Bundle.BundleEntryComponent;
import org.hl7.fhir.r4.model.Bundle.BundleType;
import org.hl7.fhir.r4.model.CanonicalType;
import org.hl7.fhir.r4.model.DomainResource;
import org.hl7.fhir.r4.model.Meta;
import org.hl7.fhir.r4.model.Reference;
import org.hl7.fhir.r4.model.Resource;

import ca.uhn.fhir.context.FhirContext;

public class 取消挂号接口响应 {
    public void serialize() {
        Bundle bundle = new Bundle();
        bundle.setId("唯一标识，如uuid");
        bundle.setType(BundleType.TRANSACTIONRESPONSE);
        bundle.addEntry(new BundleEntryComponent().setResource(assembleAppointmentResponse()));
        System.out.println(FhirContext.forR4().newJsonParser().encodeResourceToString(bundle));
    }

    public void deserialize() {
        String fhirJson = "序列化生成的json格式字符串";

        Bundle bundle = FhirContext.forR4().newJsonParser().parseResource(Bundle.class, fhirJson);
        System.out.println(bundle.getId());
        System.out.println(bundle.getType());

        for (BundleEntryComponent bundleEntryComponent : bundle.getEntry()) {
            Resource domainResource = bundleEntryComponent.getResource();
            if (domainResource instanceof AppointmentResponse) {
                AppointmentResponse appointmentResponse = (AppointmentResponse) domainResource;
                disassembleAppointmentResponse(appointmentResponse);
            }
        }
    }

    private DomainResource assembleAppointmentResponse() {
        AppointmentResponse appointmentResponse = new AppointmentResponse();
        appointmentResponse.setId("唯一标识，如uuid");
        appointmentResponse.setMeta(new Meta().addProfile("https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/registrated-response"));
        appointmentResponse.setAppointment(new Reference("Appointment/AppointmentID").setDisplay("号源描述"));
        appointmentResponse.setStart(new Date());
        appointmentResponse.setEnd(new Date());
        appointmentResponse.setActor(new Reference("Practitioner/PractitionerID").setDisplay("医生描述"));
        appointmentResponse.setParticipantStatus(ParticipantStatus.ACCEPTED);
        appointmentResponse.setComment("同意取消挂号预约");
        return appointmentResponse;
    }

    private void disassembleAppointmentResponse(AppointmentResponse appointmentResponse) {
        System.out.println(appointmentResponse.getId());
        for (CanonicalType profile : appointmentResponse.getMeta().getProfile()) {
            System.out.println(profile.getValue());
        }
        System.out.println(appointmentResponse.getAppointment().getReference());
        System.out.println(appointmentResponse.getAppointment().getDisplay());
        System.out.println(appointmentResponse.getStart());
        System.out.println(appointmentResponse.getEnd());
        System.out.println(appointmentResponse.getActor().getReference());
        System.out.println(appointmentResponse.getActor().getDisplay());
        System.out.println(appointmentResponse.getParticipantStatus());
        System.out.println(appointmentResponse.getComment());
    }
}
```

**C#**

```c#
using System;
using System.Collections.Generic;
using Hl7.Fhir.Model;
using Hl7.Fhir.Serialization;

namespace fhir.预约挂号
{
    public class 取消挂号接口响应
    {
        public void Serialize()
        {
            Bundle bundle = new Bundle();
            bundle.Id = "唯一标识，如uuid";
            bundle.Type = Bundle.BundleType.TransactionResponse;
            bundle.Entry = new List<Bundle.EntryComponent>
            {
                new Bundle.EntryComponent { Resource = AssembleAppointmentResponse() }
            };
            Console.WriteLine(new FhirJsonSerializer().SerializeToString(bundle));
        }

        public void Deserialize()
        {
            string fhirJson = "序列化生成的json格式字符串";

            Bundle bundle = new FhirJsonParser().Parse<Bundle>(fhirJson);
            Console.WriteLine(bundle.Id);
            Console.WriteLine(bundle.Type);

            foreach (var entryComponent in bundle.Entry)
            {
                Resource domainResource = entryComponent.Resource;
                if (domainResource is AppointmentResponse)
                {
                    AppointmentResponse appointmentResponse = (AppointmentResponse)domainResource;
                    DisassembleAppointmentResponse(appointmentResponse);
                }
            }
        }

        private DomainResource AssembleAppointmentResponse()
        {
            AppointmentResponse appointmentResponse = new AppointmentResponse();
            appointmentResponse.Id = "唯一标识，如uuid";
            appointmentResponse.Meta = new Meta
            {
                Profile = new List<string>
                {
                    "https://fhir.scwjxx.cn/Sichuan/fhir/StructureDefinition/registrated-response"
                }
            };
            appointmentResponse.Appointment = new ResourceReference("Appointment/AppointmentID", "号源描述");
            appointmentResponse.Start = DateTime.Now;
            appointmentResponse.End = DateTime.Now;
            appointmentResponse.Actor = new ResourceReference("Practitioner/PractitionerID", "医生描述");
            appointmentResponse.ParticipantStatus = ParticipationStatus.Accepted;
            appointmentResponse.Comment = "同意取消挂号预约";

            return appointmentResponse;
        }

        private void DisassembleAppointmentResponse(AppointmentResponse appointmentResponse)
        {
            Console.WriteLine(appointmentResponse.Id);
            foreach (var profile in appointmentResponse.Meta.Profile)
            {
                Console.WriteLine(profile);
            }
            Console.WriteLine(appointmentResponse.Appointment.Reference);
            Console.WriteLine(appointmentResponse.Appointment.Display);
            Console.WriteLine(appointmentResponse.Start);
            Console.WriteLine(appointmentResponse.End);
            Console.WriteLine(appointmentResponse.Actor.Reference);
            Console.WriteLine(appointmentResponse.Actor.Display);
            Console.WriteLine(appointmentResponse.ParticipantStatus);
            Console.WriteLine(appointmentResponse.Comment);
        }
    }
}
```

