(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b8d86b5e"],{"2c32":function(e,t,a){},"2dfa":function(e,t,a){"use strict";a("2c32")},"32cd":function(e,t,a){},"623f":function(e,t,a){"use strict";a("32cd")},da7c:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticStyle:{margin:"10px","border-radius":"4px"}},[a("el-main",[a("el-input",{staticStyle:{"text-align":"right","margin-left":"12px",width:"200px"},attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search",size:"small"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("el-button",{staticStyle:{"text-align":"right","margin-left":"12px"},attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(t){return e.fetchData()}}},[e._v("查询 ")]),a("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-document-add"},on:{click:function(t){return e.showAddPage("")}}},[e._v("新增")]),a("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-download"},on:{click:function(t){return e.download()}}},[e._v("Excel模板下载")]),a("el-table",{staticStyle:{"margin-top":"10px",width:"100%"},attrs:{data:e.page.records,stripe:"",height:"400px",size:"mini","row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{prop:"name",label:"数据源名称",width:"180","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"version",label:"版本",width:"80"}}),a("el-table-column",{attrs:{prop:"dbType",label:"数据源类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("capitalize")(a.dbType))+" ")]}}])}),a("el-table-column",{attrs:{prop:"dbName",label:"文件/数据库名称",width:"140","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"url",label:"数据库地址","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"120","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.showDescPage(t.row)}}},[e._v("详情")]),1===t.row.dbType?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.showDescPage(t.row)}}},[e._v(" 更新 ")]):e._e(),1!==t.row.dbType?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.showAddPage(t.row.id)}}},[e._v(" 修改 ")]):e._e(),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.deleteRow(t.row.id)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{staticStyle:{"text-align":"right","margin-top":"12px"},attrs:{background:"",total:e.page.total,layout:"total, sizes, prev, pager, next, jumper","page-size":e.page.size,"page-sizes":[10,20,50],"current-page":e.page.current},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("Add",{ref:"AddRef",on:{reshLsit:e.fetchData}}),a("Info",{ref:"InfoRef"})],1)],1)},s=[],o=(a("b0c0"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("b964")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-drawer",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{size:"28%",visible:e.drawer,"with-header":!1},on:{"update:visible":function(t){e.drawer=t}}},[a("el-form",{ref:"form",staticClass:"demo-ruleForm",staticStyle:{"margin-top":"60px"},attrs:{model:e.form,"label-width":"120px",size:"small",rules:e.rules}},[a("el-form-item",{attrs:{label:"数据源类型：",prop:"dbType"}},[a("el-select",{attrs:{placeholder:"请选择数据源类型"},model:{value:e.form.dbType,callback:function(t){e.$set(e.form,"dbType",t)},expression:"form.dbType"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"数据源名称：",prop:"name"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),0!==e.form.dbType?a("el-form-item",{attrs:{label:"数据库名称：",prop:"dbName"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:e.form.dbName,callback:function(t){e.$set(e.form,"dbName",t)},expression:"form.dbName"}})],1):e._e(),0!==e.form.dbType?a("el-form-item",{attrs:{label:"dbUrl：",prop:"url"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1):e._e(),0!==e.form.dbType?a("el-form-item",{attrs:{label:"数据库账号：",prop:"user"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:e.form.user,callback:function(t){e.$set(e.form,"user",t)},expression:"form.user"}})],1):e._e(),0!==e.form.dbType?a("el-form-item",{attrs:{label:"数据库密码：",prop:"passwd"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{type:"password"},model:{value:e.form.passwd,callback:function(t){e.$set(e.form,"passwd",t)},expression:"form.passwd"}})],1):e._e(),0===e.form.dbType?a("el-upload",{staticClass:"avatar-uploader",staticStyle:{margin:"16px"},attrs:{drag:"",action:"/codegeneration/ds/upload","on-success":e.handleSuccess,"on-remove":e.handleRemove,limit:1,"on-progress":e.onProgress}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])]):e._e(),a("el-form-item",[a("el-button",{attrs:{disabled:e.add_btn_dis,type:"primary"},on:{click:e.handle}},[e._v("保存")]),0!==e.form.dbType?a("el-button",{attrs:{type:"primary"},on:{click:e.valid}},[e._v("连接测试")]):e._e()],1)],1)],1)},i=[],n=a("5c96"),c={data:function(){return{currentPage4:4,loading:!1,drawer:!1,ds:!1,form:{id:"",fileId:"",name:"",dbType:0,dbName:"",url:"",port:"",user:"",passwd:""},add_btn_dis:!1,options:[{value:0,label:"Excel"},{value:1,label:"MySql"},{value:2,label:"SqlServer"}],rules:{dbType:[{required:!0}],name:[{required:!0,message:"请输入数据源名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],dbName:[{required:!0,message:"请输入数据库名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],url:[{required:!0,message:"请输入数据库连接地址",trigger:"blur"}],user:[{required:!0,message:"请输入数据库账号",trigger:"blur"},{min:2,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],passwd:[{required:!0,message:"请输入数据库密码",trigger:"blur"},{min:3,max:50,message:"长度在 3 到 50 个字符",trigger:"blur"}]}}},methods:{handle:function(){var e=this;this.loading=!0,this.$store.dispatch("datasource/add",this.form).then((function(t){e.loading=!1,e.drawer=!1,e.$emit("reshLsit")})).catch((function(){e.loading=!1}))},show:function(e){this.drawer=!0,this.queryInfo(e)},queryInfo:function(e){var t=this;e&&this.$store.dispatch("datasource/queryInfo",e).then((function(e){t.form=e.data}))},onProgress:function(){this.add_btn_dis=!0},handleSuccess:function(e,t,a){this.form.fileId=e.data,this.form.dbName=t.name,this.add_btn_dis=!1},handleRemove:function(e,t){console.log(e,t)},valid:function(){this.$store.dispatch("datasource/valid",this.form).then((function(e){Object(n["Message"])({message:"连接成功",type:"success",duration:5e3})}))}}},d=c,u=(a("623f"),a("2877")),m=Object(u["a"])(d,l,i,!1,null,null,null),p=m.exports,f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"详情",visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[a("el-descriptions",{staticClass:"margin-top",attrs:{title:"通用配置",column:2,border:""}},[a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-user"}),e._v(" 数据源名称 ")]),e._v(" "+e._s(e.form.name)+" ")],2),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-mobile-phone"}),e._v(" 数据源类型 ")]),e._v(" "+e._s(e._f("capitalize")(e.form.dbType))+" ")],2),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-tickets"}),e._v(" 创建时间 ")]),a("el-tag",{attrs:{size:"small"}},[e._v(e._s(e.form.createTime))])],2)],1),a("el-descriptions",{directives:[{name:"show",rawName:"v-show",value:0==e.form.dbType,expression:"form.dbType == 0"}],staticClass:"margin-top",staticStyle:{"margin-top":"20px"},attrs:{title:"数据配置",column:1}},[a("el-descriptions-item",{attrs:{label:"文件名称"}},[e._v(e._s(e.form.dbName))])],1),a("el-descriptions",{directives:[{name:"show",rawName:"v-show",value:0!=e.form.dbType,expression:"form.dbType != 0"}],staticClass:"margin-top",staticStyle:{"margin-top":"20px"},attrs:{title:"数据配置",column:1}},[a("el-descriptions-item",{attrs:{label:"数据库名称"}},[e._v(e._s(e.form.dbName))]),a("el-descriptions-item",{attrs:{label:"数据库账号"}},[e._v(e._s(e.form.user))]),a("el-descriptions-item",{attrs:{label:"数据库地址"}},[e._v(e._s(e.form.url))])],1)],1)},b=[],h={data:function(){return{visible:!1,form:{id:"",name:"通用数据库",dbType:"0",dbName:"",url:"",port:"",user:"",createTime:""}}},methods:{show:function(e){this.visible=!0,this.queryInfo(e)},queryInfo:function(e){var t=this;this.$store.dispatch("datasource/queryInfo",e).then((function(e){t.form=e.data}))}}},g=h,w=Object(u["a"])(g,f,b,!1,null,null,null),v=w.exports,y=a("bc3a"),_=a.n(y),x={components:{Add:p,Info:v},data:function(){return{page:{total:0,current:1,size:10,records:[]},name:"",subDrawer:!1,tableData:[]}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;Object(o["f"])(this.page.current,this.page.size,{name:this.name}).then((function(t){e.page=t.data}))},tableRowClassName:function(e){e.row;var t=e.rowIndex;return 1===t?"warning-row":3===t?"success-row":""},showAddPage:function(e){this.$refs.AddRef.show(e)},showDescPage:function(e){this.$refs.InfoRef.show(e.id)},deleteRow:function(e){var t=this;this.$store.dispatch("datasource/deleteRow",e).then((function(e){Object(n["Message"])({message:"操作成功",type:"success",duration:5e3}),t.fetchData()}))},handleSizeChange:function(e){this.page.size=e,this.fetchData()},handleCurrentChange:function(e){this.page.current=e,this.fetchData()},download:function(){_()({method:"get",url:"/codegeneration/ds/download",headers:{"Content-Type":"application/json"},responseType:"blob"}).then((function(e){if(e.data){var t="模板.xlsx",a=new Blob([e.data]),r=window.URL.createObjectURL(a),s=document.createElement("a");s.style.display="none",s.href=r,s.setAttribute("download",t),document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(r)}}))}}},T=x,k=(a("2dfa"),Object(u["a"])(T,r,s,!1,null,null,null));t["default"]=k.exports}}]);