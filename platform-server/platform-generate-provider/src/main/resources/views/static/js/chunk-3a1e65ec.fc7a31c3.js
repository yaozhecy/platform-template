(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3a1e65ec"],{"597f0":function(e,t,r){},b866:function(e,t,r){},e783:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",{staticStyle:{margin:"10px",border:"1px solid #eee"}},[r("el-header",{staticStyle:{"margin-top":"10px"}},[r("el-input",{staticStyle:{width:"300px","margin-right":"5px"},attrs:{splaceholder:"请输入内容",size:"small"},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1),r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.queryPage}},[e._v(" 查询 ")]),r("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-edit"},on:{click:e.addNode}},[e._v(" 新增 ")])],1),r("el-tabs",{staticStyle:{"margin-right":"5px","margin-left":"5px"},attrs:{type:"card"},on:{"tab-click":e.queryPage},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"内置转换字段",name:"first"}},[r("Table",{ref:"default_table",attrs:{"table-theme":"default"}})],1),r("el-tab-pane",{attrs:{label:"自定义转换字段",name:"second"}},[r("Table",{ref:"defined_table",attrs:{"table-theme":"user-defined"}})],1)],1),r("add",{ref:"add_view",on:{queryPage:e.queryPage}})],1)},l=[],i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"新增",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"ruleForm",attrs:{model:e.form,size:"mini",rules:e.rules}},[r("el-form-item",{attrs:{label:"原始字段:","label-width":e.formLabelWidth,prop:"orgFieldCode"}},[r("el-select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择"},model:{value:e.form.orgFieldCode,callback:function(t){e.$set(e.form,"orgFieldCode",t)},expression:"form.orgFieldCode"}},e._l(e.source_list,(function(t){return r("el-option",{key:t.code,attrs:{value:t.code}},[r("span",{staticStyle:{float:"left",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.code))]),r("span",{staticStyle:{float:"right",color:"#0c18d1"}},[e._v(e._s(t.level))])])})),1)],1),r("el-form-item",{attrs:{label:"字段编码:","label-width":e.formLabelWidth,prop:"fieldCode"}},[r("el-input",{staticStyle:{width:"80%"},model:{value:e.form.fieldCode,callback:function(t){e.$set(e.form,"fieldCode",t)},expression:"form.fieldCode"}})],1),r("el-form-item",{attrs:{label:"字段描述:","label-width":e.formLabelWidth,prop:"fieldName"}},[r("el-input",{staticStyle:{width:"80%"},model:{value:e.form.fieldName,callback:function(t){e.$set(e.form,"fieldName",t)},expression:"form.fieldName"}})],1),r("el-form-item",{attrs:{label:"内置转换器:","label-width":e.formLabelWidth,prop:"converterType"}},[r("el-switch",{attrs:{"active-value":1,"inactive-value":2},model:{value:e.form.converterType,callback:function(t){e.$set(e.form,"converterType",t)},expression:"form.converterType"}})],1),1===e.form.converterType?r("el-form-item",{attrs:{label:"内置转换器:","label-width":e.formLabelWidth,prop:"converter"}},[r("el-select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择"},model:{value:e.form.converter,callback:function(t){e.$set(e.form,"converter",t)},expression:"form.converter"}},e._l(e.transver_list,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1):e._e(),2===e.form.converterType?r("el-form-item",{attrs:{label:"转换表达式","label-width":e.formLabelWidth,prop:"fieldScript"}},[r("div",{staticStyle:{width:"80%",border:"1px solid #eee"}},[r("codemirror",{ref:"codemirror",staticClass:"code-edit",attrs:{value:e.code.mapperXml,options:e.cmOptions},model:{value:e.form.fieldScript,callback:function(t){e.$set(e.form,"fieldScript",t)},expression:"form.fieldScript"}})],1)]):e._e()],1),2===e.form.converterType?r("el-form",{staticStyle:{"text-align":"right",width:"90%"},attrs:{inline:!0,model:e.form,size:"mini"}},[r("el-form-item",{attrs:{label:"原始值："}},[r("el-input",{attrs:{placeholder:"初始值"},model:{value:e.test.value,callback:function(t){e.$set(e.test,"value",t)},expression:"test.value"}})],1),r("el-form-item",{attrs:{label:"转换值："}},[r("el-input",{attrs:{placeholder:"转换值"},model:{value:e.test.result,callback:function(t){e.$set(e.test,"result",t)},expression:"test.result"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.checkscript}},[e._v("测试")])],1)],1):e._e(),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"mini"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},o=[],n=(r("ac1f"),r("00b4"),r("8f94")),s=(r("a7be"),r("b866"),r("f9d4"),r("b775")),c="/field/map";function d(){return Object(s["a"])({url:"/field/map/source/list",method:"get"})}function u(){return Object(s["a"])({url:"/field/map/source/basetransver",method:"get"})}function m(e,t,r){return Object(s["a"])({url:c+"/page?current="+e+"&size="+t,method:"post",data:r})}function f(e){return Object(s["a"])({url:"/field/map/add",method:"post",data:e})}function p(e){return Object(s["a"])({url:c+"/delete?id="+e,method:"get"})}function h(e){return Object(s["a"])({url:c+"/checkscript",method:"post",data:e})}var b={components:{codemirror:n["codemirror"]},data:function(){return{dialogFormVisible:!1,source_list:[{code:"",level:""}],transver_list:[{code:"",name:""}],form:{},test:{value:"",result:""},formLabelWidth:"120px",code:{mapperXml:""},cmOptions:{mode:"javascript",theme:"idea",indentUnit:4,smartIndent:!0,tabSize:4,lineNumbers:!0,firstLineNumber:1,showCursorWhenSelecting:!0,readOnly:!1},rules:{orgFieldCode:[{required:!0,message:"请选择原始字段",trigger:"change"}],fieldCode:[{required:!0,message:"请输入字典编码",trigger:"blur"},{pattern:/[0-9a-zA-Z_]{1,20}/,message:"只可以输入数字和字母",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 5 个字符",trigger:"blur"}],fieldName:[{required:!0,message:"请输入字段描述",trigger:"blur"}],converterType:[{required:!0}],converter:[{required:!0,message:"请选择转换器",trigger:"change"}],fieldScript:[{required:!0,message:"请输入转换脚本",trigger:"blur"}]}}},mounted:function(){var e=this;this.clearForm(),d().then((function(t){e.source_list=t.data})),u().then((function(t){e.transver_list=t.data}))},methods:{clearForm:function(){this.form={orgFieldCode:"className",fieldCode:"",fieldName:"",fieldLevel:"",fieldScript:"",converterType:1,converter:"empty",delivery:!0}},openForm:function(e){this.form.groupId=e,this.dialogFormVisible=!0,this.clearForm()},submit:function(){var e=this;this.$refs["ruleForm"].validate((function(t){if(!t)return e.$message.error("请填写测试数据！！！"),!1;f(e.form).then((function(t){e.$message({message:"新增成功",type:"success"}),e.dialogFormVisible=!1,e.$emit("queryPage")})).catch((function(t){e.$message({message:t.message,type:"warning"})}))}))},checkscript:function(){var e=this;this.test.value?h({script:this.form.fieldScript,value:this.test.value}).then((function(t){e.test.result=t.data})):this.$message.error("请填写测试数据！！！")}}},g=b,v=(r("ea65"),r("2877")),y=Object(v["a"])(g,i,o,!1,null,null,null),_=y.exports,k=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-main",{staticStyle:{height:"400px"}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.page.records,size:"mini",stripe:"",border:"","header-cell-style":{background:"#eef1f6",color:"#454546"}}},[r("el-table-column",{attrs:{prop:"fieldCode",label:"字段编码",width:"180"}}),r("el-table-column",{attrs:{prop:"orgFieldCode",label:"原始字段",width:"180"}}),r("el-table-column",{attrs:{prop:"fieldName",label:"字段描述",width:"180"}}),r("el-table-column",{attrs:{prop:"converterType",label:"规则类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("convert")(t.row.converterType))+" ")]}}])}),r("el-table-column",{attrs:{prop:"converter",label:"映射规则"},scopedSlots:e._u([{key:"default",fn:function(t){return[2===t.row.converterType?r("span",[e._v(e._s(t.row.fieldScript))]):e._e(),1===t.row.converterType?r("el-select",{attrs:{size:"mini",placeholder:"请选择",disabled:""},model:{value:t.row.converter,callback:function(r){e.$set(t.row,"converter",r)},expression:"scope.row.converter"}},e._l(e.transver_list,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1):e._e()]}}])}),"user-defined"===e.tableTheme?r("el-table-column",{attrs:{label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.deleteNode(t.row.id)}}},[e._v("修改")]),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.deleteNode(t.row.id)}}},[e._v("删除")])]}}],null,!1,137775815)}):e._e()],1)],1),r("el-footer",[r("el-pagination",{staticStyle:{"text-align":"right","margin-top":"12px"},attrs:{background:"",total:e.page.total,layout:"total, sizes, prev, pager, next, jumper","page-size":e.page.size,"page-sizes":[10,20,50],"current-page":e.page.current},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},w=[],x={filters:{convert:function(e){return 1===e?"内置转换器":"自定义转换器"}},props:{tableTheme:{type:String,default:"default"}},data:function(){return{loading:!0,transver_list:[{code:"",name:""}],page:{total:0,current:1,size:10,records:[]},params:{tableTheme:this.tableTheme,keyWord:""}}},mounted:function(){var e=this;this.queryPage(),u().then((function(t){e.transver_list=t.data}))},methods:{queryPage:function(e){var t=this;this.loading=!0,this.params.keyWord=e,m(this.page.current,this.page.size,this.params).then((function(e){t.page=e.data,t.loading=!1}))},deleteNode:function(e){var t=this;p(e).then((function(e){t.$message({message:"删除成功",type:"success"}),t.queryPage()}))},handleSizeChange:function(e){this.page.size=e},handleCurrentChange:function(e){this.page.current=e}}},S=x,z=Object(v["a"])(S,k,w,!1,null,"662bf6d9",null),C=z.exports,N={components:{Add:_,Table:C},filters:{convert:function(e){return 1===e?"默认转换器":"脚本转换器"}},data:function(){return{activeName:"first",keyWord:""}},methods:{queryPage:function(){"first"===this.activeName?this.$refs.default_table.queryPage(this.keyWord):"second"===this.activeName&&this.$refs.defined_table.queryPage(this.keyWord)},addNode:function(e){this.$refs.add_view.openForm(e)}}},$=N,F=Object(v["a"])($,a,l,!1,null,"23c60e90",null);t["default"]=F.exports},ea65:function(e,t,r){"use strict";r("597f0")}}]);